# TextBricks å¤šå½¢æ…‹æ¶æ§‹è¨­è¨ˆæ–‡æª”

> **ç‰ˆæœ¬**: 3.0
> **ç‹€æ…‹**: è¨­è¨ˆéšæ®µ
> **ä½œè€…**: timcsy, Claude
> **æ—¥æœŸ**: 2025-10-20
> **æ›´æ–°**: 2025-10-20 - é‡å¤§æ›´æ–°ï¼šèªè¨€å±¤ç´šæ¶æ§‹ã€å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒã€å…ƒè³‡æ–™ç³»çµ±ã€é ˜åŸŸæ’ä»¶ã€è‡ªç„¶èªè¨€æ”¯æ´ã€åº•å±¤ç¡¬é«”æ”¯æ´
> **ç›¸é—œæ–‡æª”**: [PRD.md](./PRD.md), [VERSION_HISTORY.md](./VERSION_HISTORY.md)

---

## ğŸ“– ç›®éŒ„

### ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒç†è«–

1. [é¡˜æ™¯èˆ‡å‹•æ©Ÿ](#é¡˜æ™¯èˆ‡å‹•æ©Ÿ)
2. [èªè¨€å±¤ç´šæ¶æ§‹](#èªè¨€å±¤ç´šæ¶æ§‹) ğŸ†• v3.0
3. [æ ¸å¿ƒæ¦‚å¿µï¼šä¸‰å½¢æ…‹ç†è«–](#æ ¸å¿ƒæ¦‚å¿µä¸‰å½¢æ…‹ç†è«–)
4. [å››ç´šç©æœ¨ç³»çµ±](#å››ç´šç©æœ¨ç³»çµ±)
5. [è³‡è¨Šæå¤±èˆ‡è½‰æ›](#è³‡è¨Šæå¤±èˆ‡è½‰æ›)

### ç¬¬äºŒéƒ¨åˆ†ï¼šå¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ

6. [å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ](#å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ) ğŸ†• v3.0
7. [å…ƒè³‡æ–™èˆ‡è¨»è§£ç®¡ç†ç³»çµ±](#å…ƒè³‡æ–™èˆ‡è¨»è§£ç®¡ç†ç³»çµ±) ğŸ†• v3.0
8. [é ˜åŸŸæ’ä»¶ç³»çµ±](#é ˜åŸŸæ’ä»¶ç³»çµ±) ğŸ†• v3.0

### ç¬¬ä¸‰éƒ¨åˆ†ï¼šèªè¨€å±¤ç´šå¯¦ç¾

9. [è‡ªç„¶èªè¨€æ¨¡æ¿ç³»çµ±](#è‡ªç„¶èªè¨€æ¨¡æ¿ç³»çµ±) ğŸ†• v3.0
10. [é«˜éšç¨‹å¼èªè¨€å¯¦ç¾](#é«˜éšç¨‹å¼èªè¨€å¯¦ç¾)
    - [ç©æœ¨ç³»çµ±è¨­è¨ˆ](#ç©æœ¨ç³»çµ±è¨­è¨ˆ)
    - [ç©æœ¨å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶](#ç©æœ¨å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶)
11. [åº•å±¤èˆ‡ç¡¬é«”é–‹ç™¼æ”¯æ´](#åº•å±¤èˆ‡ç¡¬é«”é–‹ç™¼æ”¯æ´) ğŸ†• v3.0

### ç¬¬å››éƒ¨åˆ†ï¼šç³»çµ±è¨­è¨ˆ

12. [æª”æ¡ˆæ¶æ§‹è¨­è¨ˆ](#æª”æ¡ˆæ¶æ§‹è¨­è¨ˆ)
13. [åœ–è­œç³»çµ±è¨­è¨ˆ](#åœ–è­œç³»çµ±è¨­è¨ˆ)
14. [è½‰æ›ç³»çµ±è¨­è¨ˆ](#è½‰æ›ç³»çµ±è¨­è¨ˆ)
15. [Transformation Assistant](#transformation-assistant)
16. [å°æ‡‰é—œä¿‚ç®¡ç†ç³»çµ±](#å°æ‡‰é—œä¿‚ç®¡ç†ç³»çµ±)
17. [Template Registry](#template-registry)
18. [è·¨èªè¨€æ”¯æ´](#è·¨èªè¨€æ”¯æ´)

### ç¬¬äº”éƒ¨åˆ†ï¼šå¯¦æ–½èˆ‡å±•æœ›

19. [å¯¦æ–½è·¯ç·šåœ–](#å¯¦æ–½è·¯ç·šåœ–)
20. [é–‹æ”¾å•é¡Œ](#é–‹æ”¾å•é¡Œ)
21. [é™„éŒ„](#é™„éŒ„)

---

## é¡˜æ™¯èˆ‡å‹•æ©Ÿ

### ç‚ºä»€éº¼éœ€è¦å¤šå½¢æ…‹ç³»çµ±ï¼Ÿ

TextBricks çš„æ ¸å¿ƒé¡˜æ™¯æ˜¯æˆç‚º**å¤šå½¢æ…‹ç¨‹å¼èˆ‡è¦æ ¼è¡¨é”å¹³å°**ï¼Œçªç ´å‚³çµ±ç´”æ–‡å­—ç·¨ç¨‹çš„é™åˆ¶ã€‚ä¸åŒçš„äººåœ¨ä¸åŒæƒ…å¢ƒä¸‹ï¼Œéœ€è¦ç”¨ä¸åŒçš„æ–¹å¼ç†è§£å’Œæ“ä½œç¨‹å¼ï¼š

- **åˆå­¸è€…** éœ€è¦è¦–è¦ºåŒ–çš„ç©æœ¨ä¾†ç†è§£ç¨‹å¼çµæ§‹
- **å°ˆæ¥­é–‹ç™¼è€…** éœ€è¦é«˜æ•ˆçš„æ–‡å­—ç·¨è¼¯å™¨ä¾†æ’°å¯«ç¨‹å¼ç¢¼
- **æ¶æ§‹å¸«** éœ€è¦åœ–è­œè¦–åœ–ä¾†ç†è§£ç³»çµ±æ•´é«”æ¶æ§‹
- **AI ç³»çµ±** éœ€è¦çµæ§‹åŒ–è³‡æ–™ä¾†ç†è§£ç¨‹å¼æ„åœ–

å–®ä¸€å½¢æ…‹ç„¡æ³•æ»¿è¶³æ‰€æœ‰éœ€æ±‚ï¼Œå› æ­¤éœ€è¦**å¤šå½¢æ…‹è¡¨é”èˆ‡è‡ªç”±è½‰æ›**ã€‚

### ä¸‰å½¢æ…‹ç†è«–

æ ¹æ“š [PRD.md](./PRD.md) ä¸­çš„ä¸‰å½¢æ…‹ç†è«–ï¼Œç¨‹å¼æœ‰ä¸‰ç¨®æœ¬è³ªæ€§çš„è¡¨ç¾å½¢å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ–‡å­—      â”‚  èªæ³•å±¤é¢ï¼šé€™æ®µç¨‹å¼æ€éº¼å¯«
â”‚ (Sequence)  â”‚  å„ªå‹¢ï¼šç²¾ç¢ºã€å¯ç·¨è¼¯
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  åŠ£å‹¢ï¼šå­¸ç¿’æ›²ç·šé™¡å³­
       â”‚
       â†• çµæ§‹åŒ– / åºåˆ—åŒ–
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
â”‚   ç©æœ¨      â”‚  æ„åœ–å±¤é¢ï¼šé€™æ®µç¨‹å¼æƒ³åšä»€éº¼
â”‚ (Structure) â”‚  å„ªå‹¢ï¼šè¦–è¦ºåŒ–ã€æ˜“ç†è§£
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  åŠ£å‹¢ï¼šè¡¨é”èƒ½åŠ›å—é™
       â”‚
       â†• åœ–è­œåŒ– / çµæ§‹åŒ–
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
â”‚   åœ–è­œ      â”‚  æ‹“æ’²å±¤é¢ï¼šå„éƒ¨åˆ†å¦‚ä½•é€£æ¥èˆ‡äº’å‹•
â”‚ (Topology)  â”‚  å„ªå‹¢ï¼šå…¨å±€è¦–è§’ã€é—œä¿‚æ¸…æ™°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  åŠ£å‹¢ï¼šç´°ç¯€éš±è—
```

**é‡è¦ç™¼ç¾**ï¼šä»»æ„å…©ç¨®å½¢æ…‹ä¹‹é–“éƒ½æ‡‰è©²èƒ½å¤ **ç›´æ¥è½‰æ›**ï¼Œä¸ä¸€å®šéœ€è¦ç¶“éç¬¬ä¸‰è€…ã€‚

### è‡ªç·¨ç¢¼èˆ‡æ”¶æ–‚

å¤šå½¢æ…‹è½‰æ›é¡ä¼¼æ–¼æ©Ÿå™¨å­¸ç¿’ä¸­çš„**è‡ªç·¨ç¢¼å™¨ (Autoencoder)**ï¼š

```
åŸå§‹ç¨‹å¼ â†’ [ç·¨ç¢¼] â†’ å£“ç¸®è¡¨ç¤º â†’ [è§£ç¢¼] â†’ é‡å»ºç¨‹å¼
```

é€šéå¤šæ¬¡å½¢æ…‹è½‰æ›ï¼Œç¨‹å¼æœƒï¼š
1. **æå¤±éæœ¬è³ªè³‡è¨Š** - æ ¼å¼ã€å‘½åé¢¨æ ¼ç­‰
2. **ä¿ç•™æ ¸å¿ƒæ„åœ–** - é‚è¼¯çµæ§‹ã€ç®—æ³•æœ¬è³ª
3. **æ”¶æ–‚åˆ°ç©©å®šç‹€æ…‹** - å±€éƒ¨æˆ–å…¨å±€ç©©å®š

**æ‡‰ç”¨**ï¼š
- ç¨‹å¼ç¢¼æ¨™æº–åŒ–
- æ„åœ–æå–
- AI è¨“ç·´è³‡æ–™
- è·¨èªè¨€è½‰æ›

---

## ç‰ˆæœ¬æ­·å²

### v3.0 (2025-10-20) - é‡å¤§æ¶æ§‹å‡ç´š ğŸš€

**æ ¸å¿ƒç†å¿µè®Šé©**ï¼š
- å¾ã€Œç¨‹å¼ç¢¼æ¨¡æ¿å·¥å…·ã€å‡ç´šç‚ºã€Œè·¨èªè¨€å±¤ç´šçŸ¥è­˜å¹³å°ã€
- çµ±ä¸€èªè¨€è§€ï¼šNatural Languageã€Programmingã€Assemblyã€Machine Codeã€HDLã€Physical éƒ½æ˜¯ã€Œèªè¨€ã€
- ä¸‰å½¢æ…‹ç†è«–é©ç”¨æ–¼æ‰€æœ‰èªè¨€å±¤ç´š

**æ–°å¢ç« ç¯€** (6å€‹ä¸»è¦ç« ç¯€):

1. **èªè¨€å±¤ç´šæ¶æ§‹** (~200 è¡Œ)
   - 6 å€‹æŠ½è±¡å±¤ç´šå®šç¾©
   - ç·¨è­¯å™¨çµ±ä¸€è¦–è§’ï¼ˆCoding Agent = Compilerï¼‰
   - å‚ç›´æ•´åˆå ´æ™¯

2. **å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ** (~310 è¡Œ)
   - å››ç´šç©æœ¨ç³»çµ±ï¼ˆL0/L1/L2/L3ï¼‰
   - è³‡è¨Šæå¤±çš„é›™é‡æ€§ï¼ˆå¯é‚„åŸ vs. ä¸å¯é‚„åŸï¼‰
   - å®Œæ•´çš„çŸ¥è­˜å–®å…ƒå®šç¾©ï¼ˆåŒ…å«å…ƒè³‡æ–™ã€è¨»è§£ã€æ’ä»¶ï¼‰

3. **å…ƒè³‡æ–™èˆ‡è¨»è§£ç®¡ç†ç³»çµ±** (~470 è¡Œ)
   - B+C+D å¤šå±¤æ¬¡è¨»è§£æ¶æ§‹
   - AI è¼”åŠ©åŒæ­¥æ©Ÿåˆ¶ï¼ˆC+D: User decides + AI assistsï¼‰
   - éŒ¨é»ç³»çµ±èˆ‡è¡çªè§£æ±º

4. **é ˜åŸŸæ’ä»¶ç³»çµ±** (~450 è¡Œ)
   - Core + Plugin æ¶æ§‹
   - HDL Pluginã€Python Pluginã€Assembly Plugin å®Œæ•´ç¯„ä¾‹
   - æ’ä»¶ç”Ÿå‘½é€±æœŸç®¡ç†

5. **è‡ªç„¶èªè¨€æ¨¡æ¿ç³»çµ±** (~700 è¡Œ)
   - Spec Template æ ¼å¼
   - SpecKit æ·±åº¦æ•´åˆ
   - æ¦‚å¿µç®¡ç†ç³»çµ±ï¼ˆPhase 2 é¡å‹åŒ–æ¦‚å¿µï¼‰
   - Spec-Driven å·¥ä½œæµ

6. **åº•å±¤èˆ‡ç¡¬é«”é–‹ç™¼æ”¯æ´** (~530 è¡Œ)
   - Assembly æ¨¡æ¿ï¼ˆx86-64, ARM, RISC-Vï¼‰
   - HDL æ¨¡æ¿ï¼ˆVerilog, VHDL, SystemVerilogï¼‰
   - Machine Code å¯è¦–åŒ–
   - æ’ä»¶ç³»çµ±æ·±åŒ–

**æ›´æ–°ç« ç¯€** (3å€‹æ ¸å¿ƒç« ç¯€):

1. **ä¸‰å½¢æ…‹ç†è«–** (~270 è¡Œæ›´æ–°)
   - å¼·èª¿ B+C æœ¬è³ªï¼ˆä¸åŒè¦–è§’ + ä¸åŒæŠ½è±¡å±¤ç´šï¼‰
   - è·¨èªè¨€å±¤ç´šé©ç”¨æ€§è¡¨æ ¼
   - è³‡è¨Šæå¤±èˆ‡è£œå„Ÿç­–ç•¥
   - ç”Ÿç‰©å­¸é¡æ¯”æ·±åŒ–

2. **Template Registry** (~200 è¡Œæ–°å¢)
   - RegistryEntry æ”¯æ´ languageLevel å’Œ granularity
   - æ’ä»¶æ•´åˆåŠŸèƒ½ï¼ˆRegistryPluginManagerï¼‰
   - èªè¨€å±¤ç´š/ç²’åº¦/æ’ä»¶æŸ¥è©¢
   - æ’ä»¶æ›´æ–°å‚³æ’­æ©Ÿåˆ¶

3. **å¯¦æ–½è·¯ç·šåœ–** (~350 è¡Œæ–°å¢)
   - v0.6.0: è‡ªç„¶èªè¨€æ¨¡æ¿ç³»çµ±ï¼ˆ3-4 æœˆï¼‰
   - v0.6.x: çŸ¥è­˜åœ–è­œã€AI è¦æ ¼ç”Ÿæˆã€å¤šèªè¨€è¦æ ¼
   - v0.7.0: åº•å±¤èˆ‡ç¡¬é«”é–‹ç™¼æ”¯æ´ï¼ˆ3-4 æœˆï¼‰
   - v0.7.x: æ€§èƒ½åˆ†æã€å„ªåŒ–å»ºè­°ã€é™¤éŒ¯æ”¯æ´
   - v1.0: çµ±ä¸€å¤šèªè¨€å¹³å° + ç¤¾ç¾¤èˆ‡ AIï¼ˆ6-12 æœˆï¼‰

**æ–°å¢é™„éŒ„**:

- **é™„éŒ„ C: èˆ‡ SpecKit æ•´åˆ** (~440 è¡Œ)
  - SpecKit ç°¡ä»‹èˆ‡å±€é™æ€§åˆ†æ
  - TextBricks è£œå……åƒ¹å€¼
  - /specify å’Œ /implement éšæ®µæ•´åˆ
  - é›™å‘åŒæ­¥æ©Ÿåˆ¶
  - ç›®éŒ„çµæ§‹æ•´åˆ
  - æŠ€è¡“å¯¦ç¾ç´°ç¯€
  - æœªä¾†å±•æœ›ï¼ˆPhase 1-3ï¼‰

**æ“´å……é–‹æ”¾å•é¡Œ** (11å€‹ v3.0 æ–°å•é¡Œ):

24. è‡ªç„¶èªè¨€ L3 æ¦‚å¿µç²’åº¦
25. æ¦‚å¿µé¡å‹ç³»çµ±çš„è¤‡é›œåº¦
26. æ¦‚å¿µåœ–è­œçš„å¯¦ä½œæŠ€è¡“é¸æ“‡
27. Spec â†” Code å°æ‡‰çš„æº–ç¢ºåº¦é–¾å€¼
28. Assembly/HDL çš„ Blockly è¡¨ç¤º
29. Machine Code çš„å¯ç·¨è¼¯æ€§
30. æ’ä»¶çš„å®‰å…¨æ€§èˆ‡æ²™ç®±
31. è·¨èªè¨€å±¤ç´šè½‰æ›çš„å¯è¡Œæ€§
32. å…ƒè³‡æ–™çš„å¤šèªè¨€æ”¯æ´
33. æ’ä»¶æ›´æ–°çš„å‘å¾Œå…¼å®¹æ€§
34. Coding Agent åå¥½èˆ‡æ¨¡æ¿æ¨è–¦

**çµ±è¨ˆæ•¸æ“š**:
- æ–°å¢å…§å®¹ï¼š~2,860 è¡Œ
- ç¸½æ–‡æª”é•·åº¦ï¼š~9,500 è¡Œï¼ˆç›¸æ¯” v2.0 ~6,500 è¡Œï¼‰
- æ–°å¢ç« ç¯€ï¼š6 å€‹
- æ›´æ–°ç« ç¯€ï¼š3 å€‹
- æ–°å¢é–‹æ”¾å•é¡Œï¼š11 å€‹
- æ–°å¢é™„éŒ„ï¼š1 å€‹

**è¨­è¨ˆæ±ºç­–è¨˜éŒ„**:
- é€éæ·±å…¥è¨è«–ç¢ºç«‹ 11 å€‹é—œéµè¨­è¨ˆæ±ºç­–ï¼ˆB+C, D, B+C+D, C+D, ç­‰ï¼‰
- æ‰€æœ‰æ±ºç­–éƒ½åŸºæ–¼ä½¿ç”¨è€…éœ€æ±‚å’Œç³»çµ±è¨­è¨ˆåŸå‰‡
- ä¿æŒæ¨¡çµ„åŒ–å’Œå¯æ“´å±•æ€§

**å‘å¾Œå…¼å®¹æ€§**:
- v2.0 çš„æ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µä¿ç•™
- å››ç´šç©æœ¨ç³»çµ±ã€è½‰æ›å¼•æ“ã€å°æ‡‰é—œä¿‚ç³»çµ±ç­‰ç„¡è®Šæ›´
- åƒ…å¢åŠ åŠŸèƒ½ï¼Œä¸ç ´å£ç¾æœ‰è¨­è¨ˆ

---

### v2.0 (ä¹‹å‰ç‰ˆæœ¬)

**æ ¸å¿ƒç‰¹æ€§**:
- ä¸‰å½¢æ…‹ç†è«–ï¼ˆSequence/Structure/Topologyï¼‰
- å››ç´šç©æœ¨ç³»çµ±ï¼ˆL0/L1/L2/L3ï¼‰
- ç©æœ¨å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶
- è½‰æ›å¼•æ“èˆ‡å°æ‡‰é—œä¿‚ç®¡ç†
- Template Registry åŸºç¤æ¶æ§‹
- Transformation Assistant
- åœ–è­œç³»çµ±è¨­è¨ˆï¼ˆ4ç¨®åœ–è­œé¡å‹ï¼‰
- è·¨èªè¨€æ”¯æ´ï¼ˆC, Python, JavaScriptï¼‰

**æ–‡æª”é•·åº¦**: ~6,500 è¡Œ

---

## èªè¨€å±¤ç´šæ¶æ§‹

### çµ±ä¸€çš„èªè¨€è§€

**v3.0 æ ¸å¿ƒæ´å¯Ÿ**ï¼šä¸è«–æ˜¯è‡ªç„¶èªè¨€ã€ç¨‹å¼èªè¨€ã€é‚„æ˜¯ç¡¬é«”æè¿°èªè¨€ï¼Œæœ¬è³ªä¸Šéƒ½æ˜¯**èªè¨€** (Language)ã€‚

TextBricks å¾ã€Œç¨‹å¼ç¢¼æ¨¡æ¿ç³»çµ±ã€æ¼”é€²ç‚º**è·¨èªè¨€å±¤ç´šçš„å¤šå½¢æ…‹çŸ¥è­˜å¹³å°**ï¼Œæ”¯æ´å¾æœ€æŠ½è±¡çš„è‡ªç„¶èªè¨€è¦æ ¼ï¼Œåˆ°æœ€å…·é«”çš„ç‰©ç†é›»è·¯è¨­è¨ˆã€‚

###å®Œæ•´çš„æŠ½è±¡å±¤ç´š

```
æŠ½è±¡å±¤ç´š â†•ï¸ ç·¨è­¯/è½‰æ› â†’

ğŸ”¸ Natural Language (è‡ªç„¶èªè¨€)
   ä¾‹å¦‚ï¼šspec.md, requirements.txt
   ç·¨è­¯å™¨ï¼šCoding Agent (Claude, Copilot)
      â†“
ğŸ”¸ High-Level Programming (é«˜éšç¨‹å¼èªè¨€)
   ä¾‹å¦‚ï¼šPython, JavaScript, Java
   ç·¨è­¯å™¨ï¼šInterpreter / JIT Compiler
      â†“
ğŸ”¸ Low-Level Programming (ä½éšç¨‹å¼èªè¨€)
   ä¾‹å¦‚ï¼šC, Assembly
   ç·¨è­¯å™¨ï¼šgcc, nasm, llvm
      â†“
ğŸ”¸ Machine Language (æ©Ÿå™¨èªè¨€)
   ä¾‹å¦‚ï¼šx86 bytecode, ARM instructions
   åŸ·è¡Œå™¨ï¼šCPU
      â†“
ğŸ”¸ Hardware Description (ç¡¬é«”æè¿°èªè¨€)
   ä¾‹å¦‚ï¼šVerilog, VHDL, Chisel
   ç¶œåˆå·¥å…·ï¼šVivado, Quartus
      â†“
ğŸ”¸ Physical Circuit (å¯¦é«”é›»è·¯)
   ä¾‹å¦‚ï¼šNetlist, PCB Layout, IC Layout
   è£½é€ ï¼šFabrication Process
```

### æ¯å€‹å±¤ç´šéƒ½æœ‰ä¸‰ç¨®å½¢æ…‹

**é—œéµç™¼ç¾**ï¼šä¸è«–åœ¨å“ªå€‹æŠ½è±¡å±¤ç´šï¼Œéƒ½å¯ä»¥ç”¨ä¸‰ç¨®å½¢æ…‹è¡¨é”ï¼š

#### Natural Language çš„ä¸‰å½¢æ…‹

```typescript
{
  Sequence:  "spec.md (Markdown æ–‡å­—)",
  Structure: "structured-spec.json (çµæ§‹åŒ–è¦æ ¼)",
  Topology:  "requirement-graph (éœ€æ±‚é—œè¯åœ–)"
}
```

#### Programming Language çš„ä¸‰å½¢æ…‹

```typescript
{
  Sequence:  ".py, .js, .c (æ–‡å­—ç¨‹å¼ç¢¼)",
  Structure: ".blocks.xml (Blockly ç©æœ¨)",
  Topology:  ".graph.json (å‘¼å«åœ–ã€è³‡æ–™æµåœ–)"
}
```

#### Hardware Description Language çš„ä¸‰å½¢æ…‹

```typescript
{
  Sequence:  ".v, .vhd (HDL æ–‡å­—ç¢¼)",
  Structure: "logic-blocks.xml (é‚è¼¯é–˜ç©æœ¨)",
  Topology:  ".cir (é›»è·¯åœ–ã€timing diagram)"
}
```

#### Machine Language çš„ä¸‰å½¢æ…‹

```typescript
{
  Sequence:  "binary/hex code (ä½å…ƒçµ„åºåˆ—)",
  Structure: "instruction-blocks (æŒ‡ä»¤å€å¡Š)",
  Topology:  "pipeline-diagram (åŸ·è¡Œæµæ°´ç·šåœ–)"
}
```

### ç·¨è­¯å™¨çš„çµ±ä¸€æŠ½è±¡

å¾é€™å€‹è¦–è§’çœ‹ï¼Œæ‰€æœ‰ã€Œç·¨è­¯å™¨ã€éƒ½åœ¨åšåŒä¸€ä»¶äº‹ï¼š**å°‡é«˜æŠ½è±¡å±¤ç´šçš„èªè¨€è½‰æ›ç‚ºä½æŠ½è±¡å±¤ç´šçš„èªè¨€**ã€‚

| ç·¨è­¯å™¨é¡å‹ | è¼¸å…¥èªè¨€ | è¼¸å‡ºèªè¨€ | ç¯„ä¾‹å·¥å…· |
|-----------|---------|---------|---------|
| **AI Agent** | Natural Language | Programming Language | Claude Code, Copilot |
| **Interpreter** | High-Level Code | Bytecode/Machine Code | Python, Node.js |
| **Compiler** | High-Level Code | Assembly/Machine Code | gcc, clang, rustc |
| **Assembler** | Assembly | Machine Code | nasm, gas |
| **Synthesis Tool** | HDL | Gate-Level Netlist | Vivado, Quartus |
| **Place & Route** | Netlist | Physical Layout | CAD Tools |

**çµ±ä¸€ç†è§£**ï¼š
- **Coding Agent = è‡ªç„¶èªè¨€çš„ç·¨è­¯å™¨**
- **gcc = é«˜éšèªè¨€çš„ç·¨è­¯å™¨**
- **Vivado = HDL çš„ç·¨è­¯å™¨**
- **Fab Process = é›»è·¯çš„ç·¨è­¯å™¨**

### TextBricks åœ¨å„å±¤ç´šçš„è§’è‰²

```
æ¯å€‹èªè¨€å±¤ç´šéƒ½å¯ä»¥æœ‰ TextBricks æ¨¡æ¿ï¼š

Natural Language Templates
â”œâ”€â”€ API Endpoint Spec Template
â”œâ”€â”€ Algorithm Description Template
â”œâ”€â”€ User Story Template
â””â”€â”€ ... (æ’å…¥åˆ° spec.md)

Programming Language Templates
â”œâ”€â”€ for-loop, class, function
â”œâ”€â”€ FastAPI Route Handler
â”œâ”€â”€ React Component
â””â”€â”€ ... (æ’å…¥åˆ° .py, .js)

Assembly Templates
â”œâ”€â”€ Function Prologue/Epilogue
â”œâ”€â”€ System Call Wrapper
â”œâ”€â”€ SIMD Loop Optimization
â””â”€â”€ ... (æ’å…¥åˆ° .asm)

HDL Templates
â”œâ”€â”€ Synchronous FIFO
â”œâ”€â”€ AXI4 Slave Interface
â”œâ”€â”€ Clock Domain Crossing
â””â”€â”€ ... (æ’å…¥åˆ° .v, .vhd)

Physical Circuit Templates
â”œâ”€â”€ Arduino Shield Layout
â”œâ”€â”€ Standard Cell Library
â””â”€â”€ ... (æ’å…¥åˆ° .kicad)
```

### å‚ç›´æ•´åˆé–‹ç™¼å ´æ™¯

**å ´æ™¯ï¼šåµŒå…¥å¼ç³»çµ±é–‹ç™¼**

```
1. Natural Language (éœ€æ±‚è¦æ ¼)
   - ä½¿ç”¨ TextBricks: "åµŒå…¥å¼æ§åˆ¶å™¨éœ€æ±‚è¦æ ¼æ¨¡æ¿"
   - æ’å…¥åˆ°ï¼šrequirements.md
   â†“ Coding Agent

2. C/C++ Code (é«˜éšå¯¦ä½œ)
   - ä½¿ç”¨ TextBricks: "GPIO æ§åˆ¶å‡½å¼", "Timer ä¸­æ–·è™•ç†"
   - æ’å…¥åˆ°ï¼šmain.c, gpio.c
   â†“ ARM-GCC

3. ARM Assembly (ä½éšå„ªåŒ–)
   - ä½¿ç”¨ TextBricks: "ä¸­æ–·å‘é‡è¡¨", "å•Ÿå‹•ç¨‹å¼ç¢¼"
   - æ’å…¥åˆ°ï¼šstartup.S
   â†“ Assembler

4. Machine Code (åŸ·è¡Œæª”)
   - ç‡’éŒ„åˆ°ï¼šMCU Flash
```

**å ´æ™¯ï¼šASIC/FPGA è¨­è¨ˆ**

```
1. Natural Language (åŠŸèƒ½è¦æ ¼)
   - ä½¿ç”¨ TextBricks: "æ•¸ä½è¨Šè™Ÿè™•ç†å™¨è¦æ ¼æ¨¡æ¿"
   â†“ SystemVerilog Generator

2. HDL Code (ç¡¬é«”æè¿°)
   - ä½¿ç”¨ TextBricks: "FIR æ¿¾æ³¢å™¨", "FFT é‹ç®—æ ¸å¿ƒ"
   - æ’å…¥åˆ°ï¼šdsp.v
   â†“ Vivado Synthesis

3. Gate-Level Netlist (é‚è¼¯é–˜ç¶²è¡¨)
   â†“ Place & Route

4. Physical Layout (å¯¦é«”ä½ˆå±€)
   â†“ Fabrication

5. Silicon Chip (æ™¶ç‰‡)
```

### ç‚ºä»€éº¼é€™å€‹æ¶æ§‹é‡è¦ï¼Ÿ

1. **çµ±ä¸€çš„ç†è«–æ¡†æ¶**
   - æ‰€æœ‰èªè¨€å±¤ç´šä½¿ç”¨ç›¸åŒçš„ä¸‰å½¢æ…‹ç†è«–
   - æ¨¡æ¿ç³»çµ±ã€è½‰æ›å¼•æ“ã€Registry å¯ä»¥å…±ç”¨

2. **å®Œæ•´çš„é–‹ç™¼è¦†è“‹**
   - å¾éœ€æ±‚åˆ°å¯¦ç¾çš„å®Œæ•´è·¯å¾‘
   - æ”¯æ´è»Ÿé«”ã€éŸŒé«”ã€ç¡¬é«”é–‹ç™¼

3. **å‚ç›´æ•´åˆèƒ½åŠ›**
   - åœ¨ä¸€å€‹å°ˆæ¡ˆä¸­è·¨è¶Šå¤šå€‹æŠ½è±¡å±¤ç´š
   - è¿½è¹¤å¾ spec åˆ° silicon çš„å®Œæ•´æ˜ å°„

4. **AI å‹å¥½**
   - ç‚º AI ç†è§£ã€Œæ„åœ– â†’ å¯¦ç¾ã€æä¾›å®Œæ•´è¨“ç·´è³‡æ–™
   - è·¨å±¤ç´šè½‰æ›çš„çŸ¥è­˜ç´¯ç©

5. **æ•™è‚²åƒ¹å€¼**
   - å¹«åŠ©å­¸ç¿’è€…ç†è§£ä¸åŒæŠ½è±¡å±¤ç´šçš„é—œè¯
   - å¾é«˜éšåˆ°ä½éšçš„æ¼¸é€²å¼å­¸ç¿’è·¯å¾‘

---

## æ ¸å¿ƒæ¦‚å¿µï¼šä¸‰å½¢æ…‹ç†è«–

> **v3.0 æ ¸å¿ƒæ´å¯Ÿ**ï¼šä¸‰å½¢æ…‹æ˜¯ä¸€ç¨®**é€šç”¨è¡¨ç¤ºæ³•**ï¼Œé©ç”¨æ–¼æ‰€æœ‰èªè¨€å±¤ç´šï¼ˆNatural Languageã€Programmingã€Assemblyã€HDLã€Machine Codeï¼‰ã€‚å®ƒä¸åªæ˜¯ã€Œä¸åŒæ ¼å¼ã€ï¼Œè€Œæ˜¯ã€Œä¸åŒè¦–è§’ã€èˆ‡ã€Œä¸åŒæŠ½è±¡å±¤ç´šã€çš„çµåˆ (B+C)ã€‚

### ç†è«–æœ¬è³ª

#### å½¢æ…‹çš„é›™é‡æ€§ (B+C)

ä¸‰å½¢æ…‹å…·æœ‰å…©ç¨®äº’è£œæ€§è³ªï¼š

**B. ä¸åŒè¦–è§’ (Different Perspectives)**
- **Sequence**: ç·šæ€§åŸ·è¡Œè¦–è§’ â€” å¼·èª¿ã€Œæ™‚é–“é †åºã€èˆ‡ã€Œæ“ä½œæµç¨‹ã€
- **Structure**: çµ„æˆçµæ§‹è¦–è§’ â€” å¼·èª¿ã€Œå±¤æ¬¡é—œä¿‚ã€èˆ‡ã€Œæ¨¡çµ„åŒ–ã€
- **Topology**: é—œä¿‚ç¶²çµ¡è¦–è§’ â€” å¼·èª¿ã€Œä¾è³´é—œä¿‚ã€èˆ‡ã€Œç³»çµ±æ¶æ§‹ã€

ä¸‰è€…éƒ½åœ¨æè¿°åŒä¸€å€‹çŸ¥è­˜å–®å…ƒï¼Œä½†å¾ä¸åŒè§’åº¦åˆ‡å…¥ã€‚

**C. ä¸åŒæŠ½è±¡å±¤ç´š (Different Abstraction Levels)**
- Sequence â†’ Structureï¼šå‘ä¸ŠæŠ½è±¡ï¼Œä¿ç•™çµæ§‹ï¼Œæ¨æ£„ç´°ç¯€
- Structure â†’ Topologyï¼šå†å‘ä¸ŠæŠ½è±¡ï¼Œä¿ç•™é—œä¿‚ï¼Œæ¨æ£„å¯¦ä½œ

**é—œéµ**: ä¸‰å½¢æ…‹ä¹‹é–“**ä¸æ˜¯å®Œå…¨å¯é€†çš„**ï¼Œå› ç‚ºå­˜åœ¨**è³‡è¨Šæå¤±** (Information Loss)ã€‚

#### è·¨èªè¨€å±¤ç´šé©ç”¨æ€§

ä¸‰å½¢æ…‹ç†è«–é©ç”¨æ–¼æ‰€æœ‰èªè¨€å±¤ç´šï¼š

| èªè¨€å±¤ç´š | Sequence | Structure | Topology |
|---------|----------|-----------|----------|
| **Natural Language** | ç·šæ€§æ–‡å­—è¦æ ¼ (.md) | æ¦‚å¿µç©æœ¨ (Blockly) | æ¦‚å¿µåœ– (Concept Map) |
| **High-Level Programming** | ç¨‹å¼ç¢¼æ–‡å­— (.py) | èªå¥ç©æœ¨ (Blockly) | å‘¼å«åœ– (Call Graph) |
| **Low-Level Programming** | çµ„åˆèªè¨€ (.asm) | æŒ‡ä»¤ç©æœ¨ (Blockly) | æš«å­˜å™¨æµç¨‹åœ– |
| **Machine Language** | æ©Ÿå™¨ç¢¼åˆ—è¡¨ (hex) | æŒ‡ä»¤æ ¼å¼åœ– | ç®¡ç·šåœ– (Pipeline) |
| **Hardware Description** | HDL ç¢¼ (.v) | æ¨¡çµ„ç©æœ¨ (Blockly) | RTL åœ– (Schematic) |
| **Physical Circuit** | ç¶²è¡¨ (Netlist) | å…ƒä»¶ç©æœ¨ (Circuit) | ä½ˆç·šåœ– (Layout) |

**çµ±ä¸€è¦–è§’**: ä¸è«–åœ¨å“ªå€‹å±¤ç´šï¼Œéƒ½å¯ä»¥ç”¨ Sequence/Structure/Topology ä¸‰ç¨®å½¢æ…‹ä¾†è¡¨ç¤ºå’Œè½‰æ›çŸ¥è­˜ã€‚

---

### å½¢æ…‹å®šç¾©ï¼ˆä»¥ High-Level Programming ç‚ºä¾‹ï¼‰

#### 1. æ–‡å­—å½¢æ…‹ (Sequence Form)

**å®šç¾©**ï¼šç·šæ€§æ–‡å­—ç¨‹å¼ç¢¼ï¼Œå¼·èª¿æ™‚é–“é †åºå’ŒåŸ·è¡Œæµç¨‹

**ç‰¹å¾µ**ï¼š
- æŒ‰è¡Œçµ„ç¹”
- éµå¾ªèªæ³•è¦å‰‡
- ç·¨è¼¯å™¨å‹å–„
- ç‰ˆæœ¬æ§åˆ¶å‹å–„
- **è¦–è§’**: æ™‚é–“è»¸è¦–è§’ï¼ˆç¨‹å¼å¦‚ä½•ä¸€æ­¥æ­¥åŸ·è¡Œï¼‰

**æª”æ¡ˆæ ¼å¼**ï¼š`.c`, `.py`, `.js`, `.md` ç­‰

**ç¯„ä¾‹**ï¼š
```c
#include <stdio.h>

int main() {
    printf("Hello, World!\n");
    return 0;
}
```

#### 2. ç©æœ¨å½¢æ…‹ (Structure Form)

**å®šç¾©**ï¼šéšå±¤åŒ–çµæ§‹è¡¨ç¤ºï¼Œå¼·èª¿çµ„æˆé—œä¿‚å’Œæ¨¡çµ„åŒ–

**ç‰¹å¾µ**ï¼š
- æ¨¹ç‹€çµæ§‹
- èªæ³•ç„¡èª¤ï¼ˆby designï¼‰
- æ‹–æ”¾æ“ä½œ
- éšå±¤å¼çµ„åˆ
- **è¦–è§’**: çµ„æˆè¦–è§’ï¼ˆç¨‹å¼ç”±å“ªäº›éƒ¨åˆ†æ§‹æˆï¼‰

**æª”æ¡ˆæ ¼å¼**ï¼š`.json` (block definition), `.xml` (workspace)

**ç¯„ä¾‹**ï¼š
```blockly
[Hello World ç¨‹å¼]
  è¼¸å‡ºè¨Šæ¯: [Hello, World!]

å±•é–‹å¾Œï¼š
[include] <stdio.h>
[main function]
  [printf] "Hello, World!\n"
  [return] 0
```

**è¨­è¨ˆæ±ºç­–**: æ¡ç”¨ Blockly æ˜¯å› ç‚ºï¼š
- åˆå­¸è€…å‹å–„ï¼ˆèªæ³•ç„¡èª¤ä¿è­‰ï¼‰
- å¯è¦–åŒ–å±¤æ¬¡çµæ§‹
- æ”¯æ´è‡ªå®šç¾©ç©æœ¨ï¼ˆå¯æ“´å±•åˆ°æ‰€æœ‰èªè¨€å±¤ç´šï¼‰

#### 3. åœ–è­œå½¢æ…‹ (Topology Form)

**å®šç¾©**ï¼šé—œä¿‚ç¶²çµ¡è¡¨ç¤ºï¼Œå¼·èª¿ä¾è³´é—œä¿‚å’Œç³»çµ±æ¶æ§‹

**ç‰¹å¾µ**ï¼š
- ç¯€é»å’Œé‚Š
- å¤šå±¤ç´šè¦–åœ–
- äº’å‹•å¼æ¢ç´¢
- ä¾è³´é—œä¿‚æ¸…æ™°
- **è¦–è§’**: é—œä¿‚è¦–è§’ï¼ˆç¨‹å¼å…ƒç´ å¦‚ä½•äº’å‹•ï¼‰

**æª”æ¡ˆæ ¼å¼**ï¼š`.json` (graph), `.dot` (Graphviz)

**ç¯„ä¾‹**ï¼š
```
[nodes]
- stdio.h (library)
- main() (function)
- printf() (function)

[edges]
- main â†’ printf (calls)
- main â†’ stdio.h (depends)
```

**è¨­è¨ˆæ±ºç­–**: åƒè€ƒ Ryven å’Œ Grapycal çš„ç¯€é»ç·¨è¼¯å™¨è¨­è¨ˆã€‚

### è½‰æ›çŸ©é™£

ä¸‰ç¨®å½¢æ…‹ä¹‹é–“å…±æœ‰ **6 ç¨®è½‰æ›**ï¼š

```
         æ–‡å­—(Seq)   ç©æœ¨(Str)   åœ–è­œ(Top)
æ–‡å­—(Seq)    âœ“          â†”          â†”
ç©æœ¨(Str)    â†”          âœ“          â†”
åœ–è­œ(Top)    â†”          â†”          âœ“
```

| è½‰æ› | åç¨± | é›£åº¦ | æº–ç¢ºåº¦ | ä¸»è¦ç”¨é€” | è³‡è¨Šæå¤± |
|------|------|------|--------|----------|----------|
| Seq â†’ Str | çµæ§‹åŒ– (Structuring) | å›°é›£ | ä¸­ç­‰ | è¦–è¦ºåŒ–ç†è§£ | æ ¼å¼ã€è¨»è§£ä½ç½® |
| Str â†’ Seq | åºåˆ—åŒ– (Serialization) | ç°¡å–® | é«˜ | ç¨‹å¼ç¢¼ç”Ÿæˆ | ç©æœ¨çš„ UI æ’åˆ— |
| Seq â†’ Top | åœ–è­œåŒ– (Topologization) | ä¸­ç­‰ | é«˜ | æ¶æ§‹åˆ†æ | å¯¦ä½œç´°ç¯€ã€é †åº |
| Top â†’ Seq | åºåˆ—åŒ– (Sequentialization) | ä¸­ç­‰ | ä¸­ç­‰ | ç¨‹å¼ç¢¼é‡æ§‹ | é †åºä¸å”¯ä¸€ |
| Str â†’ Top | åœ–è­œåŒ– (Topologization) | ç°¡å–® | é«˜ | ä¾è³´è¦–è¦ºåŒ– | éšå±¤æ·±åº¦ |
| Top â†’ Str | çµæ§‹åŒ– (Structuralization) | ä¸­ç­‰ | ä¸­ç­‰ | é€†å‘å·¥ç¨‹ | çµæ§‹ç´°ç¯€ |

**è½‰æ›çš„éå°ç¨±æ€§**ï¼š
- Seq â†’ Str â†’ Seq: æ ¼å¼åŒ–æ¨™æº–åŒ–
- Seq â†’ Top â†’ Seq: ç¨‹å¼ç¢¼é‡æ§‹
- Str â†’ Top â†’ Str: çµæ§‹å„ªåŒ–

**é—œéµæ´å¯Ÿ**: è½‰æ›ä¸æ˜¯ã€Œç¿»è­¯ã€ï¼Œè€Œæ˜¯ã€Œè¦–è§’åˆ‡æ›ã€+ ã€ŒæŠ½è±¡å±¤ç´šæ”¹è®Šã€ã€‚æ¯æ¬¡è½‰æ›éƒ½ä¼´éš¨è³‡è¨Šæå¤±ï¼Œä½†é€™æ˜¯**å¿…ç„¶ä¸”å¿…è¦çš„**ã€‚

---

### è³‡è¨Šæå¤±èˆ‡è£œå„Ÿ

> **v3.0 æ ¸å¿ƒæ›´æ–°**ï¼šè³‡è¨Šæå¤±å…·æœ‰é›™é‡æ€§ (D)ï¼Œéœ€è¦å…ƒè³‡æ–™ç³»çµ±è£œå„Ÿä¸å¯é‚„åŸçš„éƒ¨åˆ†ã€‚

#### è³‡è¨Šæå¤±çš„é›™é‡æ€§ (D)

**Type 1: å¯é‚„åŸè³‡è¨Š (Restorable Information)**

é€™é¡è³‡è¨Šé›–ç„¶åœ¨è½‰æ›ä¸­ã€Œæ¶ˆå¤±ã€ï¼Œä½†å¯é€éå•Ÿç™¼å¼æ–¹æ³•æˆ– AI è¼”åŠ©é‚„åŸï¼š

```typescript
// ç¯„ä¾‹ 1: èªç¾©æ˜ç¢ºçš„å‘½å
int userCount;  // Seq
  â†“ [Seq â†’ Str]
[è®Šæ•¸å®£å‘Š] é¡å‹: int, åç¨±: userCount  // Str
  â†“ [Str â†’ Seq, AI è¼”åŠ©]
int userCount;  // âœ… æ„ç¾©å¯æ¨æ–·ï¼šã€Œä½¿ç”¨è€…è¨ˆæ•¸ã€

// ç¯„ä¾‹ 2: çµæ§‹æ€§è³‡è¨Š
ç©æœ¨çš„æ¨¹ç‹€çµæ§‹ â†’ å¯é‚„åŸç‚ºç¨‹å¼ç¢¼çš„ç¸®æ’çµæ§‹

// ç¯„ä¾‹ 3: å‹åˆ¥è³‡è¨Š
Topology ä¸­çš„ç¯€é»å‹åˆ¥ â†’ å¯é‚„åŸç‚º Structure çš„ç©æœ¨é¡å‹
```

**é‚„åŸæ–¹æ³•**ï¼š
- **å‘½åå•Ÿç™¼**: è‰¯å¥½çš„å‘½åæœ¬èº«å°±æ”œå¸¶èªç¾©
- **çµæ§‹å°æ‡‰**: æ¨¹ç‹€çµæ§‹ â†” ç¸®æ’çµæ§‹
- **å‹åˆ¥æ¨æ–·**: å¾é—œä¿‚æ¨æ–·å‹åˆ¥
- **AI è¼”åŠ©**: ä½¿ç”¨ LLM ç†è§£æ„åœ–

**Type 2: ä¸å¯é‚„åŸè³‡è¨Š (Non-restorable Information)**

é€™é¡è³‡è¨Šä¸€æ—¦éºå¤±ï¼Œå°±**ç„¡æ³•å¾å½¢æ…‹æœ¬èº«é‚„åŸ**ï¼Œå¿…é ˆä¾è³´**å…ƒè³‡æ–™ (Metadata)** è£œå„Ÿï¼š

```typescript
// ç¯„ä¾‹ 1: è¨­è¨ˆç†ç”± (Design Rationale)
// ç‚ºä»€éº¼ç”¨äºŒåˆ†æœå°‹è€Œä¸æ˜¯ç·šæ€§æœå°‹ï¼Ÿ
if (arr.length > 1000) {
    binarySearch(arr, target);  // âŒ ç„¡æ³•å¾ç¨‹å¼ç¢¼å¾—çŸ¥ã€Œç‚ºä»€éº¼ > 1000ã€
} else {
    linearSearch(arr, target);
}

// éœ€è¦å…ƒè³‡æ–™ï¼š
metadata: {
  designRationale: "ç•¶é™£åˆ—é•·åº¦è¶…é 1000 æ™‚ï¼ŒäºŒåˆ†æœå°‹çš„ O(log n) å„ªå‹¢æ‰æ˜é¡¯"
}

// ç¯„ä¾‹ 2: å•†æ¥­é‚è¼¯ (Business Logic)
if (age >= 18) {  // âŒ ç„¡æ³•å¾—çŸ¥ã€Œç‚ºä»€éº¼æ˜¯ 18ã€
    allowAccess();
}

// éœ€è¦å…ƒè³‡æ–™ï¼š
metadata: {
  businessRule: "æ³•å®šæˆå¹´å¹´é½¡ç‚º 18 æ­²ï¼ˆä¾æ“šç•¶åœ°æ³•å¾‹ï¼‰"
}

// ç¯„ä¾‹ 3: æ¬Šè¡¡å–æ¨ (Trade-offs)
cache.set(key, value, { ttl: 3600 });  // âŒ ç„¡æ³•å¾—çŸ¥ã€Œç‚ºä»€éº¼æ˜¯ 1 å°æ™‚ã€

// éœ€è¦å…ƒè³‡æ–™ï¼š
metadata: {
  tradeoffs: "TTL è¨­ç‚º 1 å°æ™‚ï¼šå¹³è¡¡è¨˜æ†¶é«”ä½¿ç”¨èˆ‡è³‡æ–™æ–°é®®åº¦"
}
```

**è£œå„Ÿç­–ç•¥**ï¼š
- **å…ƒè³‡æ–™ç³»çµ±**: ç¨ç«‹çš„ `.meta.json` æª”æ¡ˆ + åµŒå…¥å¼è¨»è§£
- **è¨»è§£éŒ¨é»**: éŒ¨å®šåˆ°ç‰¹å®šç¨‹å¼ç¢¼ä½ç½®
- **AI è¼”åŠ©åŒæ­¥**: å…ƒè³‡æ–™åœ¨ä¸‰å½¢æ…‹é–“æ™ºèƒ½åŒæ­¥
- **æ–‡æª”é€£çµ**: é€£çµåˆ°å®Œæ•´çš„è¨­è¨ˆæ–‡æª”

#### ç”Ÿç‰©å­¸é¡æ¯”èˆ‡å“²å­¸

**DNA â†’ è›‹ç™½è³ª â†’ ç´°èƒçµ„ç¹”**

| ç”Ÿç‰©å±¤ç´š | å°æ‡‰å½¢æ…‹ | è³‡è¨Šç‰¹æ€§ |
|---------|----------|----------|
| DNA åºåˆ— (ATCG) | Sequence | å®Œæ•´è³‡è¨Šï¼Œç·šæ€§è¡¨ç¤º |
| è›‹ç™½è³ªå››ç´šçµæ§‹ | Structure | æ‘ºç–Šå¾Œçš„ä¸‰ç¶­çµæ§‹ï¼Œæå¤±åºåˆ—ç´°ç¯€ |
| ç´°èƒçµ„ç¹”ç³»çµ± | Topology | åŠŸèƒ½ç¶²çµ¡ï¼Œæå¤±åˆ†å­ç´°ç¯€ |

**é—œéµæ´å¯Ÿ**ï¼š
1. **è³‡è¨Šæå¤±æ˜¯å¿…ç„¶çš„** - DNA è½‰è­¯æˆè›‹ç™½è³ªæ™‚ï¼Œæœƒæå¤±éç·¨ç¢¼å€è³‡è¨Š
2. **è³‡è¨Šæå¤±æ˜¯å¿…è¦çš„** - å¦‚æœä¿ç•™æ‰€æœ‰ç´°ç¯€ï¼Œç³»çµ±å°‡ç„¡æ³•è™•ç†è¤‡é›œæ€§
3. **æŠ½è±¡åŒ– = æœ‰é¸æ“‡æ€§çš„éºå¿˜** - ä¿ç•™ã€ŒåŠŸèƒ½æ ¸å¿ƒã€ï¼Œæ¨æ£„ã€Œéæœ¬è³ªè³‡è¨Šã€

**TextBricks çš„è¨­è¨ˆå“²å­¸**ï¼š
- **æ¥å—è³‡è¨Šæå¤±** - ä¸è¿½æ±‚ 100% å¯é€†
- **ä¿ç•™æ ¸å¿ƒåŠŸèƒ½** - ç¢ºä¿ç¨‹å¼é‚è¼¯ä¸æå¤±
- **å…ƒè³‡æ–™è£œå„Ÿ** - å°æ–¼ä¸å¯é‚„åŸçš„éƒ¨åˆ†ï¼Œç”¨å…ƒè³‡æ–™ç³»çµ±è£œå„Ÿ
- **AI è¼”åŠ©é‚„åŸ** - å°æ–¼å¯é‚„åŸçš„éƒ¨åˆ†ï¼Œç”¨ AI è¼”åŠ©é‡å»º

#### æ”¶æ–‚æ©Ÿåˆ¶

```
åŸå§‹ç¨‹å¼ï¼ˆåŒ…å«æ‰€æœ‰ç´°ç¯€ï¼‰
   â†“ [Seq â†’ Str]
ç©æœ¨è¡¨ç¤º (æå¤±ï¼šæ ¼å¼ã€è¨»è§£ä½ç½®) â† å¯é‚„åŸ
   â†“ [Str â†’ Top]
åœ–è­œè¡¨ç¤º (æå¤±ï¼šå¯¦ä½œç´°ç¯€ã€é †åº) â† éƒ¨åˆ†å¯é‚„åŸ
   â†“ [Top â†’ Str]
é‡å»ºç©æœ¨ (ä¿ç•™ï¼šæ ¸å¿ƒé‚è¼¯ã€ä¾è³´é—œä¿‚)
   â†“ [Str â†’ Seq]
é‡å»ºç¨‹å¼ (æ¨™æº–åŒ–ã€ç°¡åŒ–) â† å…ƒè³‡æ–™è£œå„Ÿä¸å¯é‚„åŸéƒ¨åˆ†
```

**æ”¶æ–‚ç‰¹æ€§**ï¼š
- **å¤šæ¬¡è½‰æ›å¾Œè¶¨æ–¼ç©©å®š** - é¡ä¼¼èƒ½é‡æœ€å°åŒ–
- **ä¿ç•™æœ¬è³ªç‰¹å¾µ** - æ ¸å¿ƒé‚è¼¯å’Œä¾è³´é—œä¿‚
- **æ¨™æº–åŒ–å‰¯ä½œç”¨** - ç¨‹å¼ç¢¼é¢¨æ ¼çµ±ä¸€
- **å…ƒè³‡æ–™æŒä¹…åŒ–** - ä¸å¯é‚„åŸçš„è³‡è¨Šéœ€è¦å…ƒè³‡æ–™ç³»çµ±ä¿å­˜

**å¯¦éš›æ‡‰ç”¨**ï¼š
- **ç¨‹å¼ç¢¼æ¨™æº–åŒ–**: é€é Seq â†’ Str â†’ Seq çµ±ä¸€é¢¨æ ¼
- **æ¶æ§‹é‡æ§‹**: é€é Seq â†’ Top â†’ Seq å„ªåŒ–çµæ§‹
- **çŸ¥è­˜èƒå–**: é€éå¤šæ¬¡è½‰æ›æå–æ ¸å¿ƒæ¦‚å¿µ

---

## å››ç´šç©æœ¨ç³»çµ±

### è¨­è¨ˆå‹•æ©Ÿ

åœ¨èªè¨€å±¤ç´šæ¶æ§‹ä¸­ï¼Œæˆ‘å€‘ç™¼ç¾ä¸è«–å“ªå€‹æŠ½è±¡å±¤ç´šï¼Œç¨‹å¼éƒ½æœ‰**ä¸åŒçš„ç²’åº¦**ã€‚å››ç´šç©æœ¨ç³»çµ±å®šç¾©äº†å¾æœ€ç´°åˆ°æœ€ç²—çš„å››å€‹ç²’åº¦å±¤æ¬¡ã€‚

### å››å±¤ç²’åº¦ç³»çµ±

```
L0 (ç³»çµ±ç´š) â”
            â”œâ”€ å±•é–‹/æ‘ºç–Š â”€â”
L1 (æ¨¡æ¿ç´š) â”¤            â”œ  å½ˆæ€§åˆ‡æ›
            â”œâ”€ å±•é–‹/æ‘ºç–Š â”€â”¤
L2 (èªå¥ç´š) â”¤            â”‚
            â”œâ”€ å±•é–‹/æ‘ºç–Š â”€â”˜
L3 (è¡¨é”å¼ç´š) â”˜
```

#### L0 - ç³»çµ±ç´š (System Level)

**å®šç¾©**ï¼šå¤šå€‹æ¨¡çµ„æˆ–æ¨¡æ¿çµ„æˆçš„å®Œæ•´ç³»çµ±

**ç‰¹å¾µ**ï¼š
- æ¨¡çµ„é–“å”åŒ
- ç³»çµ±ç´šåŠŸèƒ½
- ä»‹é¢å®šç¾©
- ä¸»è¦é€éåœ–è­œè¦–è¦ºåŒ–

**ç¯„ä¾‹**ï¼š
- **ç¨‹å¼èªè¨€**ï¼šå¤šæ¨¡çµ„çš„å®Œæ•´æ‡‰ç”¨ç¨‹å¼
- **è‡ªç„¶èªè¨€**ï¼šå®Œæ•´çš„ Spec æ–‡ä»¶
- **HDL**ï¼šå®Œæ•´çš„ SoC (System-on-Chip)

#### L1 - æ¨¡æ¿ç´š (Template Level)

**å®šç¾©**ï¼šä¸€å€‹å®Œæ•´çš„ç¨‹å¼æˆ–åŠŸèƒ½å–®å…ƒ

**ç‰¹å¾µ**ï¼š
- å¯å±•é–‹æˆ L2 ç©æœ¨çµ„åˆ
- æœ‰ç‰¹å®šçš„å®Œæ•´åŠŸèƒ½
- å¯ç¨ç«‹ä½¿ç”¨æˆ–ä½œç‚º L0 çš„çµ„æˆéƒ¨åˆ†

**ç¯„ä¾‹**ï¼š
- **ç¨‹å¼èªè¨€**ï¼šå®Œæ•´çš„å‡½å¼ã€é¡åˆ¥
- **è‡ªç„¶èªè¨€**ï¼šå–®ä¸€ Feature Specã€ç« ç¯€
- **HDL**ï¼šå®Œæ•´çš„æ¨¡çµ„ (Module)
- **Assembly**ï¼šå®Œæ•´çš„å‡½å¼æˆ–å­ç¨‹å¼

#### L2 - èªå¥ç´š (Statement Level)

**å®šç¾©**ï¼šå–®ä¸€èªå¥æˆ–æ§åˆ¶çµæ§‹

**ç‰¹å¾µ**ï¼š
- å¯è‡ªç”±çµ„åˆ
- æœ‰å®Œæ•´èªç¾©
- æ˜¯ç©æœ¨ç·¨è¼¯çš„ä¸»è¦ç²’åº¦
- æœ€é©åˆè¦–è¦ºåŒ–æ“ä½œ

**ç¯„ä¾‹**ï¼š
- **ç¨‹å¼èªè¨€**ï¼šfor loop, if statement, function call
- **è‡ªç„¶èªè¨€**ï¼šRequirement statementã€æ®µè½
- **HDL**ï¼šalways block, assign statement
- **Assembly**ï¼šæŒ‡ä»¤åºåˆ— (å¦‚ loop prologue)

#### L3 - è¡¨é”å¼ç´š (Expression Level)

**å®šç¾©**ï¼šæœ€åŸºæœ¬çš„æ“ä½œå…ƒç´ 

**ç‰¹å¾µ**ï¼š
- æœ€ç´°ç²’åº¦
- å¯çµ„åˆæˆ L2
- é€šå¸¸æ˜¯åŸå­æ“ä½œ

**ç¯„ä¾‹**ï¼š
- **ç¨‹å¼èªè¨€**ï¼šé‹ç®—ç¬¦ (+, -, *), å‡½å¼å‘¼å«, è®Šæ•¸å­˜å–
- **è‡ªç„¶èªè¨€**ï¼šæ¦‚å¿µç‰‡æ®µ ("ä½¿ç”¨è€…", "JWT token", "éæœŸæ™‚é–“")
- **HDL**ï¼šé‚è¼¯é–˜ (AND, OR), è³¦å€¼
- **Assembly**ï¼šå–®ä¸€æŒ‡ä»¤ (MOV, ADD, JMP)
- **Machine Code**ï¼šå–®ä¸€ä½å…ƒçµ„ç¢¼

### è·¨èªè¨€å±¤ç´šçš„å››ç´šå°æ‡‰

| å±¤ç´š | è‡ªç„¶èªè¨€ | ç¨‹å¼èªè¨€ | Assembly | HDL | Machine Code |
|------|---------|---------|----------|-----|--------------|
| **L0** | å®Œæ•´æ–‡ä»¶ | å¤šæ¨¡çµ„ç³»çµ± | å®Œæ•´ç¨‹å¼ | SoC ç³»çµ± | å®Œæ•´åŸ·è¡Œæª” |
| **L1** | Feature Spec | å‡½å¼/é¡åˆ¥ | å­ç¨‹å¼ | Module | å‡½å¼å€å¡Š |
| **L2** | æ®µè½ | for/if/while | æŒ‡ä»¤åºåˆ— | always/assign | æŒ‡ä»¤å€å¡Š |
| **L3** | æ¦‚å¿µç‰‡æ®µ | +/-/* | MOV/ADD | AND/OR | å–®ä¸€ä½å…ƒçµ„ |

### æ™®éè¦å¾‹

**é—œéµç™¼ç¾**ï¼šå››ç´šç©æœ¨ç³»çµ±æ˜¯ä¸€å€‹**æ™®éè¦å¾‹**ï¼Œé©ç”¨æ–¼æ‰€æœ‰èªè¨€å±¤ç´šã€‚

é›–ç„¶ä¸åŒèªè¨€çš„å…·é«”è¡¨ç¾ä¸åŒï¼Œä½†æŠ½è±¡çš„å±¤æ¬¡é—œä¿‚æ˜¯ä¸€è‡´çš„ï¼š
- **L0**: å®Œæ•´ç³»çµ±
- **L1**: ç¨ç«‹åŠŸèƒ½å–®å…ƒ
- **L2**: å¯çµ„åˆçš„èªå¥/å€å¡Š
- **L3**: åŸºæœ¬æ“ä½œå…ƒç´ 

é€™ç¨®ä¸€è‡´æ€§ä½¿å¾—ï¼š
1. è½‰æ›å¼•æ“å¯ä»¥çµ±ä¸€è¨­è¨ˆ
2. å±•é–‹/æ‘ºç–Šæ©Ÿåˆ¶å¯ä»¥å…±ç”¨
3. ä½¿ç”¨è€…å¯ä»¥ç”¨ç›¸åŒçš„å¿ƒæ™ºæ¨¡å‹ç†è§£ä¸åŒèªè¨€
4. AI å¯ä»¥å­¸ç¿’é€šç”¨çš„æŠ½è±¡æ¨¡å¼

---

## è³‡è¨Šæå¤±èˆ‡è½‰æ›

### è³‡è¨Šæå¤±çš„æœ¬è³ª

**v3.0 æ·±åŒ–ç†è§£**ï¼šè³‡è¨Šæå¤±æœ‰å…©ç¨®æ€§è³ªï¼š

#### 1. å¯é‚„åŸçš„è³‡è¨Š

**ç‰¹å¾µ**ï¼šå¯ä»¥å¾ä¸Šä¸‹æ–‡æˆ–èªç¾©æ¨æ–·å›ä¾†

**ç¯„ä¾‹**ï¼š
- **èªç¾©æ˜ç¢ºçš„å‘½å**ï¼š`userCount` â†’ å¯æ¨æ–·æ˜¯ã€Œä½¿ç”¨è€…è¨ˆæ•¸ã€
- **çµæ§‹æ€§è³‡è¨Š**ï¼šç©æœ¨çš„æ¨¹ç‹€çµæ§‹ â†’ å¯é‚„åŸç‚ºç¨‹å¼ç¢¼
- **å‹åˆ¥è³‡è¨Š**ï¼šéœæ…‹å‹åˆ¥èªè¨€ä¸­ï¼Œå‹åˆ¥å¯å¾å®£å‘Šé‚„åŸ

**è™•ç†æ–¹å¼**ï¼š
- ç³»çµ±å¯ä»¥è‡ªå‹•é‚„åŸ
- æˆ–æä¾›æ™ºèƒ½å»ºè­°è®“ä½¿ç”¨è€…ç¢ºèª

#### 2. ä¸å¯é‚„åŸçš„è³‡è¨Š

**ç‰¹å¾µ**ï¼šéš±è—çš„æ„åœ–ã€è¨­è¨ˆæ±ºç­–ã€èƒŒæ™¯çŸ¥è­˜

**ç¯„ä¾‹**ï¼š
- **è¨­è¨ˆç†ç”±**ï¼šã€Œç‚ºä»€éº¼ç”¨äºŒåˆ†æœå°‹è€Œä¸æ˜¯ç·šæ€§æœå°‹ï¼Ÿã€
- **å•†æ¥­é‚è¼¯**ï¼šã€Œç‚ºä»€éº¼é€™å€‹æ¢ä»¶æ˜¯ > 10 è€Œä¸æ˜¯ >= 10ï¼Ÿã€
- **ç‰¹æ®Šè€ƒé‡**ï¼šã€Œé€™å€‹ edge case æ˜¯ç‚ºäº†è™•ç†ä»€éº¼æƒ…æ³ï¼Ÿã€
- **æ•ˆèƒ½æ¬Šè¡¡**ï¼šã€Œç‚ºä»€éº¼é¸æ“‡é€™å€‹æ¼”ç®—æ³•ï¼Ÿã€

**è™•ç†æ–¹å¼**ï¼š
- å¿…é ˆé€éè¨»è§£/å…ƒè³‡æ–™è£œå……
- éœ€è¦äººé¡æˆ– AI çš„ç†è§£å’Œè§£é‡‹
- é€™æ­£æ˜¯**å…ƒè³‡æ–™ç³»çµ±**çš„åƒ¹å€¼æ‰€åœ¨

### æå¤±çš„å±¤æ¬¡åˆ†æ

```
Sequence (æœ€å…·é«”) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â†“ æå¤±ï¼šæ ¼å¼ã€å‘½åé¢¨æ ¼   â”‚ å¯é‚„åŸå€åŸŸ
Structure (è¼ƒæŠ½è±¡) â”€â”€â”€â”€â”€â”€â”€â”€â”¤ (è‰¯å¥½å‘½åã€æ¸…æ™°çµæ§‹)
  â†“ æå¤±ï¼šå¯¦ä½œç´°ç¯€         â”‚
Topology (æœ€æŠ½è±¡) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“ æå¤±ï¼šè¨­è¨ˆæ„åœ– â†â”€â”€â”€â”€ ä¸å¯é‚„åŸå€åŸŸ
                          (éœ€è¦å…ƒè³‡æ–™è£œå……)
```

### è½‰æ›çš„æ–¹å‘æ€§

#### å‘ä¸ŠæŠ½è±¡ï¼ˆSequence â†’ Structure â†’ Topologyï¼‰

**éç¨‹**ï¼šç²¾ç…‰ã€æå–æœ¬è³ª
**æå¤±**ï¼šç´°ç¯€ã€å¯¦ä½œæ–¹å¼
**ä¿ç•™**ï¼šæ ¸å¿ƒé‚è¼¯ã€é—œä¿‚çµæ§‹

**é¡æ¯”**ï¼šé¡ä¼¼æ–¼æ©Ÿå™¨å­¸ç¿’çš„ Encoder
- å£“ç¸®è³‡è¨Š
- æå–ç‰¹å¾µ
- æå¤±æ˜¯**å¿…è¦çš„æŠ½è±¡**

#### å‘ä¸‹å…·é«”åŒ–ï¼ˆTopology â†’ Structure â†’ Sequenceï¼‰

**éç¨‹**ï¼šè£œå……è³‡è¨Šã€åšæ±ºç­–
**éœ€è¦**ï¼šè¨­è¨ˆé¸æ“‡ã€å¯¦ä½œç´°ç¯€
**æŒ‘æˆ°**ï¼šæœ‰å¤šç¨®å¯èƒ½çš„å…·é«”åŒ–æ–¹å¼

**é¡æ¯”**ï¼šé¡ä¼¼æ–¼æ©Ÿå™¨å­¸ç¿’çš„ Decoder
- é‡å»ºç´°ç¯€
- å¡«è£œè³‡è¨Š
- éœ€è¦**é¡å¤–çŸ¥è­˜**ï¼ˆé€™å°±æ˜¯ Transformation Assistant çš„ä½œç”¨ï¼‰

### æ”¶æ–‚èˆ‡ç©©å®šæ€§

ç¶“éå¤šæ¬¡å½¢æ…‹è½‰æ›å¾Œï¼š

```
åŸå§‹ç¨‹å¼ (é¢¨æ ¼å„ç•°)
  â†“ Seq â†’ Str â†’ Top â†’ Str â†’ Seq
æ¨™æº–åŒ–ç¨‹å¼ (æ”¶æ–‚åˆ°ç©©å®šå½¢å¼)
```

**æ”¶æ–‚ç‰¹æ€§**ï¼š
- **ä¿ç•™æœ¬è³ª**ï¼šæ ¸å¿ƒé‚è¼¯ä¸è®Š
- **æå¤±éæœ¬è³ª**ï¼šæ ¼å¼ã€é¢¨æ ¼çµ±ä¸€åŒ–
- **è¶¨æ–¼ç©©å®š**ï¼šå¤šæ¬¡è½‰æ›å¾Œä¸å†è®ŠåŒ–
- **èƒ½é‡æœ€å°åŒ–**ï¼šé¡ä¼¼ç‰©ç†ç³»çµ±æ‰¾åˆ°ç©©å®šæ…‹

**æ‡‰ç”¨**ï¼š
- ç¨‹å¼ç¢¼æ¨™æº–åŒ–
- é‡æ§‹å»ºè­°
- æ„åœ–æå–
- AI è¨“ç·´è³‡æ–™ç”Ÿæˆ

---

## å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ

### æ¨¡æ¿çš„é‡æ–°å®šç¾©

**v3.0 æ ¸å¿ƒæ¦‚å¿µ**ï¼šTextBricks çš„æ¨¡æ¿ä¸åªæ˜¯ã€Œç¨‹å¼ç¢¼ç‰‡æ®µã€ï¼Œè€Œæ˜¯**å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ** (Multi-Form Knowledge Unit)ã€‚

### å®Œæ•´çš„çŸ¥è­˜åŒ…

ä¸€å€‹å®Œæ•´çš„ TextBricks æ¨¡æ¿åŒ…å«ï¼š

```typescript
interface MultiFormKnowledgeUnit {
  // 1. åŸºæœ¬è³‡è¨Š
  id: string;
  name: string;
  description: string;
  author: string;
  version: string;

  // 2. èªè¨€å±¤ç´š
  languageLevel: {
    type: "natural" | "high-level" | "low-level" | "machine" | "hdl" | "physical";
    specific?: string;  // "english", "python", "x86-asm", "verilog"
  };

  // 3. ç²’åº¦å±¤ç´š
  granularity: "L0" | "L1" | "L2" | "L3";

  // 4. ä¸‰ç¨®å½¢æ…‹
  forms: {
    sequence: {
      content: string;              // æ–‡å­—å…§å®¹
      language: string;              // èªè¨€ï¼ˆmarkdown, python, verilogï¼‰
      format: string;                // æª”æ¡ˆæ ¼å¼ï¼ˆ.md, .py, .vï¼‰
    };

    structure: {
      blocks: BlockDefinition[];     // ç©æœ¨å®šç¾©
      workspace?: string;            // Blockly workspace XML
      schema?: any;                  // çµæ§‹åŒ– schema
    };

    topology: {
      nodes: Node[];                 // ç¯€é»
      edges: Edge[];                 // é‚Š
      layout?: LayoutConfig;         // å¸ƒå±€é…ç½®
      graphType: "call" | "data-flow" | "dependency" | "control-flow";
    };
  };

  // 5. å…ƒè³‡æ–™ï¼ˆæ ¸å¿ƒï¼ï¼‰
  metadata: {
    // 5.1 è¨­è¨ˆçŸ¥è­˜
    designRationale?: string;        // ç‚ºä»€éº¼é€™æ¨£è¨­è¨ˆ
    tradeoffs?: string[];            // æ¬Šè¡¡è€ƒé‡
    alternatives?: Alternative[];    // å…¶ä»–é¸æ“‡

    // 5.2 ä½¿ç”¨æƒ…å¢ƒ
    useCases?: string[];             // é©ç”¨å ´æ™¯
    antiPatterns?: string[];         // åæ¨¡å¼ï¼ˆä½•æ™‚ä¸è©²ç”¨ï¼‰

    // 5.3 ä¾è³´èˆ‡é—œè¯
    dependencies?: Dependency[];     // ä¾è³´çš„å…¶ä»–æ¨¡æ¿
    relatedTemplates?: string[];     // ç›¸é—œæ¨¡æ¿

    // 5.4 å“è³ªæŒ‡æ¨™
    verified: boolean;               // æ˜¯å¦å·²é©—è­‰
    rating: number;                  // è©•åˆ†
    usageCount: number;              // ä½¿ç”¨æ¬¡æ•¸

    // 5.5 æ•™å­¸è³‡è¨Š
    difficulty: "beginner" | "intermediate" | "advanced";
    learningPath?: string[];         // å‰ç½®æ¨¡æ¿
    exercises?: Exercise[];          // ç·´ç¿’é¡Œ
  };

  // 6. è¨»è§£ç³»çµ±ï¼ˆå¤šå±¤æ¬¡ï¼‰
  annotations: {
    // 6.1 éšå±¤çµæ§‹ï¼ˆå°æ‡‰ç¨‹å¼ç¢¼çµæ§‹ï¼‰
    hierarchical: AnnotationTree;

    // 6.2 å¤šç²’åº¦ç´¢å¼•ï¼ˆå¿«é€ŸæŸ¥è©¢ï¼‰
    byLevel: {
      function?: Map<string, Annotation>;
      statement?: Map<number, Annotation>;  // line number
      block?: Map<string, Annotation>;
    };

    // 6.3 éŒ¨é»ç³»çµ±ï¼ˆå½ˆæ€§æŒ‡å‘ï¼‰
    anchored: AnchoredAnnotation[];
  };

  // 7. é ˜åŸŸæ’ä»¶ï¼ˆå¯é¸ï¼‰
  plugins?: {
    hdl?: HDLMetadata;               // HDL ç‰¹å®šè³‡è¨Š
    python?: PythonMetadata;         // Python ç‰¹å®šè³‡è¨Š
    assembly?: AssemblyMetadata;     // Assembly ç‰¹å®šè³‡è¨Š
    // ... å¯æ“´å±•
  };

  // 8. è®Šæ•¸èˆ‡åƒæ•¸åŒ–ï¼ˆå¾ v2.0 ä¿ç•™ï¼‰
  variables?: Variable[];            // å¯å¡«å……çš„è®Šæ•¸

  // 9. è½‰æ›è¦å‰‡ï¼ˆæ–°å¢ï¼‰
  transformRules?: {
    toOtherLanguages?: LanguageMapping[];  // è·¨èªè¨€è½‰æ›
    toOtherGranularities?: GranularityMapping[];  // è·¨ç²’åº¦è½‰æ›
  };
}
```

### çŸ¥è­˜çš„å¤šå€‹ç¶­åº¦

ä¸€å€‹æ¨¡æ¿å¯ä»¥å¾å¤šå€‹ç¶­åº¦è¢«æª¢ç´¢å’Œä½¿ç”¨ï¼š

#### ç¶­åº¦ 1: èªè¨€å±¤ç´š
- ã€Œçµ¦æˆ‘æ‰€æœ‰ Python çš„æ¨¡æ¿ã€
- ã€Œçµ¦æˆ‘æ‰€æœ‰è‡ªç„¶èªè¨€çš„ Spec æ¨¡æ¿ã€
- ã€Œçµ¦æˆ‘æ‰€æœ‰ Verilog HDL çš„æ¨¡æ¿ã€

#### ç¶­åº¦ 2: ç²’åº¦å±¤ç´š
- ã€Œçµ¦æˆ‘æ‰€æœ‰ L2 (èªå¥ç´š) çš„æ¨¡æ¿ã€
- ã€Œçµ¦æˆ‘å¯ä»¥çµ„åˆæˆ L1 çš„ L2 æ¨¡æ¿ã€

#### ç¶­åº¦ 3: å½¢æ…‹
- ã€Œçµ¦æˆ‘é€™å€‹æ¨¡æ¿çš„ Sequence å½¢å¼ã€
- ã€Œè½‰æ›åˆ° Topology è¦–åœ–ã€

#### ç¶­åº¦ 4: åŠŸèƒ½åˆ†é¡
- ã€Œçµ¦æˆ‘æ‰€æœ‰è¿´åœˆç›¸é—œçš„æ¨¡æ¿ã€
- ã€Œçµ¦æˆ‘æ‰€æœ‰ API ç«¯é»çš„è¦æ ¼æ¨¡æ¿ã€

#### ç¶­åº¦ 5: ä½¿ç”¨æƒ…å¢ƒ
- ã€Œåˆå­¸è€…é©ç”¨çš„æ¨¡æ¿ã€
- ã€Œæ•ˆèƒ½å„ªåŒ–çš„æ¨¡æ¿ã€

#### ç¶­åº¦ 6: å“è³ªæŒ‡æ¨™
- ã€Œæœ€å¤šäººä½¿ç”¨çš„æ¨¡æ¿ã€
- ã€Œæœ€é«˜è©•åˆ†çš„æ¨¡æ¿ã€

### ç‚ºä»€éº¼æ˜¯ã€ŒçŸ¥è­˜å–®å…ƒã€ï¼Ÿ

å‚³çµ±çš„ç¨‹å¼ç¢¼ç‰‡æ®µåªæœ‰ã€ŒHowã€ï¼ˆæ€éº¼å¯«ï¼‰ï¼Œè€ŒçŸ¥è­˜å–®å…ƒé‚„åŒ…å«ï¼š

1. **Why** - ç‚ºä»€éº¼é€™æ¨£è¨­è¨ˆï¼Ÿè¨­è¨ˆç†ç”±åœ¨å…ƒè³‡æ–™ä¸­
2. **When** - ä½•æ™‚ä½¿ç”¨ï¼Ÿä½¿ç”¨æƒ…å¢ƒå’Œåæ¨¡å¼
3. **What** - åšä»€éº¼ï¼Ÿä¸‰ç¨®å½¢æ…‹è¡¨é”åŒä¸€æ„åœ–
4. **Where** - åœ¨å“ªå€‹å±¤ç´šï¼Ÿèªè¨€å±¤ç´šå’Œç²’åº¦å±¤ç´š
5. **Who** - é©åˆèª°ï¼Ÿé›£åº¦å’Œå­¸ç¿’è·¯å¾‘
6. **Which** - é‚„æœ‰ä»€éº¼é¸æ“‡ï¼Ÿæ›¿ä»£æ–¹æ¡ˆå’Œæ¬Šè¡¡

### ç¤¾ç¾¤è²¢ç»çš„æ¼”é€²

åŸºæ–¼å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒï¼Œç¤¾ç¾¤å¯ä»¥è²¢ç»ï¼š

**Phase 1: åŸºç¤æ¨¡æ¿** (ç•¶å‰)
- è²¢ç» Sequence form çš„ç¨‹å¼ç¢¼ç‰‡æ®µ

**Phase 2: å¤šå½¢æ…‹æ¨¡æ¿** (v0.4-v0.5)
- è²¢ç»å®Œæ•´çš„ Sequence + Structure + Topology
- ç³»çµ±è¼”åŠ©ç”Ÿæˆå…¶ä»–å½¢æ…‹

**Phase 3: çŸ¥è­˜è±å¯ŒåŒ–** (v0.6-v1.0)
- è²¢ç»å…ƒè³‡æ–™ï¼šè¨­è¨ˆç†ç”±ã€ä½¿ç”¨æƒ…å¢ƒã€æ¬Šè¡¡åˆ†æ
- è²¢ç»è½‰æ›è¦å‰‡ï¼šå¦‚ä½•å¾é€™å€‹æ¨¡æ¿è½‰åˆ°å…¶ä»–èªè¨€/ç²’åº¦
- ç´¯ç©æˆçŸ¥è­˜åœ–è­œ

**Phase 4: AI è¨“ç·´è³‡æ–™** (v1.0+)
- æ‰€æœ‰çš„æ¨¡æ¿ + å…ƒè³‡æ–™æˆç‚º AI è¨“ç·´è³‡æ–™
- AI å­¸ç¿’ã€Œå¾æ„åœ–åˆ°å¯¦ç¾ã€çš„æ˜ å°„
- æå‡ Coding Agent çš„å“è³ª

### ç¯„ä¾‹ï¼šå®Œæ•´çš„çŸ¥è­˜å–®å…ƒ

```typescript
// ç¯„ä¾‹ï¼šBinary Search Algorithm Template
{
  id: "algorithm-binary-search-c",
  name: "Binary Search Algorithm",
  languageLevel: { type: "high-level", specific: "C" },
  granularity: "L1",  // å®Œæ•´å‡½å¼

  forms: {
    sequence: {
      content: `int binarySearch(int arr[], int n, int target) {
    int left = 0, right = n - 1;

    while (left <= right) {
        int mid = left + (right - left) / 2;

        if (arr[mid] == target) return mid;
        if (arr[mid] < target) left = mid + 1;
        else right = mid - 1;
    }
    return -1;
}`,
      language: "c",
      format: ".c"
    },

    structure: {
      blocks: [
        { type: "function", name: "binarySearch", ... },
        { type: "while-loop", condition: "left <= right", ... },
        // ...
      ]
    },

    topology: {
      nodes: [
        { id: "init", type: "init", label: "left=0, right=n-1" },
        { id: "check", type: "condition", label: "left <= right" },
        { id: "mid", type: "compute", label: "mid = left + (right-left)/2" },
        { id: "compare", type: "condition", label: "arr[mid] vs target" },
        // ...
      ],
      edges: [
        { from: "init", to: "check" },
        { from: "check", to: "mid", condition: "true" },
        { from: "mid", to: "compare" },
        // ...
      ],
      graphType: "control-flow"
    }
  },

  metadata: {
    designRationale: "ä½¿ç”¨äºŒåˆ†æœå°‹è€Œéç·šæ€§æœå°‹ï¼Œå› ç‚ºåœ¨å·²æ’åºé™£åˆ—ä¸­ï¼ŒäºŒåˆ†æœå°‹çš„æ™‚é–“è¤‡é›œåº¦ç‚º O(log n)ï¼Œé å„ªæ–¼ç·šæ€§æœå°‹çš„ O(n)ã€‚",

    tradeoffs: [
      "éœ€è¦é™£åˆ—å·²æ’åºï¼ˆå‰ææ¢ä»¶ï¼‰",
      "ä¸é©åˆé »ç¹æ’å…¥/åˆªé™¤çš„å ´æ™¯ï¼ˆæœƒç ´å£æ’åºï¼‰",
      "ç›¸æ¯”ç·šæ€§æœå°‹ï¼Œå¯¦ä½œç¨è¤‡é›œ"
    ],

    alternatives: [
      {
        name: "Linear Search",
        when: "è³‡æ–™æœªæ’åºã€è³‡æ–™é‡å°ï¼ˆ< 100ï¼‰",
        tradeoff: "ç°¡å–®ä½†æ…¢"
      },
      {
        name: "Hash Table",
        when: "éœ€è¦ O(1) æŸ¥è©¢ã€å…è¨±é¡å¤–ç©ºé–“",
        tradeoff: "ç©ºé–“æ›æ™‚é–“"
      }
    ],

    useCases: [
      "åœ¨å¤§é‡å·²æ’åºè³‡æ–™ä¸­æŸ¥æ‰¾",
      "è³‡æ–™åº«ç´¢å¼•æŸ¥è©¢",
      "å­—å…¸æŸ¥è©¢"
    ],

    antiPatterns: [
      "è³‡æ–™æœªæ’åºæ™‚ä½¿ç”¨ï¼ˆæœƒå¾—åˆ°éŒ¯èª¤çµæœï¼‰",
      "è³‡æ–™é‡æ¥µå°æ™‚ï¼ˆ< 10ï¼‰ï¼Œä¸å¦‚ç·šæ€§æœå°‹"
    ],

    difficulty: "intermediate",
    learningPath: ["array-basics", "while-loop", "recursion-basics"]
  },

  annotations: {
    hierarchical: {
      function: {
        comment: "å¯¦ä½œäºŒåˆ†æœå°‹æ¼”ç®—æ³•",
        children: {
          whileLoop: {
            comment: "æŒçºŒäºŒåˆ†ç›´åˆ°æ‰¾åˆ°æˆ–ç¢ºå®šä¸å­˜åœ¨",
            children: {
              midCalculation: {
                comment: "ä½¿ç”¨ left + (right-left)/2 é¿å…æ•´æ•¸æº¢ä½",
                line: 5
              }
            }
          }
        }
      }
    },

    byLevel: {
      function: { "binarySearch": { type: "design-rationale", ... } },
      statement: { 5: { type: "optimization", ... } }
    },

    anchored: [
      {
        anchor: { type: "statement", line: 5 },
        type: "optimization",
        content: "é¿å… (left + right) / 2 å¯èƒ½çš„æ•´æ•¸æº¢ä½"
      }
    ]
  },

  transformRules: {
    toOtherLanguages: [
      { target: "python", difficulty: "easy" },
      { target: "javascript", difficulty: "easy" }
    ],
    toOtherGranularities: [
      { target: "L2", method: "extract while loop as separate block" }
    ]
  }
}
```

---

## å…ƒè³‡æ–™èˆ‡è¨»è§£ç®¡ç†ç³»çµ±

### è¨­è¨ˆå‹•æ©Ÿ

åœ¨ã€Œè³‡è¨Šæå¤±èˆ‡è½‰æ›ã€ä¸­ï¼Œæˆ‘å€‘ç™¼ç¾æœ‰äº›è³‡è¨Šï¼ˆè¨­è¨ˆæ„åœ–ã€æ¬Šè¡¡è€ƒé‡ï¼‰æ˜¯**ä¸å¯å¾ç¨‹å¼ç¢¼é‚„åŸçš„**ã€‚é€™äº›è³‡è¨Šéœ€è¦é€é**å…ƒè³‡æ–™å’Œè¨»è§£**ä¾†ä¿å­˜ã€‚

### è¨»è§£çš„é›™é‡æ€§è³ª

åŸºæ–¼æˆ‘å€‘çš„è¨è«–ï¼Œè¨»è§£åŒæ™‚å…·æœ‰å…©ç¨®æ€§è³ªï¼š

#### 1. ç¨ç«‹çš„å…ƒè³‡æ–™ (Meta.json)

**ç‰¹å¾µ**ï¼š
- èˆ‡ç¨‹å¼ç¢¼åˆ†é›¢å­˜å„²
- çµæ§‹åŒ–ã€å¯æŸ¥è©¢
- è·¨å½¢æ…‹å…±äº«

**ç”¨é€”**ï¼š
- è¨­è¨ˆç†ç”±ã€æ¬Šè¡¡åˆ†æ
- ä½¿ç”¨æƒ…å¢ƒã€åæ¨¡å¼
- å“è³ªæŒ‡æ¨™ã€å­¸ç¿’è·¯å¾‘

#### 2. åµŒå…¥åœ¨å„å½¢æ…‹ä¸­

**ç‰¹å¾µ**ï¼š
- èˆ‡ç¨‹å¼ç¢¼ç·Šå¯†çµåˆ
- å½¢æ…‹ç‰¹å®šçš„è¡¨ç¾æ–¹å¼

**ç¯„ä¾‹**ï¼š
```typescript
{
  Sequence: "// é€™æ˜¯è¨»è§£",
  Structure: { description: "é€™æ˜¯ç©æœ¨èªªæ˜" },
  Topology: { nodeLabel: "é€™æ˜¯ç¯€é»æ¨™ç±¤" }
}
```

### å…ƒè³‡æ–™çš„å¤šå±¤æ¬¡çµæ§‹

çµåˆæˆ‘å€‘è¨è«–çš„ B + C + D æ–¹æ¡ˆï¼š

```typescript
/**
 * å…ƒè³‡æ–™ç³»çµ±æ¶æ§‹
 */
interface MetadataSystem {
  // 1. éšå±¤çµæ§‹ (B) - åæ˜ ç¨‹å¼ç¢¼çµæ§‹
  hierarchical: {
    function?: {
      name: string;
      metadata: Annotation;
      children: {
        statement?: Map<number, Annotation>;
        block?: Map<string, Annotation>;
      };
    };
  };

  // 2. å¤šç²’åº¦ç´¢å¼• (C) - å¿«é€ŸæŸ¥è©¢
  indices: {
    byFunction: Map<string, Annotation>;
    byStatement: Map<number, Annotation>;
    byBlock: Map<string, Annotation>;
    byType: Map<AnnotationType, Annotation[]>;
  };

  // 3. éŒ¨é»ç³»çµ± (D) - å½ˆæ€§æŒ‡å‘
  anchors: AnchoredAnnotation[];
}

/**
 * éŒ¨é»è¨»è§£
 */
interface AnchoredAnnotation {
  id: string;
  anchor: Anchor;
  type: AnnotationType;
  content: string;
  author?: string;
  timestamp?: Date;
}

/**
 * éŒ¨é»å®šç¾©
 */
type Anchor =
  | { type: "function"; name: string }
  | { type: "statement"; line: number }
  | { type: "block"; id: string }
  | { type: "range"; from: number; to: number }
  | { type: "selection"; start: Position; end: Position };

/**
 * è¨»è§£é¡å‹
 */
type AnnotationType =
  | "design-rationale"    // è¨­è¨ˆç†ç”±
  | "optimization"        // å„ªåŒ–èªªæ˜
  | "tradeoff"           // æ¬Šè¡¡åˆ†æ
  | "todo"               // å¾…è¾¦äº‹é …
  | "warning"            // è­¦å‘Š
  | "algorithm"          // æ¼”ç®—æ³•èªªæ˜
  | "complexity"         // è¤‡é›œåº¦åˆ†æ
  | "example";           // ä½¿ç”¨ç¯„ä¾‹
```

### è·¨å½¢æ…‹åŒæ­¥æ©Ÿåˆ¶

åŸºæ–¼æˆ‘å€‘è¨è«–çš„ C + D æ–¹æ¡ˆï¼š**AI è¼”åŠ©çš„ä½¿ç”¨è€…æ±ºç­–**

#### åŒæ­¥æµç¨‹

```typescript
/**
 * è¨»è§£åŒæ­¥æœå‹™
 */
class AnnotationSyncService {
  /**
   * ç•¶ä½¿ç”¨è€…åœ¨æŸå€‹å½¢æ…‹ä¿®æ”¹è¨»è§£æ™‚
   */
  async onAnnotationChanged(
    form: "sequence" | "structure" | "topology",
    annotation: Annotation,
    context: ChangeContext
  ): Promise<void> {
    // 1. AI åˆ†æè®Šæ›´
    const analysis = await this.aiAnalyze(annotation, context);

    // 2. æç¤ºä½¿ç”¨è€…
    const userDecision = await this.promptUser({
      oldValue: context.oldValue,
      newValue: annotation.content,
      aiSuggestion: analysis.suggestion,
      affectedForms: ["sequence", "structure", "topology"],
      syncOptions: this.generateSyncOptions(analysis)
    });

    // 3. æ ¹æ“šä½¿ç”¨è€…æ±ºå®šåŒæ­¥
    if (userDecision.syncAll) {
      await this.syncToAllForms(annotation);
    } else if (userDecision.selective) {
      await this.syncToForms(annotation, userDecision.selectedForms);
    } else if (userDecision.merge) {
      await this.intelligentMerge(annotation, userDecision.mergeStrategy);
    }

    // 4. æ›´æ–°å…ƒè³‡æ–™
    await this.updateMetadata(annotation);
  }

  /**
   * AI åˆ†æè®Šæ›´æ€§è³ª
   */
  private async aiAnalyze(
    annotation: Annotation,
    context: ChangeContext
  ): Promise<ChangeAnalysis> {
    const oldContent = context.oldValue;
    const newContent = annotation.content;

    // åˆ¤æ–·è®Šæ›´é¡å‹
    const changeType = this.detectChangeType(oldContent, newContent);

    return {
      changeType,  // "supplement" | "replacement" | "refinement"
      confidence: this.calculateConfidence(oldContent, newContent),
      suggestion: this.generateSuggestion(changeType),
      affectedScopes: this.analyzeAffectedScopes(annotation)
    };
  }

  /**
   * è®Šæ›´é¡å‹åµæ¸¬
   */
  private detectChangeType(old: string, new_: string): ChangeType {
    // å¦‚æœæ–°å…§å®¹åŒ…å«èˆŠå…§å®¹ï¼Œå¯èƒ½æ˜¯è£œå……
    if (new_.includes(old)) {
      return "supplement";
    }

    // å¦‚æœæœ‰å…±åŒé—œéµè©ï¼Œå¯èƒ½æ˜¯ç²¾ç…‰
    const oldKeywords = this.extractKeywords(old);
    const newKeywords = this.extractKeywords(new_);
    const overlap = this.calculateOverlap(oldKeywords, newKeywords);

    if (overlap > 0.5) {
      return "refinement";
    }

    // å¦å‰‡æ˜¯æ›¿æ›
    return "replacement";
  }

  /**
   * æç¤ºä½¿ç”¨è€…
   */
  private async promptUser(options: SyncPromptOptions): Promise<SyncDecision> {
    // é¡¯ç¤ºå°è©±æ¡†
    return await vscode.window.showQuickPick([
      {
        label: "å…¨éƒ¨åŒæ­¥",
        description: `å°‡è®Šæ›´åŒæ­¥åˆ° ${options.affectedForms.join(", ")}`,
        value: { syncAll: true }
      },
      {
        label: "é¸æ“‡æ€§åŒæ­¥",
        description: "è®“æˆ‘é¸æ“‡è¦åŒæ­¥åˆ°å“ªäº›å½¢æ…‹",
        value: { selective: true }
      },
      {
        label: "æ™ºèƒ½åˆä½µ",
        description: AI å»ºè­°ï¼š${options.aiSuggestion}`,
        value: { merge: true, mergeStrategy: "ai-guided" }
      },
      {
        label: "ä¸åŒæ­¥",
        description: "åªæ›´æ–°ç•¶å‰å½¢æ…‹",
        value: { noSync: true }
      }
    ]);
  }
}
```

### è¨»è§£çš„æŒä¹…åŒ–

#### æª”æ¡ˆçµæ§‹

```
template/
â”œâ”€â”€ code.py                  # Sequence form
â”œâ”€â”€ blocks.xml              # Structure form
â”œâ”€â”€ graph.json              # Topology form
â””â”€â”€ _metadata/              # å…ƒè³‡æ–™ç›®éŒ„
    â”œâ”€â”€ annotations.json    # è¨»è§£è³‡æ–™
    â”œâ”€â”€ design.md          # è¨­è¨ˆæ–‡æª”
    â””â”€â”€ history.json       # è®Šæ›´æ­·å²
```

#### annotations.json æ ¼å¼

```json
{
  "version": "3.0",
  "templateId": "algorithm-binary-search-c",

  "hierarchical": {
    "function": {
      "name": "binarySearch",
      "type": "design-rationale",
      "content": "ä½¿ç”¨äºŒåˆ†æœå°‹å› ç‚º...",
      "children": {
        "statement-5": {
          "type": "optimization",
          "content": "é¿å…æ•´æ•¸æº¢ä½"
        }
      }
    }
  },

  "indices": {
    "byType": {
      "design-rationale": ["func-001"],
      "optimization": ["stmt-005"]
    }
  },

  "anchors": [
    {
      "id": "anno-001",
      "anchor": { "type": "statement", "line": 5 },
      "type": "optimization",
      "content": "ä½¿ç”¨ left + (right-left)/2 é¿å…æº¢ä½",
      "author": "user@example.com",
      "timestamp": "2025-10-20T10:30:00Z"
    }
  ],

  "syncStatus": {
    "lastSync": "2025-10-20T10:30:00Z",
    "conflicts": []
  }
}
```

### è¡çªè§£æ±º

ç•¶ä¸åŒå½¢æ…‹çš„è¨»è§£ç™¼ç”Ÿè¡çªæ™‚ï¼š

```typescript
/**
 * è¡çªè§£æ±ºå™¨
 */
class ConflictResolver {
  /**
   * åµæ¸¬è¡çª
   */
  async detectConflicts(
    template: MultiFormKnowledgeUnit
  ): Promise<Conflict[]> {
    const conflicts: Conflict[] = [];

    // æ¯”è¼ƒ Sequence å’Œ Structure çš„è¨»è§£
    const seqAnnotations = this.extractAnnotations(template.forms.sequence);
    const strAnnotations = this.extractAnnotations(template.forms.structure);

    for (const [location, seqAnno] of seqAnnotations) {
      const strAnno = strAnnotations.get(location);

      if (strAnno && seqAnno.content !== strAnno.content) {
        conflicts.push({
          location,
          forms: ["sequence", "structure"],
          values: [seqAnno.content, strAnno.content],
          timestamp: [seqAnno.timestamp, strAnno.timestamp]
        });
      }
    }

    return conflicts;
  }

  /**
   * è§£æ±ºè¡çª
   */
  async resolveConflict(conflict: Conflict): Promise<Resolution> {
    // 1. æ™‚é–“æˆ³å„ªå…ˆç­–ç•¥
    if (this.isTimestampClear(conflict)) {
      return { strategy: "use-latest", value: this.getLatest(conflict) };
    }

    // 2. AI è¼”åŠ©åˆä½µ
    const merged = await this.aiMerge(conflict.values);

    // 3. è®“ä½¿ç”¨è€…æ±ºå®š
    return await this.askUser({
      conflict,
      aiSuggestion: merged,
      options: ["use-sequence", "use-structure", "use-ai-merged", "manual-edit"]
    });
  }
}
```

### ç‰ˆæœ¬æ§åˆ¶

å…ƒè³‡æ–™ä¹Ÿéœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼š

```typescript
/**
 * å…ƒè³‡æ–™ç‰ˆæœ¬æ§åˆ¶
 */
interface MetadataVersion {
  version: string;           // "1.0.0"
  timestamp: Date;
  author: string;
  changes: Change[];

  snapshot: {
    annotations: Annotation[];
    metadata: TemplateMetadata;
  };
}

/**
 * è®Šæ›´è¨˜éŒ„
 */
interface Change {
  type: "add" | "modify" | "delete";
  target: "annotation" | "metadata";
  path: string;              // JSON path
  before?: any;
  after?: any;
  reason?: string;
}
```

### æŸ¥è©¢èˆ‡æª¢ç´¢

```typescript
/**
 * å…ƒè³‡æ–™æŸ¥è©¢æœå‹™
 */
class MetadataQueryService {
  /**
   * æŸ¥è©¢æ‰€æœ‰è¨­è¨ˆç†ç”±
   */
  async findDesignRationales(
    templateId: string
  ): Promise<Annotation[]> {
    const metadata = await this.loadMetadata(templateId);
    return metadata.indices.byType.get("design-rationale") || [];
  }

  /**
   * æŸ¥è©¢ç‰¹å®šè¡Œçš„è¨»è§£
   */
  async findAnnotationAtLine(
    templateId: string,
    line: number
  ): Promise<Annotation | null> {
    const metadata = await this.loadMetadata(templateId);
    return metadata.indices.byStatement.get(line) || null;
  }

  /**
   * å…¨æ–‡æœå°‹è¨»è§£
   */
  async searchAnnotations(
    query: string,
    filters?: AnnotationFilter
  ): Promise<SearchResult[]> {
    // å¯¦ä½œå…¨æ–‡æœå°‹
  }
}
```

### UI æ•´åˆ

#### 1. Sequence Form ä¸­çš„è¨»è§£

```typescript
// VS Code è£é£¾å™¨é¡¯ç¤ºè¨»è§£
const decorationType = vscode.window.createTextEditorDecorationType({
  after: {
    contentText: "ğŸ’¡ è¨­è¨ˆç†ç”±",
    color: "#888",
    margin: "0 0 0 1em"
  }
});

// Hover é¡¯ç¤ºå®Œæ•´è¨»è§£
vscode.languages.registerHoverProvider("python", {
  provideHover(document, position) {
    const annotation = getAnnotationAtPosition(position);
    if (annotation) {
      return new vscode.Hover(annotation.content);
    }
  }
});
```

#### 2. Structure Form ä¸­çš„è¨»è§£

```xml
<!-- Blockly ç©æœ¨çš„ tooltip -->
<block type="for_loop">
  <field name="VAR">i</field>
  <comment>ä½¿ç”¨ for è¿´åœˆéæ­·æ‰€æœ‰å…ƒç´ </comment>
</block>
```

#### 3. Topology Form ä¸­çš„è¨»è§£

```json
{
  "node": {
    "id": "node-001",
    "label": "binarySearch",
    "annotation": {
      "type": "design-rationale",
      "content": "æ ¸å¿ƒæœå°‹é‚è¼¯"
    }
  }
}
```

---

## é ˜åŸŸæ’ä»¶ç³»çµ±

### è¨­è¨ˆå‹•æ©Ÿ

é›–ç„¶å››ç´šç©æœ¨ç³»çµ±æ˜¯**æ™®éè¦å¾‹**ï¼Œä½†ä¸åŒèªè¨€å±¤ç´šæœ‰å…¶**ç‰¹æ®Šæ€§**ï¼š

- **HDL** éœ€è¦æ™‚åºåˆ†æã€è³‡æºä¼°ç®—
- **Assembly** éœ€è¦æš«å­˜å™¨åˆ†é…ã€æŒ‡ä»¤é€±æœŸ
- **Python** éœ€è¦æ•ˆèƒ½åˆ†æã€ä¾è³´ç®¡ç†

**é ˜åŸŸæ’ä»¶ç³»çµ±**å…è¨±åœ¨çµ±ä¸€æ ¸å¿ƒä¸Šæ“´å±•é ˜åŸŸç‰¹å®šåŠŸèƒ½ã€‚

### æ ¸å¿ƒ + æ’ä»¶æ¶æ§‹

```typescript
/**
 * æ ¸å¿ƒæ¨¡æ¿ä»‹é¢ï¼ˆæ‰€æœ‰èªè¨€å…±é€šï¼‰
 */
interface CoreTemplate {
  // åŸºæœ¬è³‡è¨Š
  id: string;
  name: string;
  languageLevel: LanguageLevel;
  granularity: Granularity;

  // ä¸‰ç¨®å½¢æ…‹
  forms: {
    sequence: SequenceForm;
    structure: StructureForm;
    topology: TopologyForm;
  };

  // å…ƒè³‡æ–™
  metadata: CoreMetadata;
  annotations: AnnotationSystem;

  // æ’ä»¶æ›è¼‰é»
  plugins?: PluginRegistry;
}

/**
 * æ’ä»¶è¨»å†Šè¡¨
 */
interface PluginRegistry {
  [pluginName: string]: PluginInstance;
}

/**
 * æ’ä»¶ä»‹é¢
 */
interface TemplatePlugin {
  name: string;
  version: string;
  supportedLanguages: string[];

  // ç”Ÿå‘½é€±æœŸé‰¤å­
  onLoad?(template: CoreTemplate): void;
  onSave?(template: CoreTemplate): void;
  onTransform?(from: FormType, to: FormType): void;

  // æä¾›é¡å¤–è³‡æ–™
  provideMetadata?(): any;
  provideValidation?(): ValidationRule[];
  provideTools?(): Tool[];
}
```

### HDL æ’ä»¶ç¯„ä¾‹

```typescript
/**
 * HDL (Hardware Description Language) æ’ä»¶
 */
class HDLPlugin implements TemplatePlugin {
  name = "hdl-plugin";
  version = "1.0.0";
  supportedLanguages = ["verilog", "vhdl", "systemverilog"];

  /**
   * æä¾› HDL ç‰¹å®šå…ƒè³‡æ–™
   */
  provideMetadata() {
    return {
      // æ™‚åºè³‡è¨Š
      timing: {
        clockDomains: string[];
        criticalPaths: Path[];
        setupTime: number;
        holdTime: number;
      };

      // ç¶œåˆæ€§ (Synthesizability)
      synthesis: {
        synthesizable: boolean;
        targetDevice: string;          // "FPGA" | "ASIC"
        warnings: Warning[];
      };

      // è³‡æºä¼°ç®—
      resources: {
        estimatedLUTs: number;
        estimatedFFs: number;          // Flip-Flops
        estimatedBRAM: number;         // Block RAM
        estimatedDSP: number;          // DSP blocks
      };

      // é©—è­‰è³‡è¨Š
      verification: {
        testbenchAvailable: boolean;
        coveragePercent: number;
        simulationTime: number;
      };
    };
  }

  /**
   * æä¾› HDL ç‰¹å®šé©—è­‰è¦å‰‡
   */
  provideValidation(): ValidationRule[] {
    return [
      {
        name: "clock-domain-crossing",
        check: (template) => this.checkCDC(template),
        severity: "error"
      },
      {
        name: "combinational-loop",
        check: (template) => this.checkCombLoop(template),
        severity: "error"
      },
      {
        name: "latch-inference",
        check: (template) => this.checkLatch(template),
        severity: "warning"
      }
    ];
  }

  /**
   * æä¾› HDL ç‰¹å®šå·¥å…·
   */
  provideTools(): Tool[] {
    return [
      {
        name: "Timing Analysis",
        icon: "clock",
        execute: (template) => this.runTimingAnalysis(template)
      },
      {
        name: "Resource Estimation",
        icon: "chip",
        execute: (template) => this.estimateResources(template)
      },
      {
        name: "Waveform Viewer",
        icon: "waveform",
        execute: (template) => this.openWaveform(template)
      }
    ];
  }

  /**
   * æ™‚åºåˆ†æ
   */
  private async runTimingAnalysis(template: CoreTemplate): Promise<TimingReport> {
    const verilogCode = template.forms.sequence.content;

    // å‘¼å« Vivado æˆ– Quartus é€²è¡Œæ™‚åºåˆ†æ
    const report = await this.synthesisTools.analyzeTiming(verilogCode);

    return {
      maxFrequency: report.fmax,
      criticalPath: report.criticalPath,
      setupViolations: report.setupViolations,
      holdViolations: report.holdViolations
    };
  }

  /**
   * è³‡æºä¼°ç®—
   */
  private async estimateResources(template: CoreTemplate): Promise<ResourceEstimate> {
    const blocks = template.forms.structure.blocks;

    let luts = 0, ffs = 0, bram = 0, dsp = 0;

    for (const block of blocks) {
      switch (block.type) {
        case "register":
          ffs += block.width || 1;
          break;
        case "adder":
          luts += (block.width || 1) * 2;
          break;
        case "multiplier":
          dsp += 1;
          break;
        case "fifo":
          bram += Math.ceil(block.depth / 512);
          break;
      }
    }

    return { luts, ffs, bram, dsp };
  }
}
```

### Python æ’ä»¶ç¯„ä¾‹

```typescript
/**
 * Python èªè¨€æ’ä»¶
 */
class PythonPlugin implements TemplatePlugin {
  name = "python-plugin";
  version = "1.0.0";
  supportedLanguages = ["python"];

  provideMetadata() {
    return {
      // æ•ˆèƒ½åˆ†æ
      performance: {
        timeComplexity: string;        // "O(n log n)"
        spaceComplexity: string;       // "O(n)"
        benchmarkResults?: BenchmarkData;
      };

      // ä¾è³´ç®¡ç†
      dependencies: {
        stdlib: string[];              // ["os", "sys"]
        external: Package[];           // [{name: "numpy", version: "^1.20"}]
        optional: Package[];
      };

      // å‹åˆ¥æç¤º
      typing: {
        fullyTyped: boolean;
        mypyScore: number;             // 0-100
        typeHints: TypeHint[];
      };

      // ç¨‹å¼ç¢¼å“è³ª
      quality: {
        pylintScore: number;           // 0-10
        complexityScore: number;       // Cyclomatic complexity
        maintainabilityIndex: number;  // 0-100
      };
    };
  }

  provideTools(): Tool[] {
    return [
      {
        name: "Run Profiler",
        icon: "speedometer",
        execute: (template) => this.profileCode(template)
      },
      {
        name: "Type Check",
        icon: "check-type",
        execute: (template) => this.runMypy(template)
      },
      {
        name: "Lint Code",
        icon: "lint",
        execute: (template) => this.runPylint(template)
      }
    ];
  }
}
```

### Assembly æ’ä»¶ç¯„ä¾‹

```typescript
/**
 * Assembly èªè¨€æ’ä»¶
 */
class AssemblyPlugin implements TemplatePlugin {
  name = "assembly-plugin";
  version = "1.0.0";
  supportedLanguages = ["x86-asm", "arm-asm", "riscv-asm"];

  provideMetadata() {
    return {
      // æ¶æ§‹è³‡è¨Š
      architecture: {
        isa: string;                   // "x86-64", "ARMv8", "RISC-V"
        extensions: string[];          // ["SSE", "AVX", "NEON"]
      };

      // æš«å­˜å™¨ä½¿ç”¨
      registers: {
        used: string[];                // ["rax", "rbx", "rcx"]
        spilled: number;               // æº¢å‡ºåˆ°è¨˜æ†¶é«”çš„æš«å­˜å™¨æ•¸
        callConvention: string;        // "System V AMD64 ABI"
      };

      // æ•ˆèƒ½è³‡è¨Š
      performance: {
        instructionCount: number;
        cycleEstimate: number;
        cacheEfficiency: number;       // 0-1
        branchPrediction: {
          predictable: boolean;
          mispredictRate: number;
        };
      };

      // å„ªåŒ–è³‡è¨Š
      optimization: {
        level: string;                 // "-O0", "-O2", "-O3"
        techniques: string[];          // ["loop-unrolling", "SIMD"]
        potentialImprovements: Suggestion[];
      };
    };
  }

  provideTools(): Tool[] {
    return [
      {
        name: "Disassemble",
        execute: (template) => this.disassemble(template)
      },
      {
        name: "Analyze Performance",
        execute: (template) => this.analyzePerformance(template)
      },
      {
        name: "Suggest Optimizations",
        execute: (template) => this.suggestOptimizations(template)
      }
    ];
  }
}
```

### æ’ä»¶è¼‰å…¥æ©Ÿåˆ¶

```typescript
/**
 * æ’ä»¶ç®¡ç†å™¨
 */
class PluginManager {
  private plugins: Map<string, TemplatePlugin> = new Map();

  /**
   * è¨»å†Šæ’ä»¶
   */
  register(plugin: TemplatePlugin): void {
    this.plugins.set(plugin.name, plugin);
  }

  /**
   * æ ¹æ“šèªè¨€è¼‰å…¥åˆé©çš„æ’ä»¶
   */
  loadPluginsForTemplate(template: CoreTemplate): PluginInstance[] {
    const language = template.languageLevel.specific;
    const loaded: PluginInstance[] = [];

    for (const [name, plugin] of this.plugins) {
      if (plugin.supportedLanguages.includes(language)) {
        const instance = this.instantiatePlugin(plugin, template);
        loaded.push(instance);
      }
    }

    return loaded;
  }

  /**
   * å¯¦ä¾‹åŒ–æ’ä»¶
   */
  private instantiatePlugin(
    plugin: TemplatePlugin,
    template: CoreTemplate
  ): PluginInstance {
    const instance = {
      plugin,
      metadata: plugin.provideMetadata?.(),
      validation: plugin.provideValidation?.() || [],
      tools: plugin.provideTools?.() || []
    };

    // å‘¼å«ç”Ÿå‘½é€±æœŸé‰¤å­
    plugin.onLoad?.(template);

    return instance;
  }
}
```

### ä½¿ç”¨ç¯„ä¾‹

```typescript
// å»ºç«‹ä¸€å€‹ Verilog æ¨¡æ¿
const verilogTemplate: CoreTemplate = {
  id: "verilog-counter",
  languageLevel: { type: "hdl", specific: "verilog" },
  granularity: "L1",

  forms: { /* ... */ },
  metadata: { /* ... */ },
  annotations: { /* ... */ },

  // è¼‰å…¥ HDL æ’ä»¶
  plugins: {
    "hdl-plugin": hdlPlugin
  }
};

// ä½¿ç”¨æ’ä»¶æä¾›çš„åŠŸèƒ½
const hdlMetadata = verilogTemplate.plugins["hdl-plugin"].metadata;
console.log(`ä¼°è¨ˆä½¿ç”¨ ${hdlMetadata.resources.estimatedLUTs} LUTs`);

// åŸ·è¡Œæ™‚åºåˆ†æ
const timingReport = await hdlPlugin.provideTools()
  .find(t => t.name === "Timing Analysis")
  .execute(verilogTemplate);
```

### æ’ä»¶ç”Ÿæ…‹ç³»çµ±

```
æ ¸å¿ƒç³»çµ±
â”œâ”€â”€ Core Template Interface
â”œâ”€â”€ Plugin Manager
â””â”€â”€ Plugin Registry

å®˜æ–¹æ’ä»¶
â”œâ”€â”€ HDL Plugin (Verilog, VHDL)
â”œâ”€â”€ Python Plugin
â”œâ”€â”€ JavaScript Plugin
â”œâ”€â”€ Assembly Plugin (x86, ARM, RISC-V)
â””â”€â”€ C/C++ Plugin

ç¤¾ç¾¤æ’ä»¶
â”œâ”€â”€ Rust Plugin
â”œâ”€â”€ Go Plugin
â”œâ”€â”€ Quantum Circuit Plugin
â””â”€â”€ ... (å¯ç„¡é™æ“´å±•)
```

---

## è‡ªç„¶èªè¨€æ¨¡æ¿ç³»çµ±

### è¨­è¨ˆå‹•æ©Ÿ

**æ ¸å¿ƒæ´å¯Ÿ**ï¼šåœ¨ AI æ™‚ä»£ï¼Œè¦æ ¼ï¼ˆSpecï¼‰çš„åœ°ä½å°‡å¦‚åŒä»Šæ—¥çš„ç¨‹å¼ç¢¼ã€‚

å°±åƒæˆ‘å€‘ç¾åœ¨ç·¨è¼¯ `.py` æª”æ¡ˆå¯«ç¨‹å¼ï¼Œæœªä¾†æˆ‘å€‘å°‡ç·¨è¼¯ `.md` æª”æ¡ˆå¯«è¦æ ¼ï¼Œç„¶å¾Œç”± Coding Agentã€Œç·¨è­¯ã€æˆç¨‹å¼ç¢¼ã€‚

**TextBricks çš„è§’è‰²**ï¼šæä¾›**è¦æ ¼æ¨¡æ¿**ï¼Œå°±åƒç¾åœ¨æä¾›ç¨‹å¼ç¢¼æ¨¡æ¿ä¸€æ¨£ã€‚

### è‡ªç„¶èªè¨€çš„å››ç´šç©æœ¨

æ ¹æ“šæˆ‘å€‘è¨è«–çš„çµæœï¼Œè‡ªç„¶èªè¨€ä¹Ÿæœ‰å››å€‹ç²’åº¦å±¤ç´šï¼š

| å±¤ç´š | å®šç¾© | ç¯„ä¾‹ |
|------|------|------|
| **L0** | å®Œæ•´æ–‡ä»¶ | æ•´ä»½ API è¦æ ¼æ–‡æª” |
| **L1** | ç« ç¯€/Feature Spec | å–®ä¸€åŠŸèƒ½è¦æ ¼ |
| **L2** | æ®µè½/Requirement | "ä½¿ç”¨è€…ç™»å…¥å¾Œï¼Œç³»çµ±ç™¼æ”¾ JWT token" |
| **L3** | æ¦‚å¿µç‰‡æ®µ | "ä½¿ç”¨è€…", "JWT token", "éæœŸæ™‚é–“24å°æ™‚" |

### L3 æ¦‚å¿µç‰‡æ®µçš„å¯çµ„åˆæ€§

åŸºæ–¼æˆ‘å€‘è¨è«–çš„ C + D æ–¹æ¡ˆï¼š**æ¦‚å¿µç‰‡æ®µ** + **åˆ†å±¤æ¼”é€²**

#### Phase 1: æ–‡å­—è®Šæ•¸ï¼ˆv0.4ï¼‰

```typescript
// ç°¡å–®çš„æ–‡å­—æ›¿æ›
{
  template: "## {{endpoint_name}}\n**Method**: {{method}}",
  variables: [
    { name: "endpoint_name", type: "text" },
    { name: "method", type: "text" }
  ]
}
```

#### Phase 2: é¡å‹åŒ–æ¦‚å¿µï¼ˆv0.5ï¼‰

```typescript
// æœ‰èªç¾©çš„æ¦‚å¿µ
{
  template: "## {{endpoint_name}}\n**Method**: {{method}}",
  concepts: [
    {
      name: "endpoint_name",
      type: "concept:api-endpoint",
      validation: (value) => /^[a-z-]+$/.test(value)
    },
    {
      name: "method",
      type: "concept:http-method",
      options: ["GET", "POST", "PUT", "DELETE", "PATCH"],
      default: "GET"
    }
  ]
}
```

#### Phase 3: çŸ¥è­˜åœ–è­œï¼ˆv1.0ï¼‰

```typescript
// è±å¯Œçš„æ¦‚å¿µç¶²çµ¡
{
  concepts: [
    {
      id: "auth_mechanism",
      type: "concept:authentication",
      knowledgeBase: {
        "JWT": {
          description: "JSON Web Token - ç„¡ç‹€æ…‹èªè­‰",
          relatedConcepts: ["token-expiry", "refresh-token", "secret-key"],
          implications: [
            "éœ€è¦é…ç½® SECRET_KEY",
            "å»ºè­°è¨­å®š token éæœŸæ™‚é–“",
            "è€ƒæ…®å¯¦ä½œ refresh token æ©Ÿåˆ¶"
          ],
          tradeoffs: {
            pros: ["ç„¡ç‹€æ…‹", "å¯æ“´å±•", "è·¨åŸŸæ”¯æ´"],
            cons: ["ç„¡æ³•å³æ™‚æ’¤éŠ·", "payload å¤§å°é™åˆ¶"]
          },
          codeTemplates: [
            "fastapi-jwt-auth",
            "express-jwt-middleware"
          ]
        },
        "OAuth2": {
          description: "é–‹æ”¾æˆæ¬Šå”è­°",
          relatedConcepts: ["authorization-server", "access-token", "scope"],
          implications: [
            "éœ€è¦æ•´åˆç¬¬ä¸‰æ–¹ OAuth Provider",
            "éœ€è¦è™•ç†å›èª¿ URL",
            "éœ€è¦ç®¡ç† client_id å’Œ client_secret"
          ],
          tradeoffs: {
            pros: ["æ¥­ç•Œæ¨™æº–", "å§”è¨—èªè­‰", "ç²¾ç´°æ¬Šé™æ§åˆ¶"],
            cons: ["å¯¦ä½œè¤‡é›œ", "ä¾è³´ç¬¬ä¸‰æ–¹æœå‹™"]
          },
          codeTemplates: [
            "fastapi-oauth2-flow",
            "nextauth-oauth-provider"
          ]
        }
      }
    }
  ]
}
```

### Spec Template ç¯„ä¾‹åº«

#### 1. REST API Endpoint Spec

```typescript
const restApiEndpointSpec: SpecTemplate = {
  id: "spec-rest-api-endpoint",
  name: "REST API Endpoint Specification",
  languageLevel: { type: "natural", specific: "english" },
  granularity: "L1",

  forms: {
    sequence: {
      content: `## {{endpoint_name}}

### Overview
{{description}}

### Endpoint Details
- **Method**: {{method}}
- **Path**: \`{{path}}\`
- **Authentication**: {{auth_required}}

### Request

{{#if has_request_body}}
**Body Parameters**:
{{#each request_params}}
- \`{{name}}\`: {{type}} - {{description}}
{{/each}}
{{/if}}

{{#if has_query_params}}
**Query Parameters**:
{{#each query_params}}
- \`{{name}}\`: {{type}} - {{description}}
{{/each}}
{{/if}}

### Response

**Success Response ({{success_code}})**:
\`\`\`json
{{success_example}}
\`\`\`

**Error Responses**:
{{#each error_responses}}
- **{{code}}**: {{description}}
{{/each}}

### Business Logic
{{business_logic}}

### Implementation Notes
{{implementation_notes}}
`,
      language: "markdown",
      format: ".md"
    },

    structure: {
      schema: {
        type: "api-endpoint",
        fields: [
          { name: "endpoint_name", required: true },
          { name: "method", required: true, enum: ["GET", "POST", "PUT", "DELETE"] },
          { name: "path", required: true },
          { name: "auth_required", required: true, enum: ["Required", "Optional", "None"] },
          { name: "request_params", type: "array" },
          { name: "response", type: "object" }
        ]
      }
    },

    topology: {
      // API ç«¯é»ä¹‹é–“çš„é—œä¿‚åœ–
      nodes: [
        { id: "endpoint", type: "api-endpoint", label: "{{endpoint_name}}" },
        { id: "auth", type: "dependency", label: "{{auth_mechanism}}" },
        { id: "database", type: "dependency", label: "Database" }
      ],
      edges: [
        { from: "endpoint", to: "auth", label: "requires" },
        { from: "endpoint", to: "database", label: "queries" }
      ]
    }
  },

  metadata: {
    designRationale: "RESTful API è¨­è¨ˆçš„æ¨™æº–è¦æ ¼æ ¼å¼",
    useCases: ["API é–‹ç™¼", "å‰å¾Œç«¯å”ä½œ", "API æ–‡æª”ç”Ÿæˆ"],
    difficulty: "beginner"
  },

  // èˆ‡ Code Templates çš„é—œè¯
  suggestedCodeTemplates: [
    "fastapi-route-handler",
    "pydantic-request-model",
    "pydantic-response-model"
  ],

  // è®Šæ•¸å®šç¾©ï¼ˆPhase 2: é¡å‹åŒ–æ¦‚å¿µï¼‰
  concepts: [
    {
      name: "endpoint_name",
      type: "concept:api-endpoint-name",
      description: "API ç«¯é»åç¨±ï¼ˆå¦‚ï¼šä½¿ç”¨è€…ç™»å…¥ï¼‰",
      validation: { pattern: "^[\\u4e00-\\u9fa5a-zA-Z ]+$" }
    },
    {
      name: "method",
      type: "concept:http-method",
      description: "HTTP æ–¹æ³•",
      options: ["GET", "POST", "PUT", "DELETE", "PATCH"],
      default: "GET"
    },
    {
      name: "auth_required",
      type: "concept:auth-requirement",
      options: ["Required", "Optional", "None"],
      default: "Required",
      implications: {
        "Required": "éœ€è¦å¯¦ä½œèªè­‰ä¸­é–“ä»¶",
        "Optional": "éœ€è¦è™•ç†æœ‰/ç„¡èªè­‰å…©ç¨®æƒ…æ³",
        "None": "å…¬é–‹ç«¯é»ï¼Œæ³¨æ„å®‰å…¨é¢¨éšª"
      }
    }
  ]
};
```

#### 2. Algorithm Description Spec

```typescript
const algorithmSpec: SpecTemplate = {
  id: "spec-algorithm-description",
  name: "Algorithm Specification",
  languageLevel: { type: "natural", specific: "english" },
  granularity: "L1",

  forms: {
    sequence: {
      content: `## Algorithm: {{algorithm_name}}

### Purpose
{{purpose}}

### Input
{{input_description}}

### Output
{{output_description}}

### Algorithm Steps
{{#each steps}}
{{add @index 1}}. {{this}}
{{/each}}

### Time Complexity
- **Best Case**: {{time_best}}
- **Average Case**: {{time_avg}}
- **Worst Case**: {{time_worst}}

### Space Complexity
{{space_complexity}}

### Example
**Input**: {{example_input}}
**Output**: {{example_output}}
**Explanation**: {{example_explanation}}

### Implementation Constraints
{{constraints}}

### Edge Cases
{{#each edge_cases}}
- {{this}}
{{/each}}
`,
      language: "markdown",
      format: ".md"
    },

    structure: {
      schema: {
        type: "algorithm",
        fields: [
          { name: "algorithm_name", required: true },
          { name: "purpose", required: true },
          { name: "steps", type: "array", required: true },
          { name: "complexity", type: "object" }
        ]
      }
    },

    topology: {
      // æ¼”ç®—æ³•æµç¨‹åœ–
      nodes: [
        { id: "input", type: "input", label: "Input: {{input_description}}" },
        { id: "process", type: "process", label: "{{algorithm_name}}" },
        { id: "output", type: "output", label: "Output: {{output_description}}" }
      ]
    }
  },

  suggestedCodeTemplates: [
    "algorithm-function-skeleton",
    "time-complexity-test",
    "edge-case-tests"
  ]
};
```

#### 3. Data Model Spec

```typescript
const dataModelSpec: SpecTemplate = {
  id: "spec-data-model",
  name: "Data Model Specification",
  languageLevel: { type: "natural", specific: "english" },
  granularity: "L1",

  forms: {
    sequence: {
      content: `## Data Model: {{model_name}}

### Purpose
{{purpose}}

### Fields

| Field Name | Type | Required | Default | Description |
|------------|------|----------|---------|-------------|
{{#each fields}}
| {{name}} | {{type}} | {{required}} | {{default}} | {{description}} |
{{/each}}

### Relationships
{{#each relationships}}
- **{{type}}** with {{target}}: {{description}}
{{/each}}

### Constraints
{{#each constraints}}
- {{this}}
{{/each}}

### Indexes
{{#each indexes}}
- {{this}}
{{/each}}

### Example Data
\`\`\`json
{{example_json}}
\`\`\`

### Migration Notes
{{migration_notes}}
`,
      language: "markdown",
      format: ".md"
    },

    structure: {
      schema: {
        type: "data-model",
        fields: [
          { name: "model_name", required: true },
          { name: "fields", type: "array", required: true },
          { name: "relationships", type: "array" }
        ]
      }
    },

    topology: {
      // è³‡æ–™æ¨¡å‹é—œä¿‚åœ– (ERD)
      nodes: [
        { id: "model", type: "entity", label: "{{model_name}}" },
        // é—œè¯çš„å…¶ä»–æ¨¡å‹æœƒå‹•æ…‹ç”Ÿæˆ
      ],
      edges: [
        // é—œä¿‚æœƒæ ¹æ“š relationships å‹•æ…‹ç”Ÿæˆ
      ]
    }
  },

  suggestedCodeTemplates: [
    "sqlalchemy-model",
    "pydantic-schema",
    "database-migration",
    "prisma-schema"
  ]
};
```

### èˆ‡ SpecKit çš„æ•´åˆ

#### SpecKit å·¥ä½œæµç¨‹

```
1. /speckit.constitution    â†’ å°ˆæ¡ˆæ²»ç†åŸå‰‡
2. /speckit.specify         â†’ åŠŸèƒ½è¦æ ¼
3. /speckit.plan           â†’ æŠ€è¡“è¨ˆç•«
4. /speckit.tasks          â†’ ä»»å‹™åˆ†è§£
5. implement               â†’ Coding Agent å¯¦ä½œ
```

#### TextBricks åœ¨ SpecKit ä¸­çš„è§’è‰²

```typescript
/**
 * TextBricks + SpecKit æ•´åˆ
 */
class SpecKitIntegration {
  /**
   * åœ¨ /specify éšæ®µæä¾›æ¨¡æ¿å»ºè­°
   */
  async suggestSpecTemplates(context: SpecContext): Promise<SpecTemplate[]> {
    const userIntent = await this.analyzeUserIntent(context);

    // æ ¹æ“šæ„åœ–æ¨è–¦æ¨¡æ¿
    if (userIntent.includes("API")) {
      return [
        this.getTemplate("spec-rest-api-endpoint"),
        this.getTemplate("spec-graphql-schema"),
        this.getTemplate("spec-websocket-event")
      ];
    }

    if (userIntent.includes("algorithm")) {
      return [
        this.getTemplate("spec-algorithm-description"),
        this.getTemplate("spec-data-structure")
      ];
    }

    if (userIntent.includes("database") || userIntent.includes("model")) {
      return [
        this.getTemplate("spec-data-model"),
        this.getTemplate("spec-database-schema")
      ];
    }

    return [];
  }

  /**
   * å¾ spec.md æå–æ¦‚å¿µï¼Œå»ºè­°ç›¸é—œçš„ Code Templates
   */
  async suggestCodeTemplates(specPath: string): Promise<CodeTemplate[]> {
    const spec = await this.loadSpec(specPath);
    const concepts = await this.extractConcepts(spec);

    const suggestions: CodeTemplate[] = [];

    for (const concept of concepts) {
      // å¦‚æœ spec æåˆ° "JWT authentication"
      if (concept.type === "authentication" && concept.value === "JWT") {
        suggestions.push(
          this.getCodeTemplate("fastapi-jwt-auth"),
          this.getCodeTemplate("jwt-middleware")
        );
      }

      // å¦‚æœ spec æåˆ°ç‰¹å®šçš„è³‡æ–™æ¨¡å‹
      if (concept.type === "data-model") {
        suggestions.push(
          this.getCodeTemplate("sqlalchemy-model"),
          this.getCodeTemplate("pydantic-schema")
        );
      }
    }

    return suggestions;
  }

  /**
   * å°‡ Spec Template æ’å…¥åˆ° .speckit/specs/xxx/spec.md
   */
  async insertSpecTemplate(
    templateId: string,
    targetFile: string
  ): Promise<void> {
    const template = await this.getTemplate(templateId);

    // 1. æç¤ºä½¿ç”¨è€…å¡«å¯«è®Šæ•¸/æ¦‚å¿µ
    const values = await this.promptUserForConcepts(template.concepts);

    // 2. æ¸²æŸ“æ¨¡æ¿
    const rendered = await this.renderTemplate(template.forms.sequence.content, values);

    // 3. æ’å…¥åˆ° spec.md
    const currentContent = await fs.readFile(targetFile, "utf-8");
    const insertPosition = this.findInsertPosition(currentContent);
    const newContent = this.insertAtPosition(currentContent, rendered, insertPosition);

    await fs.writeFile(targetFile, newContent);

    // 4. å¦‚æœæœ‰å»ºè­°çš„ Code Templatesï¼Œåœ¨ tasks.md ä¸­æ¨™è¨»
    if (template.suggestedCodeTemplates) {
      await this.annotateTasksWithCodeTemplates(
        targetFile.replace("spec.md", "tasks.md"),
        template.suggestedCodeTemplates
      );
    }
  }
}
```

### Spec Template Panel (UI)

```typescript
/**
 * Spec Template Panel - VS Code WebView
 */
class SpecTemplatePanelProvider implements vscode.WebviewViewProvider {
  resolveWebviewView(webviewView: vscode.WebviewView) {
    webviewView.webview.html = this.getHtmlContent();

    // è™•ç†ä½¿ç”¨è€…é¸æ“‡æ¨¡æ¿
    webviewView.webview.onDidReceiveMessage(async (message) => {
      if (message.command === "insertTemplate") {
        const template = await this.getTemplate(message.templateId);
        await this.insertTemplate(template);
      }
    });
  }

  private getHtmlContent(): string {
    return `
      <!DOCTYPE html>
      <html>
      <head>
        <title>Spec Templates</title>
      </head>
      <body>
        <h2>è‡ªç„¶èªè¨€æ¨¡æ¿</h2>

        <div class="category">
          <h3>API è¦æ ¼</h3>
          <div class="template-card" data-id="spec-rest-api-endpoint">
            <h4>REST API Endpoint</h4>
            <p>å®Œæ•´çš„ API ç«¯é»è¦æ ¼</p>
          </div>
          <div class="template-card" data-id="spec-graphql-schema">
            <h4>GraphQL Schema</h4>
            <p>GraphQL æŸ¥è©¢/è®Šæ›´å®šç¾©</p>
          </div>
        </div>

        <div class="category">
          <h3>æ¼”ç®—æ³•è¦æ ¼</h3>
          <div class="template-card" data-id="spec-algorithm-description">
            <h4>Algorithm Description</h4>
            <p>æ¼”ç®—æ³•éœ€æ±‚èˆ‡è¤‡é›œåº¦åˆ†æ</p>
          </div>
        </div>

        <div class="category">
          <h3>è³‡æ–™æ¨¡å‹è¦æ ¼</h3>
          <div class="template-card" data-id="spec-data-model">
            <h4>Data Model</h4>
            <p>è³‡æ–™åº«æ¨¡å‹å®šç¾©</p>
          </div>
        </div>
      </body>
      </html>
    `;
  }
}
```

### å®Œæ•´çš„é–‹ç™¼æµç¨‹ï¼ˆSpec-Drivenï¼‰

```
1. ä½¿ç”¨è€…å•Ÿå‹•å°ˆæ¡ˆ
   â†“
2. åŸ·è¡Œ /speckit.constitution
   - TextBricks æä¾› "Constitution Template"
   â†“
3. åŸ·è¡Œ /speckit.specify
   - TextBricks æä¾› "API Endpoint Spec Template"
   - ä½¿ç”¨è€…å¡«å¯«ï¼š
     * endpoint_name: "ä½¿ç”¨è€…ç™»å…¥"
     * method: "POST"
     * auth_required: "None"ï¼ˆå› ç‚ºæ˜¯ç™»å…¥ç«¯é»ï¼‰
   - ç”Ÿæˆ spec.md
   â†“
4. Coding Agent åŸ·è¡Œ /speckit.plan
   - è®€å– spec.md
   - ç”Ÿæˆ plan.md
   â†“
5. Coding Agent åŸ·è¡Œ /speckit.tasks
   - ç”Ÿæˆ tasks.md
   - TextBricks è‡ªå‹•æ¨™è¨»å»ºè­°çš„ Code Templates:
     * Task 1: "å¯¦ä½œ POST /auth/login"
       å»ºè­°æ¨¡æ¿: [fastapi-route-handler, pydantic-request-model]
   â†“
6. Coding Agent implement
   - è®€å– tasks.md
   - çœ‹åˆ° TextBricks çš„å»ºè­°
   - é¸æ“‡ä½¿ç”¨ fastapi-route-handler æ¨¡æ¿
   - ç”Ÿæˆç¨‹å¼ç¢¼
   â†“
7. å®Œæˆï¼
```

### é›™å‘åŒæ­¥ï¼šSpec â†” Code

```typescript
/**
 * Spec-Code é›™å‘åŒæ­¥
 */
class SpecCodeSync {
  /**
   * Spec è®Šæ›´æ™‚ï¼Œæç¤ºæ›´æ–° Code
   */
  async onSpecChanged(specPath: string, changes: Change[]): Promise<void> {
    // 1. åˆ†æè®Šæ›´
    const affectedCode = await this.findAffectedCode(specPath, changes);

    // 2. æç¤ºä½¿ç”¨è€…
    if (affectedCode.length > 0) {
      const choice = await vscode.window.showInformationMessage(
        `Spec å·²è®Šæ›´ï¼Œç™¼ç¾ ${affectedCode.length} å€‹ç›¸é—œç¨‹å¼ç¢¼æª”æ¡ˆ`,
        "ç”¨ Coding Agent æ›´æ–°",
        "æ‰‹å‹•å¯©æŸ¥",
        "å¿½ç•¥"
      );

      if (choice === "ç”¨ Coding Agent æ›´æ–°") {
        await this.regenerateCode(specPath, affectedCode);
      }
    }
  }

  /**
   * Code è®Šæ›´æ™‚ï¼Œæç¤ºæ›´æ–° Spec
   */
  async onCodeChanged(codePath: string, changes: Change[]): Promise<void> {
    const relatedSpec = await this.findRelatedSpec(codePath);

    if (relatedSpec) {
      const choice = await vscode.window.showInformationMessage(
        `ç¨‹å¼ç¢¼å·²è®Šæ›´ï¼Œæ˜¯å¦æ›´æ–°å°æ‡‰çš„ Specï¼Ÿ`,
        "æ˜¯",
        "å¦"
      );

      if (choice === "æ˜¯") {
        await this.updateSpec(relatedSpec, codePath, changes);
      }
    }
  }
}
```

### ç¤¾ç¾¤è²¢ç»ï¼šSpec Templates

```
Community Spec Templates
â”œâ”€â”€ API Specifications/
â”‚   â”œâ”€â”€ REST API Endpoint
â”‚   â”œâ”€â”€ GraphQL Schema
â”‚   â”œâ”€â”€ gRPC Service
â”‚   â”œâ”€â”€ WebSocket Event
â”‚   â””â”€â”€ Webhook Definition
â”œâ”€â”€ Data Models/
â”‚   â”œâ”€â”€ Relational Database Schema
â”‚   â”œâ”€â”€ NoSQL Document Schema
â”‚   â”œâ”€â”€ Graph Database Schema
â”‚   â””â”€â”€ Time-Series Data Model
â”œâ”€â”€ Algorithms/
â”‚   â”œâ”€â”€ Sorting Algorithm
â”‚   â”œâ”€â”€ Search Algorithm
â”‚   â”œâ”€â”€ Graph Algorithm
â”‚   â””â”€â”€ Dynamic Programming
â”œâ”€â”€ Architecture/
â”‚   â”œâ”€â”€ Microservice Architecture
â”‚   â”œâ”€â”€ Event-Driven Architecture
â”‚   â”œâ”€â”€ Layered Architecture
â”‚   â””â”€â”€ Hexagonal Architecture
â””â”€â”€ User Stories/
    â”œâ”€â”€ User Authentication
    â”œâ”€â”€ CRUD Operations
    â”œâ”€â”€ File Upload
    â””â”€â”€ Real-time Notifications
```

---

## åº•å±¤èˆ‡ç¡¬é«”é–‹ç™¼æ”¯æ´

### è¨­è¨ˆå‹•æ©Ÿ

TextBricks ä¸åƒ…æ”¯æ´é«˜éšç¨‹å¼èªè¨€ï¼Œä¹Ÿæ”¯æ´**åº•å±¤é–‹ç™¼**ï¼š

- **Assembly** - ç³»çµ±ç¨‹å¼ã€æ•ˆèƒ½å„ªåŒ–
- **Machine Code** - é€†å‘å·¥ç¨‹ã€å®‰å…¨ç ”ç©¶
- **HDL** - FPGA/ASIC è¨­è¨ˆ
- **Physical Circuit** - PCB è¨­è¨ˆã€åµŒå…¥å¼ç¡¬é«”

### Assembly æ¨¡æ¿ç³»çµ±

#### Assembly çš„å››ç´šç©æœ¨

| å±¤ç´š | å®šç¾© | x86-64 ç¯„ä¾‹ | ARM ç¯„ä¾‹ |
|------|------|-------------|----------|
| **L0** | å®Œæ•´ç¨‹å¼ | æ•´å€‹ .asm æª”æ¡ˆ | æ•´å€‹ .s æª”æ¡ˆ |
| **L1** | å‡½å¼/å­ç¨‹å¼ | `function_name:` ... `ret` | `label:` ... `bx lr` |
| **L2** | æŒ‡ä»¤åºåˆ— | Loop prologue, Stack frame | Function call sequence |
| **L3** | å–®ä¸€æŒ‡ä»¤ | `mov rax, rbx` | `mov r0, r1` |

#### Assembly æ¨¡æ¿ç¯„ä¾‹

```typescript
// L1: Function Prologue/Epilogue
const x86FunctionPrologue: AssemblyTemplate = {
  id: "asm-x86-function-prologue",
  name: "x86-64 Function Prologue",
  languageLevel: { type: "low-level", specific: "x86-asm" },
  granularity: "L2",

  forms: {
    sequence: {
      content: `; Function prologue - {{function_name}}
push    rbp
mov     rbp, rsp
sub     rsp, {{stack_size}}    ; Allocate stack space
`,
      language: "asm",
      format: ".asm"
    },

    structure: {
      blocks: [
        { type: "push", operand: "rbp", description: "Save old base pointer" },
        { type: "mov", operands: ["rbp", "rsp"], description: "Set new base pointer" },
        { type: "sub", operands: ["rsp", "{{stack_size}}"], description: "Allocate stack" }
      ]
    },

    topology: {
      nodes: [
        { id: "save-bp", type: "instruction", label: "push rbp" },
        { id: "set-bp", type: "instruction", label: "mov rbp, rsp" },
        { id: "alloc-stack", type: "instruction", label: "sub rsp, N" }
      ],
      edges: [
        { from: "save-bp", to: "set-bp" },
        { from: "set-bp", to: "alloc-stack" }
      ]
    }
  },

  metadata: {
    designRationale: "æ¨™æº–çš„å‡½å¼é€²å…¥åºåˆ—ï¼Œç¬¦åˆ System V AMD64 ABI",
    useCases: ["å‡½å¼å®šç¾©", "å †ç–Šæ¡†æ¶è¨­ç½®"],
    difficulty: "intermediate"
  },

  // Assembly ç‰¹å®šå…ƒè³‡æ–™ (Plugin)
  plugins: {
    "assembly-plugin": {
      architecture: {
        isa: "x86-64",
        convention: "System V AMD64 ABI"
      },
      registers: {
        used: ["rbp", "rsp"],
        preserved: ["rbp"]
      },
      performance: {
        instructionCount: 3,
        cycleEstimate: 3
      }
    }
  },

  variables: [
    {
      name: "function_name",
      type: "text",
      description: "å‡½å¼åç¨±"
    },
    {
      name: "stack_size",
      type: "number",
      description: "å †ç–Šå¤§å°ï¼ˆéœ€ç‚º 16 çš„å€æ•¸ï¼‰",
      validation: (value) => value % 16 === 0
    }
  ]
};

// L2: Loop Template
const x86LoopTemplate: AssemblyTemplate = {
  id: "asm-x86-loop",
  name: "x86-64 Loop Pattern",
  languageLevel: { type: "low-level", specific: "x86-asm" },
  granularity: "L2",

  forms: {
    sequence: {
      content: `; Loop - {{loop_name}}
    mov     {{counter}}, {{iterations}}
.{{loop_label}}:
    ; Loop body
    {{loop_body}}

    dec     {{counter}}
    jnz     .{{loop_label}}
`,
      language: "asm",
      format: ".asm"
    }
  },

  metadata: {
    designRationale: "ä½¿ç”¨ dec + jnz çµ„åˆï¼Œæ•ˆç‡é«˜æ–¼ cmp + jne",
    alternatives: [
      {
        name: "cmp + jne pattern",
        code: "cmp {{counter}}, 0; jne .loop",
        tradeoff: "è¼ƒç›´è§€ä½†å¤šä¸€æ¢æŒ‡ä»¤"
      }
    ]
  },

  plugins: {
    "assembly-plugin": {
      optimization: {
        level: "-O2",
        techniques: ["dec-jnz fusion"],
        cyclesSaved: 1
      }
    }
  }
};
```

### HDL (Hardware Description Language) æ¨¡æ¿ç³»çµ±

#### HDL çš„å››ç´šç©æœ¨

| å±¤ç´š | å®šç¾© | Verilog ç¯„ä¾‹ |
|------|------|--------------|
| **L0** | å®Œæ•´ç³»çµ± (SoC) | å¤šå€‹ module çµ„æˆçš„ç³»çµ± |
| **L1** | Module | `module counter(...)` |
| **L2** | Always Block / Assign | `always @(posedge clk)` |
| **L3** | é‚è¼¯é–˜ / è³¦å€¼ | `a & b`, `assign out = in` |

#### HDL æ¨¡æ¿ç¯„ä¾‹

```typescript
// L1: Synchronous Counter
const verilogCounterModule: HDLTemplate = {
  id: "hdl-verilog-counter",
  name: "Synchronous Counter",
  languageLevel: { type: "hdl", specific: "verilog" },
  granularity: "L1",

  forms: {
    sequence: {
      content: `module {{module_name}} #(
    parameter WIDTH = {{width}}
)(
    input  wire clk,
    input  wire reset,
    output reg [WIDTH-1:0] count
);

    always @(posedge clk or posedge reset) begin
        if (reset)
            count <= {WIDTH{1'b0}};
        else
            count <= count + 1'b1;
    end

endmodule
`,
      language: "verilog",
      format: ".v"
    },

    structure: {
      blocks: [
        {
          type: "module",
          name: "{{module_name}}",
          ports: [
            { name: "clk", direction: "input", type: "wire" },
            { name: "reset", direction: "input", type: "wire" },
            { name: "count", direction: "output", type: "reg", width: "{{width}}" }
          ],
          body: [
            {
              type: "always-block",
              sensitivity: ["posedge clk", "posedge reset"],
              body: "sequential-logic"
            }
          ]
        }
      ]
    },

    topology: {
      // é›»è·¯åœ–
      nodes: [
        { id: "clk", type: "input", label: "clk" },
        { id: "reset", type: "input", label: "reset" },
        { id: "counter_reg", type: "register", label: "count[{{width}}-1:0]", width: "{{width}}" },
        { id: "adder", type: "logic", label: "+1" },
        { id: "mux", type: "logic", label: "MUX" },
        { id: "count_out", type: "output", label: "count" }
      ],
      edges: [
        { from: "clk", to: "counter_reg", port: "clk" },
        { from: "reset", to: "mux", port: "sel" },
        { from: "counter_reg", to: "adder", port: "a" },
        { from: "adder", to: "mux", port: "in1" },
        { from: "mux", to: "counter_reg", port: "d" },
        { from: "counter_reg", to: "count_out" }
      ],
      graphType: "circuit-diagram"
    }
  },

  metadata: {
    designRationale: "åŒæ­¥è¨ˆæ•¸å™¨ï¼Œä½¿ç”¨ç•°æ­¥ reset",
    useCases: ["è¨ˆæ™‚å™¨", "åºåˆ—ç”Ÿæˆ", "ç‹€æ…‹æ©Ÿ"],
    difficulty: "beginner"
  },

  // HDL ç‰¹å®šå…ƒè³‡æ–™
  plugins: {
    "hdl-plugin": {
      timing: {
        clockDomains: ["clk"],
        resetStyle: "asynchronous"
      },
      synthesis: {
        synthesizable: true,
        targetDevice: "FPGA"
      },
      resources: {
        estimatedFFs: "{{width}}",
        estimatedLUTs: "{{width}} * 2",  // åŠ æ³•å™¨ + MUX
        estimatedBRAM: 0,
        estimatedDSP: 0
      },
      verification: {
        testbenchAvailable: true,
        testbenchTemplate: "hdl-testbench-counter"
      }
    }
  },

  variables: [
    {
      name: "module_name",
      type: "text",
      default: "counter",
      description: "æ¨¡çµ„åç¨±"
    },
    {
      name: "width",
      type: "number",
      default: 8,
      description: "è¨ˆæ•¸å™¨ä½å…ƒå¯¬åº¦",
      validation: (value) => value > 0 && value <= 64
    }
  ]
};

// L2: FIFO Module
const verilogFIFO: HDLTemplate = {
  id: "hdl-verilog-fifo",
  name: "Synchronous FIFO",
  languageLevel: { type: "hdl", specific: "verilog" },
  granularity: "L1",

  forms: {
    sequence: {
      content: `module {{module_name}} #(
    parameter DATA_WIDTH = {{data_width}},
    parameter DEPTH = {{depth}}
)(
    input  wire clk,
    input  wire reset,

    // Write interface
    input  wire                    wr_en,
    input  wire [DATA_WIDTH-1:0]   wr_data,
    output wire                    full,

    // Read interface
    input  wire                    rd_en,
    output reg  [DATA_WIDTH-1:0]   rd_data,
    output wire                    empty
);

    localparam ADDR_WIDTH = $clog2(DEPTH);

    reg [DATA_WIDTH-1:0] mem [0:DEPTH-1];
    reg [ADDR_WIDTH:0] wr_ptr, rd_ptr;

    assign full = (wr_ptr[ADDR_WIDTH] != rd_ptr[ADDR_WIDTH]) &&
                  (wr_ptr[ADDR_WIDTH-1:0] == rd_ptr[ADDR_WIDTH-1:0]);
    assign empty = (wr_ptr == rd_ptr);

    // Write logic
    always @(posedge clk) begin
        if (reset) begin
            wr_ptr <= 0;
        end else if (wr_en && !full) begin
            mem[wr_ptr[ADDR_WIDTH-1:0]] <= wr_data;
            wr_ptr <= wr_ptr + 1;
        end
    end

    // Read logic
    always @(posedge clk) begin
        if (reset) begin
            rd_ptr <= 0;
            rd_data <= 0;
        end else if (rd_en && !empty) begin
            rd_data <= mem[rd_ptr[ADDR_WIDTH-1:0]];
            rd_ptr <= rd_ptr + 1;
        end
    end

endmodule
`,
      language: "verilog",
      format: ".v"
    }
  },

  metadata: {
    designRationale: "åŒæ­¥ FIFOï¼Œä½¿ç”¨ Gray code pointer é¿å… CDC å•é¡Œ",
    useCases: ["è³‡æ–™ç·©è¡", "æ™‚è„ˆåŸŸè½‰æ›", "æµé‡æ§åˆ¶"],
    difficulty: "intermediate",
    alternatives: [
      {
        name: "Asynchronous FIFO",
        when: "éœ€è¦è·¨æ™‚è„ˆåŸŸ",
        tradeoff: "æ›´è¤‡é›œä½†æ”¯æ´ç•°æ­¥è®€å¯«"
      }
    ]
  },

  plugins: {
    "hdl-plugin": {
      resources: {
        estimatedFFs: "{{data_width}} * {{depth}} + æ§åˆ¶é‚è¼¯",
        estimatedBRAM: Math.ceil("{{depth}}" / 512)  // å¦‚æœ depth å¤§ï¼Œæœƒä½¿ç”¨ BRAM
      },
      timing: {
        criticalPath: "mem è®€å–è·¯å¾‘"
      }
    }
  }
};
```

### Machine Code æ¨¡æ¿

```typescript
// Machine Code Patterns
const x86InstructionPattern: MachineCodeTemplate = {
  id: "machine-x86-mov-pattern",
  name: "x86-64 MOV Instruction Encoding",
  languageLevel: { type: "machine", specific: "x86-64" },
  granularity: "L3",

  forms: {
    sequence: {
      content: "48 89 C3",  // mov rbx, rax (hex)
      language: "hex",
      format: ".bin"
    },

    structure: {
      encoding: {
        REX: "48",       // REX.W prefix (64-bit operand)
        opcode: "89",    // MOV r/m64, r64
        ModRM: "C3"      // MOD=11 (register), REG=000 (rax), R/M=011 (rbx)
      }
    },

    topology: {
      // æŒ‡ä»¤è§£ç¢¼æµæ°´ç·š
      nodes: [
        { id: "fetch", label: "Fetch: 48 89 C3" },
        { id: "decode", label: "Decode: MOV rbx, rax" },
        { id: "execute", label: "Execute: rbx â† rax" }
      ]
    }
  },

  metadata: {
    designRationale: "64-bit æš«å­˜å™¨é–“è³‡æ–™ç§»å‹•",
    useCases: ["é€†å‘å·¥ç¨‹", "äºŒé€²åˆ¶åˆ†æ", "æ•ˆèƒ½å„ªåŒ–"]
  },

  plugins: {
    "machine-plugin": {
      architecture: "x86-64",
      cycles: 1,
      latency: 1,
      throughput: 0.25  // æ¯å€‹é€±æœŸå¯åŸ·è¡Œ 4 æ¢
    }
  }
};
```

### åº•å±¤é–‹ç™¼çš„ç‰¹æ®Šéœ€æ±‚

#### 1. ç²¾ç¢ºæ€§è¦æ±‚

åº•å±¤é–‹ç™¼éœ€è¦**ä½å…ƒç´šç²¾ç¢º**ï¼š

```typescript
// ä¸èƒ½æœ‰æ¨¡ç³Šçš„æŠ½è±¡
// âœ— éŒ¯èª¤ï¼šæŠ½è±¡çš„ã€Œè¿´åœˆã€
template: "loop {{times}} times"

// âœ“ æ­£ç¢ºï¼šç²¾ç¢ºçš„æŒ‡ä»¤åºåˆ—
template: `mov ecx, {{times}}
.loop:
    {{body}}
    dec ecx
    jnz .loop`
```

#### 2. è³‡æºé™åˆ¶

ç¡¬é«”è³‡æºæ˜¯**æœ‰é™ä¸”æ˜‚è²´çš„**ï¼š

```typescript
// HDL æ¨¡æ¿éœ€è¦æ¨™è¨»è³‡æºä½¿ç”¨
plugins: {
  "hdl-plugin": {
    resources: {
      LUTs: 100,           // â† ä½¿ç”¨è€…éœ€è¦çŸ¥é“
      FFs: 50,
      BRAM: 2,
      maxFrequency: "200 MHz"
    }
  }
}
```

#### 3. æ™‚åºä¿è­‰

ç¡¬é«”å¿…é ˆæ»¿è¶³**æ™‚åºç´„æŸ**ï¼š

```typescript
// æ™‚åºæ¨¡æ¿
const timingConstraint: HDLTemplate = {
  metadata: {
    timing: {
      setupTime: "2ns",
      holdTime: "1ns",
      clockToQ: "1.5ns"
    }
  }
};
```

### åº•å±¤é–‹ç™¼å·¥å…·æ•´åˆ

```typescript
/**
 * åº•å±¤é–‹ç™¼å·¥å…·éˆæ•´åˆ
 */
class LowLevelToolchain {
  /**
   * Assembly æ¨¡æ¿ â†’ çµ„è­¯ â†’ é©—è­‰
   */
  async assembleAndVerify(template: AssemblyTemplate): Promise<void> {
    // 1. æ¸²æŸ“æ¨¡æ¿
    const asmCode = await this.renderTemplate(template);

    // 2. çµ„è­¯
    const objFile = await this.assemble(asmCode, "nasm");

    // 3. åçµ„è­¯é©—è­‰
    const disassembled = await this.disassemble(objFile);

    // 4. æ¯”å°
    if (!this.verify(asmCode, disassembled)) {
      throw new Error("çµ„è­¯çµæœèˆ‡é æœŸä¸ç¬¦");
    }
  }

  /**
   * HDL æ¨¡æ¿ â†’ ç¶œåˆ â†’ æ™‚åºåˆ†æ
   */
  async synthesizeAndAnalyze(template: HDLTemplate): Promise<SynthesisReport> {
    // 1. æ¸²æŸ“æ¨¡æ¿
    const verilogCode = await this.renderTemplate(template);

    // 2. ç¶œåˆ
    const netlist = await this.synthesize(verilogCode, "vivado");

    // 3. æ™‚åºåˆ†æ
    const timingReport = await this.analyzeTiming(netlist);

    // 4. è³‡æºä½¿ç”¨å ±å‘Š
    const resourceReport = await this.analyzeResources(netlist);

    return { timing: timingReport, resources: resourceReport };
  }
}
```

---

## æª”æ¡ˆæ¶æ§‹è¨­è¨ˆ

> **v3.0 é‡å¤§æ›´æ–°**ï¼šæª”æ¡ˆæ¶æ§‹åæ˜ å¤šèªè¨€å±¤ç´šã€å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒã€æ’ä»¶ç³»çµ±çš„è¨­è¨ˆ

### æ•´é«”çµæ§‹

> **v3.0 æ ¸å¿ƒåŸå‰‡**ï¼šæ¯å€‹æ¨¡æ¿éƒ½æ˜¯å®Œæ•´çš„**å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒ**ï¼Œä¸‰ç¨®å½¢æ…‹ï¼ˆSequence/Structure/Topologyï¼‰å­˜æ”¾åœ¨åŒä¸€å€‹ç›®éŒ„ä¸‹ï¼Œä¸æ‹†æ•£

```
scopes/
â””â”€â”€ local/                          # Local scopeï¼ˆå¯ä¿¡ä¾†æºï¼‰
    â”œâ”€â”€ scope.json                  # Scope é…ç½®
    â”‚
    â”œâ”€â”€ templates/                  # v3.0: çŸ¥è­˜å–®å…ƒç›®éŒ„ï¼ˆæŒ‰èªè¨€å±¤ç´šçµ„ç¹”ï¼‰
    â”‚   â”‚
    â”‚   â”œâ”€â”€ _registry/              # v3.0: Template Registryï¼ˆé›†ä¸­ç®¡ç†ï¼‰
    â”‚   â”‚   â”œâ”€â”€ registry.db         # SQLite è³‡æ–™åº«
    â”‚   â”‚   â”œâ”€â”€ index.json          # å¿«é€ŸæŸ¥è©¢ç´¢å¼•
    â”‚   â”‚   â”œâ”€â”€ plugins/            # æ’ä»¶è³‡æ–™
    â”‚   â”‚   â”‚   â”œâ”€â”€ hdl-plugin/
    â”‚   â”‚   â”‚   â”œâ”€â”€ python-plugin/
    â”‚   â”‚   â”‚   â””â”€â”€ assembly-plugin/
    â”‚   â”‚   â””â”€â”€ cache/              # å¿«å–ç›®éŒ„
    â”‚   â”‚       â”œâ”€â”€ by-language-level/
    â”‚   â”‚       â”œâ”€â”€ by-granularity/
    â”‚   â”‚       â””â”€â”€ by-plugin/
    â”‚   â”‚
    â”‚   â”œâ”€â”€ natural/                # v3.0: è‡ªç„¶èªè¨€å±¤ç´š
    â”‚   â”‚   â”œâ”€â”€ english/
    â”‚   â”‚   â”‚   â”œâ”€â”€ topic.json
    â”‚   â”‚   â”‚   â””â”€â”€ specs/
    â”‚   â”‚   â”‚       â””â”€â”€ rest-api-endpoint/   # â­ å®Œæ•´çŸ¥è­˜å–®å…ƒ
    â”‚   â”‚   â”‚           â”œâ”€â”€ meta.json        # çŸ¥è­˜å–®å…ƒå…ƒè³‡æ–™
    â”‚   â”‚   â”‚           â”œâ”€â”€ sequence.md      # Sequence Form (Spec)
    â”‚   â”‚   â”‚           â”œâ”€â”€ structure.json   # Structure Form (æ¦‚å¿µç©æœ¨)
    â”‚   â”‚   â”‚           â”œâ”€â”€ topology.json    # Topology Form (æ¦‚å¿µåœ–)
    â”‚   â”‚   â”‚           â”œâ”€â”€ concepts.json    # æå–çš„æ¦‚å¿µ
    â”‚   â”‚   â”‚           â”œâ”€â”€ annotations/     # è¨»è§£ç³»çµ±
    â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ hierarchical.json
    â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ indices.json
    â”‚   â”‚   â”‚           â”‚   â””â”€â”€ anchors.json
    â”‚   â”‚   â”‚           â”œâ”€â”€ README.md
    â”‚   â”‚   â”‚           â””â”€â”€ examples/
    â”‚   â”‚   â”‚               â””â”€â”€ user-endpoint.md
    â”‚   â”‚   â””â”€â”€ chinese/
    â”‚   â”‚       â””â”€â”€ ...
    â”‚   â”‚
    â”‚   â”œâ”€â”€ high-level/             # é«˜éšç¨‹å¼èªè¨€å±¤ç´š
    â”‚   â”‚   â”œâ”€â”€ c/
    â”‚   â”‚   â”‚   â”œâ”€â”€ topic.json
    â”‚   â”‚   â”‚   â””â”€â”€ basics/
    â”‚   â”‚   â”‚       â””â”€â”€ hello-world/         # â­ å®Œæ•´çŸ¥è­˜å–®å…ƒ
    â”‚   â”‚   â”‚           â”œâ”€â”€ meta.json        # çŸ¥è­˜å–®å…ƒå…ƒè³‡æ–™
    â”‚   â”‚   â”‚           â”œâ”€â”€ sequence.c       # Sequence Form (ç¨‹å¼ç¢¼)
    â”‚   â”‚   â”‚           â”œâ”€â”€ sequence.h       # é¡å¤–æª”æ¡ˆï¼ˆå¯é¸ï¼‰
    â”‚   â”‚   â”‚           â”œâ”€â”€ structure.xml    # Structure Form (Blockly)
    â”‚   â”‚   â”‚           â”œâ”€â”€ topology.json    # Topology Form (Call Graph)
    â”‚   â”‚   â”‚           â”œâ”€â”€ annotations/     # è¨»è§£ç³»çµ±
    â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ hierarchical.json
    â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ indices.json
    â”‚   â”‚   â”‚           â”‚   â””â”€â”€ anchors.json
    â”‚   â”‚   â”‚           â”œâ”€â”€ README.md
    â”‚   â”‚   â”‚           â”œâ”€â”€ examples/
    â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ basic.c
    â”‚   â”‚   â”‚           â”‚   â””â”€â”€ advanced.c
    â”‚   â”‚   â”‚           â”œâ”€â”€ tests/
    â”‚   â”‚   â”‚           â”‚   â””â”€â”€ test.c
    â”‚   â”‚   â”‚           â””â”€â”€ i18n/
    â”‚   â”‚   â”‚               â”œâ”€â”€ README.zh-TW.md
    â”‚   â”‚   â”‚               â””â”€â”€ README.en.md
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ python/
    â”‚   â”‚   â”‚   â””â”€â”€ ...
    â”‚   â”‚   â””â”€â”€ javascript/
    â”‚   â”‚       â””â”€â”€ ...
    â”‚   â”‚
    â”‚   â”œâ”€â”€ low-level/              # v3.0: ä½éšèªè¨€å±¤ç´šï¼ˆAssemblyï¼‰
    â”‚   â”‚   â”œâ”€â”€ x86-64/
    â”‚   â”‚   â”‚   â”œâ”€â”€ topic.json
    â”‚   â”‚   â”‚   â””â”€â”€ basics/
    â”‚   â”‚   â”‚       â””â”€â”€ function-prologue/   # â­ å®Œæ•´çŸ¥è­˜å–®å…ƒ
    â”‚   â”‚   â”‚           â”œâ”€â”€ meta.json
    â”‚   â”‚   â”‚           â”‚   # plugins: ["assembly-plugin"]
    â”‚   â”‚   â”‚           â”œâ”€â”€ sequence.asm     # Sequence Form (çµ„åˆèªè¨€)
    â”‚   â”‚   â”‚           â”œâ”€â”€ structure.xml    # Structure Form (æŒ‡ä»¤ç©æœ¨)
    â”‚   â”‚   â”‚           â”œâ”€â”€ topology.json    # Topology Form (æš«å­˜å™¨æµç¨‹åœ–)
    â”‚   â”‚   â”‚           â”œâ”€â”€ annotations/
    â”‚   â”‚   â”‚           â””â”€â”€ README.md
    â”‚   â”‚   â”œâ”€â”€ arm/
    â”‚   â”‚   â””â”€â”€ riscv/
    â”‚   â”‚
    â”‚   â”œâ”€â”€ machine/                # v3.0: æ©Ÿå™¨èªè¨€å±¤ç´š
    â”‚   â”‚   â””â”€â”€ x86-64/
    â”‚   â”‚       â””â”€â”€ instructions/
    â”‚   â”‚           â””â”€â”€ mov-instruction/     # â­ å®Œæ•´çŸ¥è­˜å–®å…ƒ
    â”‚   â”‚               â”œâ”€â”€ meta.json
    â”‚   â”‚               â”œâ”€â”€ sequence.hex     # Sequence Form (æŒ‡ä»¤ç·¨ç¢¼)
    â”‚   â”‚               â”œâ”€â”€ structure.json   # Structure Form (æŒ‡ä»¤æ ¼å¼åœ–)
    â”‚   â”‚               â”œâ”€â”€ topology.json    # Topology Form (ç®¡ç·šåœ–)
    â”‚   â”‚               â””â”€â”€ README.md
    â”‚   â”‚
    â”‚   â”œâ”€â”€ hdl/                    # v3.0: ç¡¬é«”æè¿°èªè¨€å±¤ç´š
    â”‚   â”‚   â”œâ”€â”€ verilog/
    â”‚   â”‚   â”‚   â”œâ”€â”€ topic.json
    â”‚   â”‚   â”‚   â””â”€â”€ basics/
    â”‚   â”‚   â”‚       â””â”€â”€ counter-module/      # â­ å®Œæ•´çŸ¥è­˜å–®å…ƒ
    â”‚   â”‚   â”‚           â”œâ”€â”€ meta.json
    â”‚   â”‚   â”‚           â”‚   # plugins: ["hdl-plugin"]
    â”‚   â”‚   â”‚           â”œâ”€â”€ sequence.v       # Sequence Form (Verilog)
    â”‚   â”‚   â”‚           â”œâ”€â”€ structure.xml    # Structure Form (æ¨¡çµ„ç©æœ¨)
    â”‚   â”‚   â”‚           â”œâ”€â”€ topology.json    # Topology Form (RTL åœ–)
    â”‚   â”‚   â”‚           â”œâ”€â”€ annotations/
    â”‚   â”‚   â”‚           â”œâ”€â”€ testbench.v      # æ¸¬è©¦å¹³å°
    â”‚   â”‚   â”‚           â””â”€â”€ README.md
    â”‚   â”‚   â”œâ”€â”€ vhdl/
    â”‚   â”‚   â””â”€â”€ systemverilog/
    â”‚   â”‚
    â”‚   â””â”€â”€ physical/               # v3.0: å¯¦é«”é›»è·¯å±¤ç´š
    â”‚       â””â”€â”€ netlists/
    â”‚           â””â”€â”€ counter-netlist/         # â­ å®Œæ•´çŸ¥è­˜å–®å…ƒ
    â”‚               â”œâ”€â”€ meta.json
    â”‚               â”œâ”€â”€ sequence.json        # Sequence Form (ç¶²è¡¨)
    â”‚               â”œâ”€â”€ structure.json       # Structure Form (å…ƒä»¶ç©æœ¨)
    â”‚               â”œâ”€â”€ topology.json        # Topology Form (ä½ˆç·šåœ–)
    â”‚               â””â”€â”€ README.md
    â”‚
    â”œâ”€â”€ plugins/                    # v3.0: æ’ä»¶ç³»çµ±
    â”‚   â”œâ”€â”€ hdl-plugin/
    â”‚   â”‚   â”œâ”€â”€ plugin.json         # æ’ä»¶é…ç½®
    â”‚   â”‚   â”œâ”€â”€ index.js            # æ’ä»¶å…¥å£
    â”‚   â”‚   â””â”€â”€ lib/                # æ’ä»¶é‚è¼¯
    â”‚   â”œâ”€â”€ python-plugin/
    â”‚   â””â”€â”€ assembly-plugin/
    â”‚
    â””â”€â”€ transformations/            # è½‰æ›è¦å‰‡èˆ‡æ˜ å°„
        â”œâ”€â”€ registry.json           # è½‰æ›è¨»å†Šè¡¨
        â”œâ”€â”€ mappings/               # è·¨çŸ¥è­˜å–®å…ƒå°æ‡‰
        â”‚   â”œâ”€â”€ spec-code/          # Spec â†” Code
        â”‚   â”œâ”€â”€ code-assembly/      # Code â†” Assembly
        â”‚   â””â”€â”€ hdl-netlist/        # HDL â†” Netlist
        â”‚
        â””â”€â”€ rules/                  # è½‰æ›è¦å‰‡
            â”œâ”€â”€ natural-to-high-level/
            â”œâ”€â”€ high-to-low-level/
            â”œâ”€â”€ low-to-machine/
            â””â”€â”€ high-to-hdl/
```

**v3.0 æ ¸å¿ƒè¨­è¨ˆåŸå‰‡**ï¼š

1. **çŸ¥è­˜å–®å…ƒå®Œæ•´æ€§** - æ¯å€‹æ¨¡æ¿ç›®éŒ„åŒ…å«æ‰€æœ‰ä¸‰ç¨®å½¢æ…‹ï¼Œä¸æ‹†æ•£
2. **çµ±ä¸€å‘½åè¦ç¯„** - sequence.*, structure.*, topology.* æ¸…æ™°è­˜åˆ¥
3. **èªè¨€å±¤ç´šçµ„ç¹”** - é ‚å±¤æŒ‰èªè¨€å±¤ç´šåˆ†é¡ï¼ˆnatural, high-level, low-level, machine, hdl, physicalï¼‰
4. **æ’ä»¶ç¨ç«‹ç®¡ç†** - æ’ä»¶ç³»çµ±ç¨ç«‹æ–¼æ¨¡æ¿ï¼Œé€é meta.json é—œè¯
5. **Registry é›†ä¸­ç´¢å¼•** - æä¾›å¿«é€ŸæŸ¥è©¢ï¼Œä½†ä¸æ”¹è®Šå¯¦é«”æª”æ¡ˆçµæ§‹

### çŸ¥è­˜å–®å…ƒæª”æ¡ˆçµæ§‹ç¯„ä¾‹

#### ç¯„ä¾‹ 1: Natural Language (Spec Template)

```
templates/natural/english/specs/rest-api-endpoint/
â”œâ”€â”€ meta.json          # çŸ¥è­˜å–®å…ƒå…ƒè³‡æ–™
â”œâ”€â”€ sequence.md        # Sequence Form (Spec æ–‡å­—)
â”œâ”€â”€ structure.json     # Structure Form (æ¦‚å¿µç©æœ¨)
â”œâ”€â”€ topology.json      # Topology Form (æ¦‚å¿µåœ–)
â”œâ”€â”€ concepts.json      # æå–çš„æ¦‚å¿µ
â”œâ”€â”€ annotations/       # è¨»è§£ç³»çµ±
â”‚   â”œâ”€â”€ hierarchical.json
â”‚   â”œâ”€â”€ indices.json
â”‚   â””â”€â”€ anchors.json
â”œâ”€â”€ README.md
â””â”€â”€ examples/
    â””â”€â”€ user-endpoint.md
```

#### ç¯„ä¾‹ 2: High-Level Programming (C)

```
templates/high-level/c/basics/hello-world/
â”œâ”€â”€ meta.json          # çŸ¥è­˜å–®å…ƒå…ƒè³‡æ–™
â”œâ”€â”€ sequence.c         # Sequence Form (ç¨‹å¼ç¢¼)
â”œâ”€â”€ sequence.h         # é¡å¤–æª”æ¡ˆï¼ˆå¯é¸ï¼‰
â”œâ”€â”€ structure.xml      # Structure Form (Blockly)
â”œâ”€â”€ topology.json      # Topology Form (Call Graph/Data Flow)
â”œâ”€â”€ annotations/       # è¨»è§£ç³»çµ±
â”‚   â”œâ”€â”€ hierarchical.json
â”‚   â”œâ”€â”€ indices.json
â”‚   â””â”€â”€ anchors.json
â”œâ”€â”€ README.md
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ basic.c
â”‚   â””â”€â”€ advanced.c
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test.c
â””â”€â”€ i18n/
    â”œâ”€â”€ README.zh-TW.md
    â””â”€â”€ README.en.md
```

#### ç¯„ä¾‹ 3: HDL (Verilog)

```
templates/hdl/verilog/basics/counter-module/
â”œâ”€â”€ meta.json          # çŸ¥è­˜å–®å…ƒå…ƒè³‡æ–™ (plugins: ["hdl-plugin"])
â”œâ”€â”€ sequence.v         # Sequence Form (Verilog)
â”œâ”€â”€ structure.xml      # Structure Form (æ¨¡çµ„ç©æœ¨)
â”œâ”€â”€ topology.json      # Topology Form (RTL åœ–)
â”œâ”€â”€ annotations/       # è¨»è§£ç³»çµ±
â”‚   â””â”€â”€ ...
â”œâ”€â”€ testbench.v        # æ¸¬è©¦å¹³å°
â””â”€â”€ README.md
```

---

### meta.json æ ¼å¼

> **v3.0 å®Œæ•´æ›´æ–°**ï¼šåæ˜ å¤šå½¢æ…‹çŸ¥è­˜å–®å…ƒçµæ§‹

```json
{
  "version": "3.0",
  "type": "multi-form-knowledge-unit",

  // 1. åŸºæœ¬è³‡è¨Š
  "id": "high-level-c-hello-world",
  "name": "01-hello-world",
  "title": "Hello World",
  "description": "æœ€åŸºæœ¬çš„ C ç¨‹å¼çµæ§‹ç¯„æœ¬ï¼Œå±•ç¤ºä¸‰å½¢æ…‹çŸ¥è­˜å–®å…ƒ",
  "tags": ["beginner", "basic", "io"],

  // 2. v3.0: èªè¨€å±¤ç´š
  "languageLevel": {
    "type": "high-level",
    "specific": "c"
  },

  // 3. v3.0: ç²’åº¦å±¤ç´š
  "granularity": "L1",

  // 4. ä¸‰ç¨®å½¢æ…‹
  "forms": {
    "sequence": {
      "main": "sequence.c",
      "additional": ["sequence.h"],
      "language": "c"
    },
    "structure": {
      "workspace": "structure.xml",
      "format": "blockly"
    },
    "topology": {
      "graphs": ["topology.json"],
      "types": ["call-graph", "data-flow"]
    }
  },

  // 5. v3.0: å…ƒè³‡æ–™ï¼ˆæ ¸å¿ƒï¼ï¼‰
  "metadata": {
    "designRationale": "ä½¿ç”¨ stdio.h çš„ printf æ˜¯ C èªè¨€æœ€æ¨™æº–çš„è¼¸å‡ºæ–¹å¼",
    "tradeoffs": {
      "pros": ["æ¨™æº–åº«æ”¯æ´", "è·¨å¹³å°", "ç°¡å–®æ˜“ç”¨"],
      "cons": ["éœ€è¦é€£çµæ¨™æº–åº«", "æ ¼å¼åŒ–é–‹éŠ·"]
    },
    "alternatives": ["write() ç³»çµ±å‘¼å«", "puts()"],
    "useCases": ["åˆå­¸è€…æ•™å­¸", "å¿«é€ŸåŸå‹", "é™¤éŒ¯è¼¸å‡º"],
    "antiPatterns": ["åœ¨åµŒå…¥å¼ç’°å¢ƒéåº¦ä½¿ç”¨ printf"],
    "dependencies": ["stdio.h"],
    "relatedTemplates": ["02-basic-structure", "printf-formatted"],
    "verified": true,
    "rating": 4.8,
    "usageCount": 1250,
    "difficulty": "beginner",
    "learningPath": ["c-syntax", "io-operations"],
    "exercises": ["ä¿®æ”¹è¼¸å‡ºè¨Šæ¯", "åŠ å…¥è®Šæ•¸è¼¸å‡º", "æ ¼å¼åŒ–è¼¸å‡º"]
  },

  // 6. v3.0: è¨»è§£ç³»çµ±ï¼ˆå¤šå±¤æ¬¡ï¼‰
  "annotations": {
    "hierarchical": "annotations/hierarchical.json",
    "byLevel": {
      "function": "annotations/indices.json#functions",
      "statement": "annotations/indices.json#statements",
      "block": "annotations/indices.json#blocks"
    },
    "anchored": "annotations/anchors.json"
  },

  // 7. v3.0: é ˜åŸŸæ’ä»¶ï¼ˆå¯é¸ï¼‰
  "plugins": [],

  // 8. è®Šæ•¸èˆ‡åƒæ•¸åŒ–
  "variables": [
    {
      "name": "message",
      "type": "string",
      "default": "Hello, World!",
      "description": "è¦é¡¯ç¤ºçš„è¨Šæ¯",
      "location": "sequence.c:4"
    }
  ],

  // 9. æª”æ¡ˆæ¸…å–®
  "files": {
    "source": ["sequence.c", "sequence.h"],
    "examples": ["examples/basic.c", "examples/advanced.c"],
    "tests": ["tests/test.c"],
    "docs": ["README.md", "i18n/README.zh-TW.md"]
  },

  // 10. ä½œè€…èˆ‡ç‰ˆæœ¬
  "author": "timcsy",
  "contributors": ["claude"],
  "created": "2025-10-19",
  "modified": "2025-10-20",
  "templateVersion": "1.2.0",

  // 11. v3.0: è½‰æ›è¦å‰‡ï¼ˆå¯é¸ï¼‰
  "transformRules": {
    "toLanguages": {
      "python": {
        "template": "high-level-python-hello-world",
        "confidence": 0.95
      },
      "javascript": {
        "template": "high-level-js-hello-world",
        "confidence": 0.92
      }
    },
    "toGranularities": {
      "L2": {
        "components": ["printf-statement", "return-statement"],
        "note": "å¯åˆ†è§£ç‚ºèªå¥ç´šæ¨¡æ¿"
      }
    }
  }
}
```

**v3.0 æ–°å¢æ¬„ä½èªªæ˜**ï¼š

- **languageLevel**: èªè¨€å±¤ç´šï¼ˆnatural, high-level, low-level, machine, hdl, physicalï¼‰
- **granularity**: ç²’åº¦å±¤ç´šï¼ˆL0, L1, L2, L3ï¼‰
- **forms**: ä¸‰ç¨®å½¢æ…‹çš„å®Œæ•´å®šç¾©
- **metadata**: è±å¯Œçš„å…ƒè³‡æ–™ï¼ˆè¨­è¨ˆç†ç”±ã€æ¬Šè¡¡ã€ç”¨ä¾‹ã€åæ¨¡å¼ç­‰ï¼‰
- **annotations**: å¤šå±¤æ¬¡è¨»è§£ç³»çµ±
- **plugins**: æ’ä»¶åˆ—è¡¨ï¼ˆå¦‚ HDL Plugin, Python Pluginï¼‰
- **transformRules**: è·¨èªè¨€/è·¨ç²’åº¦è½‰æ›è¦å‰‡

**v2.0 â†’ v3.0 é·ç§»**ï¼š
- `language` â†’ `languageLevel.specific`
- `type: "template"` â†’ `type: "multi-form-knowledge-unit"`
- `crossReferences` â†’ `metadata.relatedTemplates` + `forms`

### Structure Form (ç©æœ¨å½¢æ…‹) æª”æ¡ˆæ ¼å¼

> **v3.0 èªªæ˜**ï¼šStructure Form å­˜æ”¾åœ¨æ¯å€‹çŸ¥è­˜å–®å…ƒç›®éŒ„å…§çš„ `structure.xml` æˆ– `structure.json`

#### Blockly Workspace (structure.xml)

ç”¨æ–¼é«˜éšç¨‹å¼èªè¨€ã€Assemblyã€HDL ç­‰ï¼š

```xml
<xml xmlns="https://developers.google.com/blockly/xml">
  <block type="main_function" id="main" x="50" y="50">
    <statement name="BODY">
      <block type="print" id="print1">
        <value name="TEXT">
          <block type="text">
            <field name="TEXT">Hello, World!</field>
          </block>
        </value>
      </block>
    </statement>
  </block>
</xml>
```

#### JSON Structure (structure.json)

ç”¨æ–¼è‡ªç„¶èªè¨€ï¼ˆæ¦‚å¿µç©æœ¨ï¼‰ã€Machine Codeï¼ˆæŒ‡ä»¤æ ¼å¼åœ–ï¼‰ç­‰ï¼š

```json
{
  "type": "concept-blocks",
  "version": "3.0",
  "languageLevel": "natural",

  "blocks": [
    {
      "id": "endpoint-concept",
      "type": "rest-api-endpoint",
      "children": [
        {
          "id": "method-concept",
          "type": "http-method",
          "value": "POST"
        },
        {
          "id": "path-concept",
          "type": "api-path",
          "value": "/api/users"
        },
        {
          "id": "request-concept",
          "type": "request-model",
          "fields": ["name", "email", "password"]
        }
      ]
    }
  ]
}
```

---

### Topology Form (åœ–è­œå½¢æ…‹) æª”æ¡ˆæ ¼å¼

> **v3.0 èªªæ˜**ï¼šTopology Form å­˜æ”¾åœ¨æ¯å€‹çŸ¥è­˜å–®å…ƒç›®éŒ„å…§çš„ `topology.json`

#### Graph Definition (topology.json)

```json
{
  "id": "hello-world-call-graph",
  "version": "3.0",
  "type": "call-graph",
  "languageLevel": {
    "type": "high-level",
    "specific": "c"
  },

  "nodes": [
    {
      "id": "stdio",
      "type": "library",
      "label": "stdio.h",
      "metadata": {
        "standard": "C99",
        "category": "io"
      }
    },
    {
      "id": "main",
      "type": "function",
      "label": "main()",
      "metadata": {
        "returnType": "int",
        "parameters": []
      }
    },
    {
      "id": "printf",
      "type": "function",
      "label": "printf()",
      "metadata": {
        "library": "stdio",
        "variadic": true
      }
    }
  ],

  "edges": [
    {
      "from": "main",
      "to": "stdio",
      "type": "depends",
      "label": "#include"
    },
    {
      "from": "main",
      "to": "printf",
      "type": "calls",
      "label": "invokes",
      "metadata": {
        "arguments": ["\"Hello, World!\\n\""]
      }
    }
  ],

  "metadata": {
    "entryPoint": "main",
    "complexity": "simple",
    "layers": 2
  },

  "layout": {
    "algorithm": "hierarchical",
    "direction": "top-to-bottom"
  }
}
```

**æ”¯æ´çš„åœ–è­œé¡å‹**ï¼ˆä¾èªè¨€å±¤ç´šï¼‰ï¼š

| èªè¨€å±¤ç´š | Topology é¡å‹ |
|---------|---------------|
| Natural Language | æ¦‚å¿µåœ– (Concept Map) |
| High-Level Programming | Call Graph, Data Flow, Control Flow, Dependency Graph |
| Low-Level (Assembly) | æš«å­˜å™¨æµç¨‹åœ– (Register Flow) |
| Machine Code | ç®¡ç·šåœ– (Pipeline Diagram) |
| HDL | RTL åœ– (RTL Schematic) |
| Physical | ä½ˆç·šåœ– (Layout/Routing) |

---

### transformations/ (è½‰æ›è¦å‰‡) è©³ç´°çµæ§‹

```
transformations/
â”œâ”€â”€ registry.json                   # è½‰æ›è¨»å†Šè¡¨
â”‚
â”œâ”€â”€ sequence-to-structure/          # æ–‡å­— â†’ ç©æœ¨
â”‚   â”œâ”€â”€ c/
â”‚   â”‚   â””â”€â”€ patterns/
â”‚   â”‚       â”œâ”€â”€ hello-world.json
â”‚   â”‚       â”œâ”€â”€ for-loop.json
â”‚   â”‚       â””â”€â”€ function-def.json
â”‚   â”œâ”€â”€ python/
â”‚   â””â”€â”€ javascript/
â”‚
â”œâ”€â”€ sequence-to-topology/           # æ–‡å­— â†’ åœ–è­œ
â”‚   â”œâ”€â”€ c/
â”‚   â”‚   â””â”€â”€ analyzers/
â”‚   â”‚       â”œâ”€â”€ call-graph.js
â”‚   â”‚       â”œâ”€â”€ data-flow.js
â”‚   â”‚       â””â”€â”€ control-flow.js
â”‚   â””â”€â”€ python/
â”‚
â”œâ”€â”€ structure-to-sequence/          # ç©æœ¨ â†’ æ–‡å­—
â”‚   â””â”€â”€ (ç”± block generators è™•ç†)
â”‚
â”œâ”€â”€ structure-to-topology/          # ç©æœ¨ â†’ åœ–è­œ
â”‚   â””â”€â”€ rules/
â”‚       â””â”€â”€ block-dependencies.json
â”‚
â”œâ”€â”€ topology-to-sequence/           # åœ–è­œ â†’ æ–‡å­—
â”‚   â””â”€â”€ strategies/
â”‚       â”œâ”€â”€ topological-sort.json
â”‚       â”œâ”€â”€ inline-expansion.json
â”‚       â””â”€â”€ modular-decomposition.json
â”‚
â””â”€â”€ topology-to-structure/          # åœ–è­œ â†’ ç©æœ¨
    â””â”€â”€ rules/
        â””â”€â”€ node-to-block.json
```

#### registry.json æ ¼å¼

```json
{
  "version": "1.0",
  "forms": ["sequence", "structure", "topology"],

  "transformations": {
    "sequence-to-structure": {
      "strategy": "pattern-matching",
      "difficulty": "hard",
      "accuracy": "medium",
      "lossiness": "lossy",
      "lossTypes": ["formatting", "comments", "style"]
    },
    "sequence-to-topology": {
      "strategy": "static-analysis",
      "difficulty": "medium",
      "accuracy": "high",
      "lossiness": "lossy",
      "lossTypes": ["implementation-details"]
    },
    "structure-to-sequence": {
      "strategy": "code-generation",
      "difficulty": "easy",
      "accuracy": "high",
      "lossiness": "lossless"
    },
    "structure-to-topology": {
      "strategy": "block-dependency-analysis",
      "difficulty": "easy",
      "accuracy": "high",
      "lossiness": "lossless"
    },
    "topology-to-sequence": {
      "strategy": "graph-traversal",
      "difficulty": "medium",
      "accuracy": "medium",
      "lossiness": "lossy",
      "lossTypes": ["fine-grained-logic"]
    },
    "topology-to-structure": {
      "strategy": "node-expansion",
      "difficulty": "medium",
      "accuracy": "medium",
      "lossiness": "lossy",
      "lossTypes": ["expression-details"]
    }
  },

  "pathways": {
    "c-to-python": {
      "recommended": "via-structure",
      "paths": {
        "via-structure": {
          "steps": ["seqâ†’str", "strâ†’seq"],
          "accuracy": 0.85,
          "speed": "fast"
        },
        "via-topology": {
          "steps": ["seqâ†’top", "topâ†’seq"],
          "accuracy": 0.70,
          "speed": "medium"
        },
        "via-both": {
          "steps": ["seqâ†’str", "strâ†’top", "topâ†’str", "strâ†’seq"],
          "accuracy": 0.80,
          "speed": "slow",
          "note": "ç¶“éå¤šæ¬¡è½‰æ›ï¼Œè¶¨æ–¼æ”¶æ–‚"
        }
      }
    }
  },

  "lossWarnings": {
    "sequence-to-structure": [
      {
        "feature": "comments",
        "severity": "info",
        "message": "è¨»è§£å°‡æœƒéºå¤±ï¼Œä½†å¯åœ¨æ–‡æª”ä¸­ä¿ç•™"
      },
      {
        "feature": "macro-preprocessing",
        "severity": "warning",
        "message": "å·¨é›†é è™•ç†æŒ‡ä»¤å¯èƒ½ç„¡æ³•å®Œæ•´è½‰æ›"
      }
    ],
    "topology-to-sequence": [
      {
        "feature": "fine-grained-expressions",
        "severity": "warning",
        "message": "è©³ç´°çš„è¡¨é”å¼é‚è¼¯å¯èƒ½éœ€è¦æ‰‹å‹•è£œå……"
      }
    ]
  }
}
```

---

## ç©æœ¨ç³»çµ±è¨­è¨ˆ

### ç©æœ¨åˆ†é¡

#### 1. é€šç”¨ç©æœ¨ (Universal Blocks)

**å®šç¾©**ï¼šè·¨èªè¨€çš„æŠ½è±¡æ¦‚å¿µç©æœ¨

**ç‰¹å¾µ**ï¼š
- èªè¨€ç„¡é—œ
- é«˜å±¤ç´šæŠ½è±¡
- å¯ç”Ÿæˆå¤šç¨®èªè¨€

**ç¯„ä¾‹é¡åˆ¥**ï¼š
- æ§åˆ¶æµï¼šfor, while, if-else
- æ•¸æ“šçµæ§‹ï¼švariable, array, list
- I/Oï¼šprint, input, read-file

#### 2. èªè¨€ç‰¹å®šç©æœ¨ (Language-Specific Blocks)

**å®šç¾©**ï¼šç‰¹å®šèªè¨€ç¨æœ‰çš„ç‰¹æ€§

**ç‰¹å¾µ**ï¼š
- èªè¨€å°ˆå±¬
- ç„¡æ³•è·¨èªè¨€
- é«”ç¾èªè¨€ç‰¹è‰²

**ç¯„ä¾‹**ï¼š
- C: æŒ‡æ¨™ã€æ‰‹å‹•è¨˜æ†¶é«”ç®¡ç†
- Python: åˆ—è¡¨æ¨å°ã€è£é£¾å™¨
- JavaScript: Promiseã€async/await

### ç©æœ¨ç²’åº¦

**å››å±¤ç²’åº¦ç³»çµ±**ï¼š

```
L0 (ç³»çµ±ç´š) â”
            â”œâ”€ å±•é–‹/æ‘ºç–Š â”€â”
L1 (æ¨¡æ¿ç´š) â”¤             â”‚
            â”œâ”€ å±•é–‹/æ‘ºç–Š â”€â”¤  å½ˆæ€§åˆ‡æ›
L2 (èªå¥ç´š) â”¤             â”‚
            â”œâ”€ å±•é–‹/æ‘ºç–Š â”€â”˜
L3 (è¡¨é”å¼ç´š) â”˜
```

#### L0 - ç³»çµ±ç´š (System Level) âœ¨ æ–°å¢

- **å®šç¾©**ï¼šå¤šå€‹ L1 æ¨¡æ¿çµ„æˆçš„å®Œæ•´ç³»çµ±
- **ç‰¹å¾µ**ï¼šæ¨¡çµ„é–“å”åŒã€ç³»çµ±ç´šåŠŸèƒ½ã€ä»‹é¢å®šç¾©
- **é©ç”¨**ï¼šå°ˆæ¡ˆç´šè¦–è¦ºåŒ–ã€ç³»çµ±æ¶æ§‹è¨­è¨ˆ
- **ç¯„ä¾‹**ï¼šå­¸ç”Ÿç®¡ç†ç³»çµ±ã€é›»å•†å¹³å°ã€éŠæˆ²å¼•æ“
- **è¦–è¦ºåŒ–**ï¼šä¸»è¦é€éåœ–è­œå½¢æ…‹å‘ˆç¾ï¼ˆTopologyï¼‰

#### L1 - æ¨¡æ¿ç´š (Template Level)

- **å®šç¾©**ï¼šä¸€å€‹å®Œæ•´çš„ç¨‹å¼æˆ–æ¨¡å¼
- **ç‰¹å¾µ**ï¼šå¯å±•é–‹æˆ L2 ç©æœ¨çµ„åˆã€æœ‰ç‰¹å®šåŠŸèƒ½
- **é©ç”¨**ï¼šåˆå­¸è€…ä½¿ç”¨ã€å¿«é€Ÿé–‹ç™¼
- **ç¯„ä¾‹**ï¼šHello World ç¨‹å¼ã€æ³¡æ²«æ’åºã€äºŒå…ƒæœå°‹

#### L2 - èªå¥ç´š (Statement Level)

- **å®šç¾©**ï¼šå–®ä¸€èªå¥æˆ–æ§åˆ¶çµæ§‹
- **ç‰¹å¾µ**ï¼šå¯è‡ªç”±çµ„åˆã€æœ‰å®Œæ•´åŠŸèƒ½ã€æ˜¯ç©æœ¨ç·¨è¼¯çš„ä¸»è¦ç²’åº¦
- **é©ç”¨**ï¼šçµ„åˆé‚è¼¯ã€è‡ªè¨‚æµç¨‹
- **ç¯„ä¾‹**ï¼šfor è¿´åœˆã€if èªå¥ã€printfã€å‡½å¼å‘¼å«

#### L3 - è¡¨é”å¼ç´š (Expression Level)

- **å®šç¾©**ï¼šé‹ç®—ç¬¦å’ŒåŸºæœ¬å…ƒç´ 
- **ç‰¹å¾µ**ï¼šæœ€ç´°ç²’åº¦ã€å¯çµ„åˆæˆ L2
- **é©ç”¨**ï¼šç²¾ç¢ºæ§åˆ¶ã€è¤‡é›œè¡¨é”å¼
- **ç¯„ä¾‹**ï¼š+ã€*ã€==ã€è®Šæ•¸å¼•ç”¨ã€å­—é¢é‡

### é€šç”¨ç©æœ¨å®šç¾©ç¯„ä¾‹

> **v3.0 èªªæ˜**ï¼šä»¥ä¸‹ block.json ç¯„ä¾‹æ˜¯ç”¨ä¾†èªªæ˜ç©æœ¨çš„**å…§éƒ¨å®šç¾©æ ¼å¼**ï¼Œæè¿°ç©æœ¨çš„èªç¾©ã€åƒæ•¸ã€Blockly é…ç½®ç­‰ã€‚åœ¨ v3.0 æ¶æ§‹ä¸­ï¼Œé€™äº›è³‡è¨Šæœƒæ•´åˆåˆ°çŸ¥è­˜å–®å…ƒçš„ `structure.xml` æˆ– `structure.json` ä¸­ï¼Œä½œç‚º Structure Form çš„ä¸€éƒ¨åˆ†ã€‚

**for-loop/block.json** (æ¦‚å¿µç¯„ä¾‹):
```json
{
  "id": "universal_for_loop",
  "type": "universal",
  "category": "control",
  "version": "1.0.0",

  "abstract": {
    "concept": "è¿´åœˆï¼šé‡è¤‡åŸ·è¡Œç¨‹å¼ç¢¼å€å¡Š",
    "intent": "éæ­·ä¸€å€‹ç¯„åœæˆ–é›†åˆ",
    "semantics": "for (iterator from start to end) { body }",
    "parameters": {
      "iterator": {
        "type": "variable",
        "description": "è¿­ä»£è®Šæ•¸åç¨±",
        "required": true
      },
      "start": {
        "type": "expression",
        "description": "èµ·å§‹å€¼",
        "required": true
      },
      "end": {
        "type": "expression",
        "description": "çµæŸå€¼",
        "required": true
      },
      "step": {
        "type": "expression",
        "description": "æ­¥é€²å€¼",
        "default": 1
      },
      "body": {
        "type": "statements",
        "description": "è¿´åœˆä¸»é«”",
        "required": true
      }
    }
  },

  "blockly": {
    "type": "universal_for_loop",
    "message0": "for %1 from %2 to %3 %4 do %5",
    "args0": [
      {
        "type": "field_variable",
        "name": "ITERATOR",
        "variable": "i"
      },
      {
        "type": "input_value",
        "name": "START",
        "check": "Number"
      },
      {
        "type": "input_value",
        "name": "END",
        "check": "Number"
      },
      {"type": "input_dummy"},
      {
        "type": "input_statement",
        "name": "BODY"
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": 120,
    "tooltip": "é€šç”¨çš„ for è¿´åœˆç©æœ¨ï¼Œå¯ç”Ÿæˆå¤šç¨®èªè¨€",
    "helpUrl": ""
  },

  "supportedLanguages": ["c", "python", "javascript", "java"],

  "generators": {
    "c": "for-loop-c.js",
    "python": "for-loop-python.js",
    "javascript": "for-loop-javascript.js"
  },

  "metadata": {
    "tags": ["control", "loop", "iteration"],
    "difficulty": "beginner",
    "author": "textbricks",
    "created": "2025-10-20"
  }
}
```

**generators/c.js**:
```javascript
/**
 * C code generator for universal for-loop
 */
Blockly.C['universal_for_loop'] = function(block) {
  const iterator = block.getFieldValue('ITERATOR');
  const start = Blockly.C.valueToCode(
    block, 'START', Blockly.C.ORDER_ATOMIC
  );
  const end = Blockly.C.valueToCode(
    block, 'END', Blockly.C.ORDER_ATOMIC
  );
  const body = Blockly.C.statementToCode(block, 'BODY');

  const code = `for(int ${iterator} = ${start}; ${iterator} <= ${end}; ${iterator}++) {\n${body}}\n`;

  return code;
};
```

**generators/python.js**:
```javascript
/**
 * Python code generator for universal for-loop
 */
Blockly.Python['universal_for_loop'] = function(block) {
  const iterator = block.getFieldValue('ITERATOR');
  const start = Blockly.Python.valueToCode(
    block, 'START', Blockly.Python.ORDER_ATOMIC
  );
  const end = Blockly.Python.valueToCode(
    block, 'END', Blockly.Python.ORDER_ATOMIC
  );
  const body = Blockly.Python.statementToCode(block, 'BODY');

  const code = `for ${iterator} in range(${start}, ${end} + 1):\n${body}`;

  return code;
};
```

### èªè¨€ç‰¹å®šç©æœ¨å®šç¾©ç¯„ä¾‹

> **v3.0 èªªæ˜**ï¼šä»¥ä¸‹ block.json ç¯„ä¾‹å±•ç¤ºèªè¨€ç‰¹å®šç©æœ¨çš„å®šç¾©æ ¼å¼ã€‚åœ¨ v3.0 æ¶æ§‹ä¸­ï¼Œé€™äº›å®šç¾©æœƒå­˜æ”¾åœ¨å°æ‡‰èªè¨€çŸ¥è­˜å–®å…ƒçš„ `structure.xml` æˆ– `structure.json` ä¸­ã€‚

**c/pointers/pointer-declaration/block.json** (æ¦‚å¿µç¯„ä¾‹):
```json
{
  "id": "c_pointer_declaration",
  "type": "language-specific",
  "language": "c",
  "category": "pointers",
  "version": "1.0.0",

  "blockly": {
    "type": "c_pointer_declaration",
    "message0": "å®£å‘ŠæŒ‡æ¨™ %1 æŒ‡å‘ %2",
    "args0": [
      {
        "type": "field_variable",
        "name": "PTR",
        "variable": "ptr"
      },
      {
        "type": "field_variable",
        "name": "VAR",
        "variable": "x"
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": 230,
    "tooltip": "å®£å‘Šä¸€å€‹æŒ‡å‘è®Šæ•¸çš„æŒ‡æ¨™",
    "helpUrl": ""
  },

  "generators": {
    "c": "pointer-declaration-c.js"
  },

  "crossLanguageMapping": {
    "python": null,
    "javascript": null,
    "note": "æŒ‡æ¨™æ˜¯ C èªè¨€ç‰¹æœ‰æ¦‚å¿µï¼Œç„¡æ³•ç›´æ¥æ˜ å°„åˆ°å…¶ä»–èªè¨€ã€‚Python/JS å¯ä»¥è€ƒæ…®ç”¨å¼•ç”¨æˆ–ç‰©ä»¶ä¾†è¿‘ä¼¼ã€‚"
  },

  "metadata": {
    "tags": ["pointer", "memory", "advanced"],
    "difficulty": "advanced",
    "warning": "æ­¤ç©æœ¨ç„¡æ³•è½‰æ›åˆ°å…¶ä»–èªè¨€"
  }
}
```

---

## ç©æœ¨å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶

### æ¦‚è¿°

ç©æœ¨çš„å±•é–‹ï¼ˆExpandï¼‰å’Œæ‘ºç–Šï¼ˆCollapseï¼‰æ©Ÿåˆ¶å…è¨±ä½¿ç”¨è€…åœ¨ä¸åŒç²’åº¦å±¤ç´šä¹‹é–“è‡ªç”±åˆ‡æ›ã€‚é€™å€‹æ©Ÿåˆ¶æ˜¯ TextBricks å¤šå½¢æ…‹ç³»çµ±çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œè®“ä½¿ç”¨è€…èƒ½å¤ æ ¹æ“šéœ€æ±‚åœ¨ã€Œé«˜éšæŠ½è±¡ã€èˆ‡ã€Œç´°ç¯€å¯¦ä½œã€ä¹‹é–“éˆæ´»èª¿æ•´è¦–è§’ã€‚

### å››ç´šè½‰æ›é—œä¿‚

```
å±•é–‹æ–¹å‘ â†’ ï¼šå¢åŠ ç´°ç¯€ã€é™ä½æŠ½è±¡
æ‘ºç–Šæ–¹å‘ â† ï¼šæ¸›å°‘ç´°ç¯€ã€æé«˜æŠ½è±¡

           å±•é–‹                å±•é–‹               å±•é–‹
L0 â†â€•â€•â€•â€•â€•â€•â€•â€•â†’ L1 â†â€•â€•â€•â€•â€•â€•â€•â€•â†’ L2 â†â€•â€•â€•â€•â€•â€•â€•â€•â†’ L3
(ç³»çµ±ç´š)      (æ¨¡æ¿ç´š)      (èªå¥ç´š)      (è¡¨é”å¼ç´š)
    â†•             â†•             â†•             â†•
   åœ–è­œ         åœ–è­œ         æ–‡å­—          æ–‡å­—
  (ç³»çµ±åœ–)    (å‘¼å«åœ–)    (å‡½å¼ç¨‹å¼ç¢¼)  (è¡¨é”å¼ç¨‹å¼ç¢¼)
```

### L0 â†” L1 å±•é–‹æ‘ºç–Š

#### L0 â†’ L1 å±•é–‹

**å®šç¾©**ï¼šå°‡ç³»çµ±ç´šç©æœ¨å±•é–‹æˆå¤šå€‹æ¨¡æ¿ç´šç©æœ¨çš„çµ„åˆ

**ä½¿ç”¨å ´æ™¯**ï¼š
- ç³»çµ±æ¶æ§‹è¨­è¨ˆå®Œæˆå¾Œï¼Œéœ€è¦å¯¦ä½œå„å€‹æ¨¡çµ„
- å¾åœ–è­œè¦–åœ–åˆ‡æ›åˆ°ç©æœ¨ç·¨è¼¯å™¨

**æ©Ÿåˆ¶**ï¼š
```typescript
class L0Expander {
  expandL0ToL1(l0System: L0Block): L1Block[] {
    // è®€å–ç³»çµ±å®šç¾©
    const systemDef = l0System.getSystemDefinition();

    // æå–å„å€‹æ¨¡çµ„
    const modules = systemDef.modules;

    // ç‚ºæ¯å€‹æ¨¡çµ„å‰µå»º L1 ç©æœ¨
    const l1Blocks = modules.map(module => {
      return this.createL1BlockFromModule(module);
    });

    return l1Blocks;
  }
}
```

**ç¯„ä¾‹**ï¼š
```
L0: [å­¸ç”Ÿç®¡ç†ç³»çµ±]
  â†“ å±•é–‹
L1:
  - [æ¨¡çµ„] input_module
  - [æ¨¡çµ„] storage_module
  - [æ¨¡çµ„] search_module
  - [ä¸»ç¨‹å¼] main
```

#### L1 â†’ L0 æ‘ºç–Š

**å®šç¾©**ï¼šå°‡å¤šå€‹ç›¸é—œçš„ L1 ç©æœ¨æ‘ºç–Šæˆä¸€å€‹ç³»çµ±ç´šç©æœ¨

**ä½¿ç”¨å ´æ™¯**ï¼š
- å®Œæˆå¤šå€‹æ¨¡çµ„çš„å¯¦ä½œå¾Œï¼Œæ•´åˆæˆç³»çµ±
- å¾ç©æœ¨ç·¨è¼¯å™¨åˆ‡æ›åˆ°ç³»çµ±æ¶æ§‹è¦–åœ–

**è§¸ç™¼æ¢ä»¶**ï¼š
- ä½¿ç”¨è€…æ‰‹å‹•é¸æ“‡å¤šå€‹ L1 ç©æœ¨ä¸¦åŸ·è¡Œã€Œæ‘ºç–Šæˆç³»çµ±ã€
- ç³»çµ±æª¢æ¸¬åˆ°æ¨¡çµ„é–“æœ‰æ˜ç¢ºçš„ä»‹é¢é—œä¿‚

**æ©Ÿåˆ¶**ï¼š
```typescript
class L1Folder {
  collapseL1ToL0(l1Blocks: L1Block[], systemName: string): L0Block {
    // é©—è­‰æ¨¡çµ„é–“çš„ä»‹é¢ä¸€è‡´æ€§
    const isValid = this.validateModuleInterfaces(l1Blocks);
    if (!isValid) {
      throw new Error("æ¨¡çµ„ä»‹é¢ä¸ä¸€è‡´ï¼Œç„¡æ³•æ‘ºç–Šæˆç³»çµ±");
    }

    // åˆ†ææ¨¡çµ„é–“çš„ä¾è³´é—œä¿‚
    const dependencies = this.analyzeDependencies(l1Blocks);

    // å‰µå»ºç³»çµ±å®šç¾©
    const systemDef = {
      name: systemName,
      modules: l1Blocks.map(b => b.toModuleDefinition()),
      dependencies: dependencies
    };

    // å‰µå»º L0 ç©æœ¨
    return new L0Block(systemDef);
  }
}
```

### L1 â†” L2 å±•é–‹æ‘ºç–Š

#### L1 â†’ L2 å±•é–‹

**å®šç¾©**ï¼šå°‡æ¨¡æ¿ç´šç©æœ¨å±•é–‹æˆèªå¥ç´šç©æœ¨çµ„åˆ

**ä½¿ç”¨å ´æ™¯**ï¼š
- åˆå­¸è€…é¸æ“‡é å®šç¾©æ¨¡æ¿å¾Œï¼Œæƒ³è¦ä¿®æ”¹ç´°ç¯€
- ç†è§£æ¨¡æ¿çš„å…§éƒ¨çµæ§‹

**æ©Ÿåˆ¶**ï¼š
```typescript
class L1Expander {
  expandL1ToL2(l1Block: L1Block): L2Block[] {
    // è®€å– L1 çš„ workspace.xml
    const workspace = l1Block.loadWorkspace();

    // è§£ææˆ L2 ç©æœ¨é™£åˆ—
    const l2Blocks = this.parseWorkspaceToL2(workspace);

    // åœ¨ç·¨è¼¯å™¨ä¸­é¡¯ç¤º
    this.renderInEditor(l2Blocks);

    return l2Blocks;
  }
}
```

**ç¯„ä¾‹**ï¼š
```blockly
L1: [Hello World ç¨‹å¼]
  â†“ å±•é–‹
L2:
  [include] <stdio.h>
  [main function]
    [printf] "Hello, World!\n"
    [return] 0
```

#### L2 â†’ L1 æ‘ºç–Š

**å®šç¾©**ï¼šå°‡èªå¥ç´šç©æœ¨çµ„åˆæ‘ºç–Šæˆæ¨¡æ¿ç´šç©æœ¨

**ä½¿ç”¨å ´æ™¯**ï¼š
- ä½¿ç”¨è€…çµ„åˆå‡ºæœ‰ç”¨çš„ç©æœ¨çµ„åˆï¼Œæƒ³è¦å„²å­˜ç‚ºå¯é‡ç”¨çš„æ¨¡æ¿
- ç°¡åŒ–è¦–åœ–ï¼Œéš±è—ç´°ç¯€

**æ‘ºç–Šåˆ†æ•¸ç³»çµ±**ï¼š
```typescript
interface FoldingScore {
  l2_to_l1: {
    syntaxCorrectness: number;    // èªæ³•æ­£ç¢ºæ€§ (0-1)
    semanticClarity: number;       // èªç¾©æ¸…æ™°åº¦ (0-1)
    algorithmRecognition: number;  // èƒ½å¦è­˜åˆ¥ç‚ºå·²çŸ¥æ¼”ç®—æ³• (0-1)
    codeCompactness: number;       // ç¨‹å¼ç¢¼ç·Šæ¹Šåº¦ (0-1)
  };
  total: number;  // åŠ æ¬Šç¸½åˆ†
}

class L2Folder {
  calculateFoldingScore(l2Blocks: L2Block[]): FoldingScore {
    const score = {
      l2_to_l1: {
        syntaxCorrectness: this.checkSyntax(l2Blocks),
        semanticClarity: this.checkSemanticClarity(l2Blocks),
        algorithmRecognition: this.matchKnownAlgorithms(l2Blocks),
        codeCompactness: this.calculateCompactness(l2Blocks)
      },
      total: 0
    };

    // åŠ æ¬Šè¨ˆç®—ç¸½åˆ†
    score.total =
      score.l2_to_l1.syntaxCorrectness * 0.3 +
      score.l2_to_l1.semanticClarity * 0.2 +
      score.l2_to_l1.algorithmRecognition * 0.3 +
      score.l2_to_l1.codeCompactness * 0.2;

    return score;
  }

  suggestFolding(l2Blocks: L2Block[]): FoldingSuggestion | null {
    const score = this.calculateFoldingScore(l2Blocks);

    if (score.total > 0.8) {
      return {
        confidence: "high",
        message: "é€™å€‹ç©æœ¨çµ„åˆå¾ˆé©åˆæ‘ºç–Šæˆæ¨¡æ¿ï¼",
        suggestedName: this.generateTemplateName(l2Blocks),
        score: score
      };
    } else if (score.total > 0.5) {
      return {
        confidence: "medium",
        message: "å¯ä»¥æ‘ºç–Šï¼Œä½†å»ºè­°æª¢æŸ¥èªç¾©æ¸…æ™°åº¦",
        suggestedName: this.generateTemplateName(l2Blocks),
        score: score
      };
    } else {
      return null;  // ä¸å»ºè­°æ‘ºç–Š
    }
  }
}
```

### L2 â†” L3 å±•é–‹æ‘ºç–Š

#### L2 â†’ L3 å±•é–‹

**å®šç¾©**ï¼šå°‡èªå¥ç´šç©æœ¨å±•é–‹æˆè¡¨é”å¼ç´šç©æœ¨

**ä½¿ç”¨å ´æ™¯**ï¼š
- éœ€è¦ç²¾ç¢ºæ§åˆ¶è¡¨é”å¼çš„è¨ˆç®—é †åº
- æ•™å­¸ï¼šå±•ç¤ºè¡¨é”å¼çš„å…§éƒ¨çµæ§‹

**ç¯„ä¾‹**ï¼š
```blockly
L2: [for] i from 0 to n-1
  â†“ å±•é–‹
L3:
  [for statement]
    iterator: [variable] i
    start: [literal] 0
    end: [subtraction]
      left: [variable] n
      right: [literal] 1
    body: [statements]
```

#### L3 â†’ L2 æ‘ºç–Š

**å®šç¾©**ï¼šå°‡è¡¨é”å¼ç´šç©æœ¨çµ„åˆæ‘ºç–Šæˆèªå¥ç´šç©æœ¨

**è‡ªå‹•æ‘ºç–Š**ï¼šç•¶ L3 ç©æœ¨çµ„åˆç¬¦åˆå¸¸è¦‹çš„èªå¥æ¨¡å¼æ™‚ï¼Œç³»çµ±è‡ªå‹•å»ºè­°æ‘ºç–Š

**æ©Ÿåˆ¶**ï¼š
```typescript
class L3Folder {
  detectStatementPatterns(l3Blocks: L3Block[]): L2Pattern | null {
    // æª¢æ¸¬ for è¿´åœˆæ¨¡å¼
    if (this.matchForLoopPattern(l3Blocks)) {
      return {
        type: "for-loop",
        confidence: 0.95,
        message: "æª¢æ¸¬åˆ° for è¿´åœˆæ¨¡å¼"
      };
    }

    // æª¢æ¸¬ if èªå¥æ¨¡å¼
    if (this.matchIfStatementPattern(l3Blocks)) {
      return {
        type: "if-statement",
        confidence: 0.90,
        message: "æª¢æ¸¬åˆ° if èªå¥æ¨¡å¼"
      };
    }

    return null;
  }
}
```

### Structure Form ç‰ˆæœ¬æ§åˆ¶

#### ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

**å•é¡Œ**ï¼šL1 ç©æœ¨å±•é–‹å¾Œï¼Œä½¿ç”¨è€…å¯èƒ½ä¿®æ”¹ L2 çµ„åˆã€‚å¦‚ä½•ç®¡ç†é€™äº›ä¿®æ”¹ï¼Ÿ

**è§£æ±ºæ–¹æ¡ˆ**ï¼šç‰ˆæœ¬æ§åˆ¶ç³»çµ±

```
templates/high-level/c/basics/hello-world/
  â”œâ”€â”€ meta.json
  â”œâ”€â”€ sequence.c
  â”œâ”€â”€ structure.xml          # åŸå§‹ç‰ˆæœ¬ (v1)
  â”œâ”€â”€ structure-v2.xml       # ä½¿ç”¨è€…ä¿®æ”¹ç‰ˆæœ¬
  â”œâ”€â”€ structure-v3.xml       # é€²ä¸€æ­¥ä¿®æ”¹
  â”œâ”€â”€ topology.json
  â””â”€â”€ versions/
      â”œâ”€â”€ metadata.json      # ç‰ˆæœ¬è³‡è¨Š
      â””â”€â”€ diffs/             # ç‰ˆæœ¬å·®ç•°
          â”œâ”€â”€ v1-to-v2.diff
          â””â”€â”€ v2-to-v3.diff
```

#### versions/metadata.json æ ¼å¼

```json
{
  "currentVersion": "v3",
  "versions": [
    {
      "version": "v1",
      "file": "../structure.xml",
      "created": "2025-10-20T10:00:00Z",
      "author": "system",
      "description": "åŸå§‹æ¨¡æ¿",
      "readonly": true
    },
    {
      "version": "v2",
      "file": "../structure-v2.xml",
      "created": "2025-10-20T11:30:00Z",
      "author": "user",
      "description": "åŠ å…¥éŒ¯èª¤è™•ç†",
      "changes": "æ–°å¢ if èªå¥æª¢æŸ¥ null"
    },
    {
      "version": "v3",
      "file": "../structure-v3.xml",
      "created": "2025-10-20T14:20:00Z",
      "author": "user",
      "description": "å„ªåŒ–è¿´åœˆæ•ˆèƒ½",
      "changes": "æ”¹ç”¨ while è¿´åœˆ"
    }
  ],
  "branches": []
}
```

#### ç‰ˆæœ¬æ“ä½œ

**å‰µå»ºæ–°ç‰ˆæœ¬**ï¼š
```typescript
class WorkspaceVersionManager {
  createVersion(
    l2Blocks: L2Block[],
    description: string
  ): Version {
    const currentVersion = this.getCurrentVersion();
    const newVersionNumber = this.incrementVersion(currentVersion);

    // ç”Ÿæˆ diff
    const diff = this.generateDiff(currentVersion, l2Blocks);

    // å„²å­˜æ–°ç‰ˆæœ¬
    const newVersion = {
      version: newVersionNumber,
      file: `workspace-${newVersionNumber}.xml`,
      created: new Date().toISOString(),
      author: this.currentUser,
      description: description,
      changes: diff.summary
    };

    this.saveVersion(newVersion, l2Blocks);
    return newVersion;
  }
}
```

**ç‰ˆæœ¬æ¯”è¼ƒ**ï¼š
```typescript
class VersionComparator {
  compare(v1: Version, v2: Version): VersionDiff {
    const blocks1 = this.loadBlocks(v1);
    const blocks2 = this.loadBlocks(v2);

    return {
      added: this.findAddedBlocks(blocks1, blocks2),
      removed: this.findRemovedBlocks(blocks1, blocks2),
      modified: this.findModifiedBlocks(blocks1, blocks2),
      summary: this.generateSummary(...)
    };
  }
}
```

### ä½¿ç”¨è€…äº’å‹•è¨­è¨ˆ

#### å±•é–‹æ“ä½œ

**è§¸ç™¼æ–¹å¼**ï¼š
1. å³éµé¸å–®ï¼šå³éµé»æ“Šç©æœ¨ â†’ ã€Œå±•é–‹åˆ°ä¸‹ä¸€å±¤ç´šã€
2. é›™æ“Šï¼šé›™æ“Šç©æœ¨è‡ªå‹•å±•é–‹
3. å·¥å…·åˆ—æŒ‰éˆ•ï¼šé¸ä¸­ç©æœ¨å¾Œé»æ“Šã€Œå±•é–‹ã€æŒ‰éˆ•
4. å¿«æ·éµï¼š`Ctrl + E`ï¼ˆExpandï¼‰

**å±•é–‹å‹•ç•«**ï¼š
```
[L1 ç©æœ¨]
  â†“ æ·¡å‡º
  â†“ åŒæ™‚ï¼Œå‘¨åœå‡ºç¾ L2 ç©æœ¨
  â†“ L2 ç©æœ¨æ·¡å…¥
[L2 ç©æœ¨å€‘]
```

#### æ‘ºç–Šæ“ä½œ

**è§¸ç™¼æ–¹å¼**ï¼š
1. é¸æ“‡å¤šå€‹ç©æœ¨å¾Œï¼Œå³éµ â†’ ã€Œæ‘ºç–Šæˆæ¨¡æ¿ã€
2. å·¥å…·åˆ—æŒ‰éˆ•ï¼šé¸ä¸­å¾Œé»æ“Šã€Œæ‘ºç–Šã€æŒ‰éˆ•
3. å¿«æ·éµï¼š`Ctrl + F`ï¼ˆFoldï¼‰

**æ‘ºç–Šç¢ºèªå°è©±æ¡†**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‘ºç–Šæˆæ¨¡æ¿                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‘ºç–Šåˆ†æ•¸: 85/100 (é«˜)               â”‚
â”‚                                     â”‚
â”‚ âœ“ èªæ³•æ­£ç¢ºæ€§: 95%                   â”‚
â”‚ âœ“ èªç¾©æ¸…æ™°åº¦: 80%                   â”‚
â”‚ âœ“ æ¼”ç®—æ³•è­˜åˆ¥: 90% (å¿«é€Ÿæ’åº)       â”‚
â”‚ âœ“ ç¨‹å¼ç¢¼ç·Šæ¹Šåº¦: 75%                 â”‚
â”‚                                     â”‚
â”‚ æ¨¡æ¿åç¨±: [____________]            â”‚
â”‚ å»ºè­°åç¨±: quick-sort                â”‚
â”‚                                     â”‚
â”‚ å„²å­˜ä½ç½®:                           â”‚
â”‚  â—‹ å„²å­˜ç‚ºæ–° L1 æ¨¡æ¿                â”‚
â”‚  â—‹ æ›´æ–°ç¾æœ‰æ¨¡æ¿                    â”‚
â”‚  â—‹ åƒ…è‡¨æ™‚æ‘ºç–Šï¼ˆä¸å„²å­˜ï¼‰            â”‚
â”‚                                     â”‚
â”‚ [ç¢ºèªæ‘ºç–Š] [å–æ¶ˆ]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### èªæ³•é©—è­‰æ©Ÿåˆ¶

**è¨­è¨ˆæ±ºç­–**ï¼šé˜»æ­¢æ“ä½œï¼ˆBlockly é¢¨æ ¼ï¼‰

**å¯¦ç¾**ï¼š
```typescript
class SyntaxValidator {
  validateConnection(
    sourceBlock: Block,
    targetSocket: Socket
  ): ValidationResult {
    // æª¢æŸ¥é¡å‹ç›¸å®¹æ€§
    if (!this.areTypesCompatible(sourceBlock.type, targetSocket.acceptedTypes)) {
      return {
        valid: false,
        reason: "é¡å‹ä¸ç›¸å®¹",
        severity: "error"
      };
    }

    // æª¢æŸ¥èªæ³•è¦å‰‡
    if (!this.checkSyntaxRules(sourceBlock, targetSocket)) {
      return {
        valid: false,
        reason: "é•åèªæ³•è¦å‰‡",
        severity: "error"
      };
    }

    return { valid: true };
  }

  // ç‰©ç†é˜»æ­¢ï¼šæ’æ§½ä¸ç›¸å®¹æ™‚ç„¡æ³•æ‹–æ”¾
  allowDrop(sourceBlock: Block, targetSocket: Socket): boolean {
    const validation = this.validateConnection(sourceBlock, targetSocket);
    return validation.valid;
  }
}
```

**è¦–è¦ºå›é¥‹**ï¼š
- ç›¸å®¹çš„æ’æ§½ï¼šé«˜äº®é¡¯ç¤ºã€ç¶ è‰²é‚Šæ¡†
- ä¸ç›¸å®¹çš„æ’æ§½ï¼šç°è‰²ã€ä¸å¯æ‹–å…¥
- å˜—è©¦æ‹–å…¥ä¸ç›¸å®¹ç©æœ¨ï¼šç´…è‰²é–ƒçˆã€éœ‡å‹•å‹•ç•«

### å¾…è¨è«–å•é¡Œ

#### 1. L0 ç©æœ¨çš„è¦–è¦ºå‘ˆç¾

**å•é¡Œ**ï¼šL0 æ‡‰è©²åƒä¸€å€‹ã€Œè¶…ç´šå¤§ç©æœ¨ã€é‚„æ˜¯ã€Œç©æœ¨çš„å®¹å™¨ã€ï¼Ÿ

**é¸é …**ï¼š
- A. å–®ä¸€å¤§ç©æœ¨ï¼Œå…§éƒ¨é¡¯ç¤ºæ¨¡çµ„åç¨±
- B. å®¹å™¨å¼ï¼Œå¯ä»¥åœ¨å…§éƒ¨æ‹–æ”¾ L1 ç©æœ¨
- C. åˆ†æ¨™ç±¤é ï¼Œæ¯å€‹ L1 ä¸€å€‹æ¨™ç±¤

**å½±éŸ¿**ï¼šUI è¨­è¨ˆã€ä½¿ç”¨è€…é«”é©—

#### 2. å±•é–‹å¾Œçš„è¦–åœ–ç®¡ç†

**å•é¡Œ**ï¼šå±•é–‹æ˜¯ã€Œæ›¿æ›ã€åŸç©æœ¨é‚„æ˜¯ã€Œåœ¨æ—é‚Šæ‰“é–‹æ–°è¦–åœ–ã€ï¼Ÿ

**é¸é …**ï¼š
- A. æ›¿æ›ï¼šåŸ L1 æ¶ˆå¤±ï¼Œé¡¯ç¤º L2 å€‘
- B. ä¸¦æ’ï¼šå·¦é‚Š L1ï¼Œå³é‚Šå±•é–‹çš„ L2 å€‘
- C. ç–ŠåŠ ï¼šL2 è¦†è“‹åœ¨ L1 ä¸Šï¼Œå¯åˆ‡æ›

**æ¬Šè¡¡**ï¼šç©ºé–“åˆ©ç”¨ vs ä¸Šä¸‹æ–‡ä¿æŒ

#### 3. å¤šå±¤ç´šåŒæ™‚å±•é–‹

**å•é¡Œ**ï¼šL0 â†’ L1 â†’ L2 åŒæ™‚å±•é–‹ï¼Œå¦‚ä½•ä¸è®“ç•«é¢å¤ªæ··äº‚ï¼Ÿ

**å¯èƒ½æ–¹æ¡ˆ**ï¼š
- éšæ®µå¼å±•é–‹ï¼šå…ˆå±•é–‹ L0 â†’ L1ï¼Œä½¿ç”¨è€…ç¢ºèªå¾Œå†å±•é–‹ L1 â†’ L2
- æ¨¹ç‹€è¦–åœ–ï¼šç”¨æ¨¹ç‹€çµæ§‹é¡¯ç¤ºå±¤ç´š
- éºµåŒ…å±‘å°èˆªï¼šé¡¯ç¤ºç•¶å‰åœ¨å“ªä¸€å±¤

---

## åœ–è­œç³»çµ±è¨­è¨ˆ

### åœ–è­œé¡å‹

#### 1. å‘¼å«åœ– (Call Graph)

**ç”¨é€”**ï¼šé¡¯ç¤ºå‡½å¼ä¹‹é–“çš„å‘¼å«é—œä¿‚

**ç¯€é»é¡å‹**ï¼š
- å‡½å¼ (function)
- æ–¹æ³• (method)

**é‚Šé¡å‹**ï¼š
- å‘¼å« (calls)
- è¢«å‘¼å« (called-by)

#### 2. æ•¸æ“šæµåœ– (Data Flow Graph)

**ç”¨é€”**ï¼šè¿½è¹¤æ•¸æ“šåœ¨ç¨‹å¼ä¸­çš„æµå‹•

**ç¯€é»é¡å‹**ï¼š
- è®Šæ•¸ (variable)
- å¸¸æ•¸ (constant)
- é‹ç®— (operation)

**é‚Šé¡å‹**ï¼š
- æ•¸æ“šæµ (data-flow)
- è³¦å€¼ (assignment)

#### 3. ä¾è³´åœ– (Dependency Graph)

**ç”¨é€”**ï¼šé¡¯ç¤ºæ¨¡çµ„ã€æª”æ¡ˆä¹‹é–“çš„ä¾è³´é—œä¿‚

**ç¯€é»é¡å‹**ï¼š
- æ¨¡çµ„ (module)
- æª”æ¡ˆ (file)
- å‡½å¼åº« (library)

**é‚Šé¡å‹**ï¼š
- ä¾è³´ (depends-on)
- åŒ…å« (includes)
- åŒ¯å…¥ (imports)

#### 4. æ§åˆ¶æµåœ– (Control Flow Graph)

**ç”¨é€”**ï¼šé¡¯ç¤ºç¨‹å¼åŸ·è¡Œçš„å¯èƒ½è·¯å¾‘

**ç¯€é»é¡å‹**ï¼š
- åŸºæœ¬å¡Š (basic-block)
- åˆ†æ”¯é» (branch)
- åˆæµé» (merge)

**é‚Šé¡å‹**ï¼š
- é †åº (sequential)
- æ¢ä»¶ (conditional)
- è¿´åœˆ (loop)

### åœ–è­œå­˜å„²æ ¼å¼

#### nodes.json
```json
{
  "nodes": [
    {
      "id": "node_001",
      "type": "function",
      "label": "main",
      "properties": {
        "returnType": "int",
        "parameters": [],
        "visibility": "public"
      },
      "metadata": {
        "file": "main.c",
        "line": 5,
        "column": 1
      }
    },
    {
      "id": "node_002",
      "type": "function",
      "label": "printf",
      "properties": {
        "library": "stdio.h",
        "variadic": true
      },
      "metadata": {
        "external": true
      }
    }
  ]
}
```

#### edges.json
```json
{
  "edges": [
    {
      "id": "edge_001",
      "from": "node_001",
      "to": "node_002",
      "type": "calls",
      "label": "invokes",
      "properties": {
        "arguments": ["\"Hello, World!\\n\""],
        "callSite": "line 7"
      }
    }
  ]
}
```

### äº’å‹•æ¨¡å¼è¨­è¨ˆ

ä¸åŒé¡å‹çš„åœ–è­œéœ€è¦ä¸åŒçš„äº’å‹•æ¨¡å¼ï¼Œé€™æ˜¯åŸºæ–¼åœ–è­œçš„ç”¨é€”å’Œç‰¹æ€§æ±ºå®šçš„ã€‚

#### äº’å‹•æ¨¡å¼è¡¨

| åœ–è­œé¡å‹ | äº’å‹•æ¨¡å¼ | å¯èª¿æ•´å¸ƒå±€ | å¯ç·¨è¼¯çµæ§‹ | ç†ç”± |
|---------|---------|-----------|-----------|------|
| **Call Graph** | å”¯è®€ + å¯èª¿æ•´å¸ƒå±€ | âœ… | âŒ | å‘¼å«é—œä¿‚ç”±ç¨‹å¼ç¢¼æ±ºå®šï¼Œä¸æ‡‰ç›´æ¥ç·¨è¼¯ï¼Œä½†å¯ä»¥èª¿æ•´è¦–è¦ºåŒ–å¹«åŠ©ç†è§£ |
| **Data Flow** | å”¯è®€ + å¯èª¿æ•´å¸ƒå±€ | âœ… | âŒ | æ•¸æ“šæµå‘ç”±ç¨‹å¼é‚è¼¯æ±ºå®šï¼Œèª¿æ•´å¸ƒå±€å¹«åŠ©è¿½è¹¤æ•¸æ“šæµå‹• |
| **Dependency Graph** | å¯ç·¨è¼¯çµæ§‹ | âœ… | âœ… | æ¨¡çµ„ä¾è³´å¯ä»¥é‡æ§‹ï¼ˆå¦‚ç§»é™¤ä¸å¿…è¦çš„ importï¼‰ï¼Œç·¨è¼¯æœƒåŒæ­¥åˆ°ç¨‹å¼ç¢¼ |
| **Control Flow** | å”¯è®€ | âœ… | âŒ | æ§åˆ¶æµç”±ç¨‹å¼ç¢¼æ±ºå®šï¼Œå¤ªç´°ç¯€ä¸é©åˆç›´æ¥ç·¨è¼¯ |

#### äº’å‹•åŠŸèƒ½è©³ç´°èªªæ˜

**å”¯è®€æ¨¡å¼ï¼ˆRead-Onlyï¼‰**ï¼š
- âœ… å¯ä»¥ç¸®æ”¾ï¼ˆZoom In/Outï¼‰
- âœ… å¯ä»¥å¹³ç§»ï¼ˆPanï¼‰
- âœ… å¯ä»¥é»æ“Šç¯€é»æŸ¥çœ‹è©³ç´°è³‡è¨Š
- âœ… å¯ä»¥æ‘ºç–Š/å±•é–‹ç¯€é»
- âŒ ä¸èƒ½æ–°å¢/åˆªé™¤ç¯€é»
- âŒ ä¸èƒ½æ–°å¢/åˆªé™¤é€£ç·š

**å¯èª¿æ•´å¸ƒå±€ï¼ˆLayout Adjustableï¼‰**ï¼š
- âœ… å¯ä»¥æ‹–æ›³ç¯€é»èª¿æ•´ä½ç½®
- âœ… èª¿æ•´æœƒå„²å­˜åˆ° `visualizations/layout.json`
- âœ… ä¸‹æ¬¡é–‹å•Ÿæ™‚æ¢å¾©ä½¿ç”¨è€…çš„å¸ƒå±€
- âŒ ä¸æ”¹è®Šç¨‹å¼çµæ§‹

**å¯ç·¨è¼¯çµæ§‹ï¼ˆStructure Editableï¼‰**ï¼š
- âœ… å¯ä»¥æ–°å¢/åˆªé™¤é€£ç·šï¼ˆå¦‚ Dependency Graph ä¸­çš„ä¾è³´é—œä¿‚ï¼‰
- âœ… ç·¨è¼¯å‹•ä½œæœƒ**åŒæ­¥ä¿®æ”¹ç¨‹å¼ç¢¼**
- âš ï¸ æœ‰é©—è­‰æ©Ÿåˆ¶ï¼ˆä¾‹å¦‚ä¸èƒ½å‰µå»ºå¾ªç’°ä¾è³´ï¼‰
- âš ï¸ ç·¨è¼¯å‰æœƒè­¦å‘Šä½¿ç”¨è€…

#### å…·é«”ç¯„ä¾‹

**Call Graphï¼ˆå”¯è®€ + å¯èª¿æ•´å¸ƒå±€ï¼‰**ï¼š
```
ä½¿ç”¨è€…æ“ä½œï¼š
1. æ‹–æ›³ main() ç¯€é»åˆ°ç•«é¢ä¸­å¤®
2. æ‹–æ›³ printf() ç¯€é»åˆ° main() ä¸‹æ–¹
3. é»æ“Šã€Œå„²å­˜å¸ƒå±€ã€

ç³»çµ±è¡Œç‚ºï¼š
- ç¯€é»ä½ç½®å„²å­˜åˆ° layout.json
- ç¨‹å¼ç¢¼ä¸å—å½±éŸ¿
- ä¸‹æ¬¡é–‹å•Ÿæ™‚ï¼Œç¯€é»åœ¨åŒæ¨£çš„ä½ç½®
```

**Dependency Graphï¼ˆå¯ç·¨è¼¯çµæ§‹ï¼‰**ï¼š
```
ä½¿ç”¨è€…æ“ä½œï¼š
1. å³éµé»æ“Š module_a â†’ module_b çš„é€£ç·š
2. é¸æ“‡ã€Œç§»é™¤æ­¤ä¾è³´ã€

ç³»çµ±è¡Œç‚ºï¼š
- é¡¯ç¤ºè­¦å‘Šå°è©±æ¡†ï¼š
  ã€Œå°‡æœƒå¾ module_a.c ä¸­ç§»é™¤ #include "module_b.h"
   ç¢ºå®šè¦ç¹¼çºŒå—ï¼Ÿã€
- ä½¿ç”¨è€…ç¢ºèªå¾Œï¼š
  - ä¿®æ”¹ module_a.cï¼Œç§»é™¤ #include
  - æ›´æ–°åœ–è­œï¼Œç§»é™¤é€£ç·š
  - é‡æ–°é©—è­‰å°ˆæ¡ˆï¼ˆæª¢æŸ¥æ˜¯å¦æœ‰ç·¨è­¯éŒ¯èª¤ï¼‰
```

### å¸ƒå±€ç®¡ç†ç³»çµ±

#### å¸ƒå±€æ¼”ç®—æ³•é¸æ“‡

ä¸åŒçš„åœ–è­œé¡å‹é©åˆä¸åŒçš„å¸ƒå±€æ¼”ç®—æ³•ï¼š

##### 1. Hierarchicalï¼ˆéšå±¤å¼ï¼‰

**é©ç”¨åœ–è­œ**ï¼šCall Graph, Control Flow Graph

**ç‰¹å¾µ**ï¼š
- ç”±ä¸Šåˆ°ä¸‹ï¼ˆæˆ–ç”±å·¦åˆ°å³ï¼‰çš„å±¤ç´šçµæ§‹
- æ¸…æ¥šé¡¯ç¤ºå‘¼å«å±¤ç´šæˆ–åŸ·è¡Œé †åº
- çˆ¶ç¯€é»åœ¨ä¸Šï¼Œå­ç¯€é»åœ¨ä¸‹

**åƒæ•¸**ï¼š
```typescript
interface HierarchicalLayoutParams {
  direction: 'TB' | 'BT' | 'LR' | 'RL';  // Top-Bottom, Bottom-Top, Left-Right, Right-Left
  levelSeparation: number;  // å±¤ç´šé–“è·ï¼ˆé è¨­ 100pxï¼‰
  nodeSeparation: number;   // åŒå±¤ç¯€é»é–“è·ï¼ˆé è¨­ 50pxï¼‰
  edgeMinimization: boolean; // æ˜¯å¦æœ€å°åŒ–é‚Šäº¤å‰
}
```

**ç¯„ä¾‹**ï¼š
```
Call Graph (TB):
    main()
    â†™  â†“  â†˜
input() process() output()
        â†“
      helper()
```

##### 2. Force-Directedï¼ˆåŠ›å°å‘ï¼‰

**é©ç”¨åœ–è­œ**ï¼šDependency Graph, Data Flow Graph

**ç‰¹å¾µ**ï¼š
- ç¯€é»äº’ç›¸æ’æ–¥ï¼ˆåƒå½ˆç°§ï¼‰
- æœ‰é€£ç·šçš„ç¯€é»äº’ç›¸å¸å¼•
- è‡ªç„¶åœ°å½¢æˆç¾¤é›†ï¼ˆtightly coupled modulesï¼‰

**åƒæ•¸**ï¼š
```typescript
interface ForceDirectedLayoutParams {
  springLength: number;      // å½ˆç°§é•·åº¦ï¼ˆé è¨­ 100ï¼‰
  springStrength: number;    // å½ˆç°§å¼·åº¦ï¼ˆé è¨­ 0.1ï¼‰
  repulsionStrength: number; // æ’æ–¥å¼·åº¦ï¼ˆé è¨­ 1000ï¼‰
  gravity: number;           // é‡åŠ›ä¸­å¿ƒå¼·åº¦ï¼ˆé è¨­ 0.1ï¼‰
  iterations: number;        // è¿­ä»£æ¬¡æ•¸ï¼ˆé è¨­ 300ï¼‰
}
```

**å„ªé»**ï¼š
- ç›¸äº’ä¾è³´çš„æ¨¡çµ„è‡ªç„¶é è¿‘
- ç¨ç«‹çš„æ¨¡çµ„è‡ªå‹•åˆ†æ•£
- å¯ä»¥åµæ¸¬æ¨¡çµ„ç¾¤é›†

##### 3. Circularï¼ˆåœ“å½¢ï¼‰

**é©ç”¨åœ–è­œ**ï¼šDependency Graphï¼ˆç‰¹åˆ¥æ˜¯æœ‰å¾ªç’°ä¾è³´æ™‚ï¼‰

**ç‰¹å¾µ**ï¼š
- æ‰€æœ‰ç¯€é»æ’åˆ—æˆåœ“å½¢
- ä¾è³´é€£ç·šç©¿éä¸­å¤®
- å®¹æ˜“çœ‹å‡ºå¾ªç’°ä¾è³´

**åƒæ•¸**ï¼š
```typescript
interface CircularLayoutParams {
  radius: number;        // åœ“å½¢åŠå¾‘ï¼ˆé è¨­ 200ï¼‰
  startAngle: number;    // èµ·å§‹è§’åº¦ï¼ˆé è¨­ 0ï¼‰
  angleSpacing: 'uniform' | 'weighted';  // å‡å‹»åˆ†å¸ƒæˆ–æ ¹æ“šé€£ç·šæ•¸èª¿æ•´
}
```

**ç¯„ä¾‹**ï¼š
```
     A
   â†—   â†–
 B       F
 â†“       â†‘
 C  â†’  D â†’ E

å¦‚æœ A â†’ B â†’ C â†’ D â†’ E â†’ F â†’ Aï¼ˆå¾ªç’°ï¼‰ï¼Œ
åœ¨åœ“å½¢å¸ƒå±€ä¸­éå¸¸æ˜é¡¯
```

##### 4. Orthogonalï¼ˆæ­£äº¤å¼ï¼‰

**é©ç”¨åœ–è­œ**ï¼šControl Flow Graph

**ç‰¹å¾µ**ï¼š
- æ‰€æœ‰é€£ç·šéƒ½æ˜¯æ°´å¹³æˆ–å‚ç›´
- é¡ä¼¼å‚³çµ±æµç¨‹åœ–
- é©åˆè¡¨ç¤ºé †åºåŸ·è¡Œæµç¨‹

**åƒæ•¸**ï¼š
```typescript
interface OrthogonalLayoutParams {
  direction: 'TB' | 'LR';
  gridSize: number;  // ç¶²æ ¼å¤§å°ï¼ˆé è¨­ 20ï¼‰
  edgeRouting: 'direct' | 'orthogonal'; // é€£ç·šè·¯å¾‘
}
```

##### 5. Radialï¼ˆè¼»å°„ç‹€ï¼‰

**é©ç”¨åœ–è­œ**ï¼šCall Graphï¼ˆå…¥å£é»å°‘çš„æƒ…æ³ï¼‰

**ç‰¹å¾µ**ï¼š
- ä¸­å¿ƒç¯€é»ï¼ˆå¦‚ mainï¼‰åœ¨ä¸­å¤®
- å…¶ä»–ç¯€é»åœç¹è¼»å°„
- å±¤ç´šé—œä¿‚ä»¥åŒå¿ƒåœ“è¡¨ç¤º

**åƒæ•¸**ï¼š
```typescript
interface RadialLayoutParams {
  centerNode: string;  // ä¸­å¿ƒç¯€é» ID
  layerDistance: number;  // å±¤ç´šè·é›¢ï¼ˆé è¨­ 100ï¼‰
}
```

##### 6. Layeredï¼ˆåˆ†å±¤å¼ï¼‰

**é©ç”¨åœ–è­œ**ï¼šData Flow Graph

**ç‰¹å¾µ**ï¼š
- å¾å·¦åˆ°å³ï¼ˆæˆ–ä¸Šåˆ°ä¸‹ï¼‰åˆ†å±¤
- æ¯ä¸€å±¤æ˜¯æ•¸æ“šè™•ç†çš„ä¸€å€‹éšæ®µ
- é©åˆ Pipeline å¼çš„æ•¸æ“šæµ

**åƒæ•¸**ï¼š
```typescript
interface LayeredLayoutParams {
  direction: 'LR' | 'TB';
  layerSpacing: number;  // å±¤é–“è·ï¼ˆé è¨­ 100ï¼‰
  nodeSpacing: number;   // ç¯€é»é–“è·ï¼ˆé è¨­ 50ï¼‰
}
```

**ç¯„ä¾‹**ï¼š
```
Input Layer â†’ Processing Layer â†’ Output Layer
   A    â†’    B â†’ C â†’ D    â†’    E
   F    â†’        â†“         â†’    G
             H â†’
```

#### å¸ƒå±€é¸æ“‡å™¨

è‡ªå‹•æ¨è–¦æœ€é©åˆçš„å¸ƒå±€æ¼”ç®—æ³•ï¼š

```typescript
class LayoutSelector {
  /**
   * æ ¹æ“šåœ–è­œç‰¹å¾µæ¨è–¦å¸ƒå±€
   */
  recommendLayout(graph: Graph): LayoutRecommendation {
    const features = this.analyzeGraphFeatures(graph);

    // Call Graph
    if (graph.type === 'call-graph') {
      if (features.hasClearHierarchy && features.depth <= 5) {
        return {
          algorithm: 'hierarchical',
          params: { direction: 'TB', levelSeparation: 100 },
          reason: 'å‘¼å«å±¤ç´šæ¸…æ¥šä¸”æ·±åº¦é©ä¸­ï¼Œéšå±¤å¼å¸ƒå±€æœ€ä½³',
          confidence: 0.9
        };
      } else if (features.hasComplexInterconnections) {
        return {
          algorithm: 'force-directed',
          reason: 'å‡½å¼äº’ç›¸å‘¼å«è¤‡é›œï¼ŒåŠ›å°å‘å¯ä»¥è‡ªç„¶ç¾¤é›†',
          confidence: 0.8
        };
      } else if (features.hasFewEntryPoints) {
        return {
          algorithm: 'radial',
          params: { centerNode: features.mainEntryPoint },
          reason: 'å…¥å£é»å°‘ï¼Œè¼»å°„ç‹€å¸ƒå±€å¯ä»¥æ¸…æ¥šé¡¯ç¤ºå‘¼å«é—œä¿‚',
          confidence: 0.85
        };
      }
    }

    // Data Flow Graph
    if (graph.type === 'dataflow') {
      return {
        algorithm: 'layered',
        params: { direction: 'LR', layerSpacing: 120 },
        reason: 'æ•¸æ“šæµå¾å·¦åˆ°å³ï¼Œåˆ†å±¤å¸ƒå±€æœ€ç›´è§€',
        confidence: 0.95
      };
    }

    // Dependency Graph
    if (graph.type === 'dependency') {
      if (features.hasCycles) {
        return {
          algorithm: 'circular',
          reason: 'åµæ¸¬åˆ°å¾ªç’°ä¾è³´ï¼Œåœ“å½¢å¸ƒå±€å¯ä»¥æ¸…æ¥šé¡¯ç¤º',
          confidence: 0.85,
          warning: 'âš ï¸ ç™¼ç¾å¾ªç’°ä¾è³´ï¼Œå»ºè­°é‡æ§‹'
        };
      } else {
        return {
          algorithm: 'force-directed',
          reason: 'è¤‡é›œçš„ä¾è³´é—œä¿‚ï¼ŒåŠ›å°å‘å¯ä»¥é¡¯ç¤ºæ¨¡çµ„ç¾¤é›†',
          confidence: 0.8
        };
      }
    }

    // Control Flow Graph
    if (graph.type === 'controlflow') {
      return {
        algorithm: 'orthogonal',
        params: { direction: 'TB', edgeRouting: 'orthogonal' },
        reason: 'æ§åˆ¶æµä½¿ç”¨æ­£äº¤å¸ƒå±€æœ€åƒå‚³çµ±æµç¨‹åœ–',
        confidence: 0.9
      };
    }

    // é è¨­
    return {
      algorithm: 'force-directed',
      reason: 'é€šç”¨å¸ƒå±€',
      confidence: 0.5
    };
  }

  /**
   * åˆ†æåœ–è­œç‰¹å¾µ
   */
  analyzeGraphFeatures(graph: Graph): GraphFeatures {
    return {
      nodeCount: graph.nodes.length,
      edgeCount: graph.edges.length,
      density: graph.edges.length / (graph.nodes.length * (graph.nodes.length - 1)),
      hasClearHierarchy: this.detectHierarchy(graph),
      depth: this.calculateMaxDepth(graph),
      hasComplexInterconnections: this.detectComplexInterconnections(graph),
      hasFewEntryPoints: this.countEntryPoints(graph) <= 3,
      mainEntryPoint: this.findMainEntryPoint(graph),
      hasCycles: this.detectCycles(graph)
    };
  }
}
```

#### å¸ƒå±€å„²å­˜æ ¼å¼

**visualizations/layout.json**ï¼š
```json
{
  "version": "1.0",
  "graphId": "hello-world-call-graph",
  "graphType": "call-graph",
  "lastModified": "2025-10-20T15:30:00Z",

  "algorithm": {
    "type": "hierarchical",
    "auto": false,
    "params": {
      "direction": "TB",
      "levelSeparation": 100,
      "nodeSeparation": 50
    }
  },

  "nodes": {
    "main": {
      "x": 200,
      "y": 100,
      "collapsed": false,
      "pinned": true
    },
    "printf": {
      "x": 200,
      "y": 250,
      "collapsed": false,
      "pinned": false
    },
    "stdio": {
      "x": 50,
      "y": 250,
      "collapsed": true,
      "pinned": false
    }
  },

  "viewport": {
    "zoom": 1.5,
    "centerX": 200,
    "centerY": 200,
    "rotation": 0
  },

  "userPreferences": {
    "autoLayout": false,
    "edgeStyle": "curved",
    "nodeSpacing": 100,
    "showLabels": true,
    "showMinimap": true
  }
}
```

#### UI è¨­è¨ˆ

**å¸ƒå±€æ§åˆ¶é¢æ¿**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Call Graph - main.c                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¸ƒå±€æ¼”ç®—æ³•: [Hierarchical (éšå±¤å¼) â–¼]          â”‚
â”‚                                                 â”‚
â”‚ ğŸ’¡ ç³»çµ±æ¨è–¦: Hierarchical                      â”‚
â”‚    å‘¼å«å±¤ç´šæ¸…æ¥šä¸”æ·±åº¦é©ä¸­ï¼Œéšå±¤å¼å¸ƒå±€æœ€ä½³      â”‚
â”‚    ä¿¡å¿ƒåº¦: 90%                                  â”‚
â”‚                                                 â”‚
â”‚ å…¶ä»–é¸é …:                                       â”‚
â”‚   â—‹ Force-Directed (é©åˆè¤‡é›œäº’ç›¸å‘¼å«) 80%     â”‚
â”‚   â—‹ Radial (ä»¥å…¥å£é»ç‚ºä¸­å¿ƒè¼»å°„) 75%           â”‚
â”‚   â—‹ Circular (åœ“å½¢æ’åˆ—) 60%                   â”‚
â”‚                                                 â”‚
â”‚ âš™ï¸ é€²éšåƒæ•¸ â–¼                                  â”‚
â”‚   æ–¹å‘: [ç”±ä¸Šåˆ°ä¸‹ â–¼]                           â”‚
â”‚   å±¤ç´šé–“è·: [100] px                           â”‚
â”‚   ç¯€é»é–“è·: [50] px                            â”‚
â”‚   æœ€å°åŒ–é‚Šäº¤å‰: [âœ“]                            â”‚
â”‚                                                 â”‚
â”‚ [å¥—ç”¨] [é‡è¨­ç‚ºæ¨è–¦] [å„²å­˜ç‚ºé è¨­]               â”‚
â”‚                                                 â”‚
â”‚ äº’å‹•æ¨¡å¼: ğŸ”’ å”¯è®€ + å¯èª¿æ•´å¸ƒå±€                 â”‚
â”‚ [å„²å­˜ç•¶å‰å¸ƒå±€] [æ¢å¾©è‡ªå‹•å¸ƒå±€]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¯€é»å³éµé¸å–®**ï¼ˆæ ¹æ“šåœ–è­œé¡å‹å‹•æ…‹èª¿æ•´ï¼‰ï¼š
```
Call Graph:
  - ğŸ“‹ æŸ¥çœ‹ç¯€é»è©³æƒ…
  - ğŸ” é«˜äº®æ­¤ç¯€é»çš„æ‰€æœ‰å‘¼å«
  - ğŸ“ å›ºå®šä½ç½® (Pin)
  - ğŸ“‚ æ‘ºç–Š/å±•é–‹
  - âŒ ç„¡æ³•åˆªé™¤ï¼ˆå”¯è®€ï¼‰

Dependency Graph:
  - ğŸ“‹ æŸ¥çœ‹æ¨¡çµ„è©³æƒ…
  - â• æ–°å¢ä¾è³´
  - â– ç§»é™¤ä¾è³´
  - ğŸ” æª¢æŸ¥å¾ªç’°ä¾è³´
  - ğŸ“ å›ºå®šä½ç½®
```

### åœ–è­œç”Ÿæˆç­–ç•¥

#### å¾æ–‡å­—ç”Ÿæˆåœ–è­œ

```typescript
class SequenceToTopologyTransformer {
  async transform(code: string, language: string): Promise<Graph> {
    // 1. è§£æ AST
    const ast = this.parseCode(code, language);

    // 2. æå–ç¯€é»
    const nodes = this.extractNodes(ast, {
      functions: true,
      variables: true,
      types: true
    });

    // 3. åˆ†æé—œä¿‚
    const edges = this.analyzeRelations(ast, nodes, {
      callGraph: true,
      dataFlow: true,
      dependencies: true,
      controlFlow: false  // å¯é¸
    });

    // 4. å»ºæ§‹åœ–è­œ
    return new Graph(nodes, edges);
  }

  extractNodes(ast, options) {
    const nodes = [];

    // éæ­· AST
    traverse(ast, {
      FunctionDeclaration(path) {
        if (options.functions) {
          nodes.push({
            id: generateId(),
            type: 'function',
            label: path.node.name,
            properties: extractFunctionProps(path.node)
          });
        }
      },
      VariableDeclaration(path) {
        if (options.variables) {
          // ... æå–è®Šæ•¸
        }
      }
    });

    return nodes;
  }

  analyzeRelations(ast, nodes, options) {
    const edges = [];

    if (options.callGraph) {
      edges.push(...this.buildCallGraph(ast, nodes));
    }

    if (options.dataFlow) {
      edges.push(...this.traceDataFlow(ast, nodes));
    }

    if (options.dependencies) {
      edges.push(...this.analyzeDependencies(ast, nodes));
    }

    return edges;
  }
}
```

#### å¾åœ–è­œç”Ÿæˆæ–‡å­—

```typescript
class TopologyToSequenceTransformer {
  async transform(graph: Graph, language: string, strategy: string): Promise<string> {
    switch (strategy) {
      case 'topological-sort':
        return this.topologicalSort(graph, language);

      case 'inline-expansion':
        return this.inlineExpansion(graph, language);

      case 'modular-decomposition':
        return this.modularDecomposition(graph, language);

      default:
        throw new Error(`Unknown strategy: ${strategy}`);
    }
  }

  /**
   * æ‹“æ’²æ’åºï¼šæŒ‰ä¾è³´é †åºç”Ÿæˆç¨‹å¼ç¢¼
   */
  topologicalSort(graph: Graph, language: string): string {
    // 1. æ‹“æ’²æ’åºç¯€é»
    const sorted = graph.topologicalSort();

    // 2. ä¾åºç”Ÿæˆæ¯å€‹ç¯€é»çš„ç¨‹å¼ç¢¼
    const codeBlocks = sorted.map(node => {
      return this.generateNodeCode(node, language);
    });

    // 3. çµ„åˆæˆå®Œæ•´ç¨‹å¼
    return this.assembleCode(codeBlocks, language);
  }

  /**
   * å…§è¯å±•é–‹ï¼šå°‡æ‰€æœ‰ç¯€é»å…§è¯åˆ°ä¸€å€‹å‡½å¼
   */
  inlineExpansion(graph: Graph, language: string): string {
    const entryNode = graph.getEntryPoint();
    return this.expandNodeRecursively(entryNode, graph, language);
  }

  /**
   * æ¨¡çµ„åŒ–åˆ†è§£ï¼šä¿æŒæ¨¡çµ„çµæ§‹
   */
  modularDecomposition(graph: Graph, language: string): string {
    // è­˜åˆ¥æ¨¡çµ„é‚Šç•Œ
    const modules = graph.identifyModules();

    // ç‚ºæ¯å€‹æ¨¡çµ„ç”Ÿæˆç¨‹å¼ç¢¼
    return modules.map(mod => {
      return this.generateModuleCode(mod, language);
    }).join('\n\n');
  }
}
```

---

## è½‰æ›ç³»çµ±è¨­è¨ˆ

### è½‰æ›å¼•æ“æ¶æ§‹

```typescript
/**
 * å¤šå½¢æ…‹è½‰æ›å¼•æ“
 */
class PolyglotTransformationEngine {
  private transformers: Map<string, Transformer>;
  private pathRouter: PathRouter;
  private lossTracker: LossTracker;

  constructor() {
    this.initializeTransformers();
    this.pathRouter = new PathRouter();
    this.lossTracker = new LossTracker();
  }

  /**
   * ä¸»è½‰æ›ä»‹é¢
   */
  async transform(
    input: FormData,
    targetForm: FormType,
    options: TransformOptions
  ): Promise<TransformResult> {
    // 1. ç¢ºå®šè½‰æ›è·¯å¾‘
    const path = this.pathRouter.selectPath(
      input.form,
      targetForm,
      options
    );

    // 2. åŸ·è¡Œè½‰æ›
    let current = input;
    const losses = [];

    for (const step of path.steps) {
      const transformer = this.getTransformer(step);

      // è½‰æ›å‰è­¦å‘Š
      const warnings = transformer.getWarnings(current);
      if (warnings.length > 0 && !options.suppressWarnings) {
        await this.showWarnings(warnings);
      }

      // åŸ·è¡Œè½‰æ›
      const result = await transformer.transform(current);

      // è¨˜éŒ„æå¤±
      losses.push(...result.losses);
      current = result.output;
    }

    // 3. è¿”å›çµæœ
    return {
      output: current,
      losses: losses,
      confidence: path.confidence
    };
  }
}
```

### è·¯å¾‘é¸æ“‡å™¨

```typescript
/**
 * è½‰æ›è·¯å¾‘é¸æ“‡å™¨
 */
class PathRouter {
  /**
   * é¸æ“‡æœ€ä½³è½‰æ›è·¯å¾‘
   */
  selectPath(
    from: FormType,
    to: FormType,
    options: TransformOptions
  ): TransformPath {
    // 1. æ‰¾å‡ºæ‰€æœ‰å¯èƒ½è·¯å¾‘
    const paths = this.findAllPaths(from, to);

    // 2. è©•åˆ†
    const scored = paths.map(path => ({
      path,
      score: this.scorePath(path, options)
    }));

    // 3. é¸æ“‡æœ€é«˜åˆ†
    scored.sort((a, b) => b.score - a.score);

    return scored[0].path;
  }

  /**
   * è·¯å¾‘è©•åˆ†
   */
  scorePath(path: TransformPath, options: TransformOptions): number {
    const weights = options.weights || {
      accuracy: 0.4,
      speed: 0.3,
      preservation: 0.3
    };

    const accuracy = this.calculateAccuracy(path);
    const speed = this.estimateSpeed(path);
    const preservation = this.calculatePreservation(path);

    return (
      accuracy * weights.accuracy +
      speed * weights.speed +
      preservation * weights.preservation
    );
  }

  /**
   * è¨ˆç®—æº–ç¢ºåº¦
   */
  calculateAccuracy(path: TransformPath): number {
    // åŸºæ–¼æ¯å€‹æ­¥é©Ÿçš„æ­·å²æº–ç¢ºç‡
    const stepAccuracies = path.steps.map(step =>
      this.getStepAccuracy(step)
    );

    // é€£çºŒæº–ç¢ºç‡ç›¸ä¹˜
    return stepAccuracies.reduce((acc, val) => acc * val, 1.0);
  }

  /**
   * è¨ˆç®—è³‡è¨Šä¿ç•™åº¦
   */
  calculatePreservation(path: TransformPath): number {
    // æå¤±è¶Šå¤šï¼Œä¿ç•™åº¦è¶Šä½
    const totalLoss = path.steps.reduce((sum, step) =>
      sum + this.getStepLossRate(step), 0
    );

    return Math.exp(-totalLoss);  // æŒ‡æ•¸è¡°æ¸›
  }
}
```

### æå¤±è¿½è¹¤å™¨

```typescript
/**
 * è³‡è¨Šæå¤±è¿½è¹¤å™¨
 */
class LossTracker {
  private losses: Loss[] = [];

  /**
   * è¨˜éŒ„æå¤±
   */
  recordLoss(loss: Loss): void {
    this.losses.push({
      ...loss,
      timestamp: Date.now()
    });
  }

  /**
   * ç”Ÿæˆæå¤±å ±å‘Š
   */
  generateReport(): LossReport {
    return {
      totalLosses: this.losses.length,
      byType: this.groupByType(this.losses),
      bySeverity: this.groupBySeverity(this.losses),
      recoverable: this.losses.filter(l => l.recoverable),
      critical: this.losses.filter(l => l.severity === 'critical')
    };
  }

  /**
   * æª¢æŸ¥æ˜¯å¦å¯æ¥å—
   */
  isAcceptable(options: LossOptions): boolean {
    const critical = this.losses.filter(
      l => l.severity === 'critical'
    );

    if (critical.length > 0 && !options.allowCritical) {
      return false;
    }

    const totalLossRate = this.calculateTotalLossRate();
    return totalLossRate <= options.maxLossRate;
  }
}
```

### è½‰æ›è­¦å‘Šç³»çµ±

```typescript
/**
 * è­¦å‘Šä½¿ç”¨è€…è³‡è¨Šæå¤±
 */
class WarningSystem {
  /**
   * é¡¯ç¤ºè½‰æ›å‰è­¦å‘Š
   */
  async showTransformWarnings(
    transformation: Transformation,
    input: FormData
  ): Promise<boolean> {
    const warnings = transformation.getWarnings(input);

    if (warnings.length === 0) {
      return true;  // ç„¡è­¦å‘Šï¼Œç¹¼çºŒ
    }

    // åˆ†é¡è­¦å‘Š
    const critical = warnings.filter(w => w.severity === 'critical');
    const warnings = warnings.filter(w => w.severity === 'warning');
    const info = warnings.filter(w => w.severity === 'info');

    // é¡¯ç¤ºè­¦å‘Šå°è©±æ¡†
    const message = this.formatWarnings({critical, warnings, info});

    // è©¢å•ä½¿ç”¨è€…æ˜¯å¦ç¹¼çºŒ
    return await this.askUserConfirmation(message);
  }

  /**
   * æ ¼å¼åŒ–è­¦å‘Šè¨Šæ¯
   */
  formatWarnings(categorized: CategorizedWarnings): string {
    let message = 'âš ï¸  è½‰æ›è­¦å‘Š\n\n';

    if (categorized.critical.length > 0) {
      message += 'ğŸ”´ **é—œéµæå¤±**ï¼ˆç„¡æ³•è½‰æ›ï¼‰:\n';
      categorized.critical.forEach(w => {
        message += `  - ${w.feature}: ${w.message}\n`;
      });
      message += '\n';
    }

    if (categorized.warnings.length > 0) {
      message += 'ğŸŸ¡ **è­¦å‘Š**ï¼ˆå¯èƒ½éºå¤±è³‡è¨Šï¼‰:\n';
      categorized.warnings.forEach(w => {
        message += `  - ${w.feature}: ${w.message}\n`;
      });
      message += '\n';
    }

    if (categorized.info.length > 0) {
      message += 'â„¹ï¸  **è³‡è¨Š**ï¼ˆç´°ç¯€éºå¤±ï¼‰:\n';
      categorized.info.forEach(w => {
        message += `  - ${w.feature}: ${w.message}\n`;
      });
    }

    return message;
  }
}
```

### æ”¶æ–‚æ€§åˆ†æ

```typescript
/**
 * åˆ†æè½‰æ›çš„æ”¶æ–‚æ€§
 */
class ConvergenceAnalyzer {
  /**
   * åŸ·è¡Œå¤šæ¬¡è¿­ä»£è½‰æ›ï¼Œè§€å¯Ÿæ”¶æ–‚
   */
  async analyzeConvergence(
    initialCode: string,
    transformSequence: Transformation[],
    iterations: number = 10
  ): Promise<ConvergenceReport> {
    const states = [initialCode];
    const similarities = [];

    let current = initialCode;

    for (let i = 0; i < iterations; i++) {
      // åŸ·è¡Œä¸€è¼ªè½‰æ›åºåˆ—
      for (const transform of transformSequence) {
        current = await transform.execute(current);
      }

      states.push(current);

      // è¨ˆç®—èˆ‡å‰ä¸€ç‹€æ…‹çš„ç›¸ä¼¼åº¦
      const similarity = this.calculateSimilarity(
        states[states.length - 2],
        current
      );

      similarities.push(similarity);

      // æª¢æŸ¥æ˜¯å¦æ”¶æ–‚
      if (similarity > 0.99) {
        return {
          converged: true,
          iterations: i + 1,
          finalState: current,
          similarities: similarities
        };
      }
    }

    return {
      converged: false,
      iterations: iterations,
      finalState: current,
      similarities: similarities
    };
  }

  /**
   * è¨ˆç®—å…©å€‹ç¨‹å¼çš„ç›¸ä¼¼åº¦
   */
  calculateSimilarity(code1: string, code2: string): number {
    // ä½¿ç”¨å¤šç¨®æŒ‡æ¨™
    const astSimilarity = this.compareAST(code1, code2);
    const textSimilarity = this.compareText(code1, code2);
    const semanticSimilarity = this.compareSemantic(code1, code2);

    // åŠ æ¬Šå¹³å‡
    return (
      astSimilarity * 0.5 +
      textSimilarity * 0.2 +
      semanticSimilarity * 0.3
    );
  }
}
```

---

## Transformation Assistant

> **æ¦‚å¿µä¾†æº**ï¼šå—ã€Œä¼´ä¾¶è›‹ç™½ï¼ˆChaperone Proteinï¼‰ã€å•Ÿç™¼â€”â€”ç•¶è›‹ç™½è³ªæŠ˜ç–Šéç¨‹è¤‡é›œæ™‚ï¼Œéœ€è¦è¼”åŠ©è›‹ç™½å¼•å°æ­£ç¢ºæŠ˜ç–Šã€‚åŒç†ï¼Œç•¶ç¨‹å¼å½¢æ…‹è½‰æ›éæ–¼è¤‡é›œæ™‚ï¼Œéœ€è¦ Transformation Assistant è¼”åŠ©ä½¿ç”¨è€…å®Œæˆè½‰æ›ã€‚

### è¨­è¨ˆå‹•æ©Ÿ

åœ¨å¤šå½¢æ…‹è½‰æ›ç³»çµ±ä¸­ï¼Œä¸¦éæ‰€æœ‰è½‰æ›éƒ½èƒ½å®Œå…¨è‡ªå‹•åŒ–ã€‚ä»¥ä¸‹æƒ…æ³éœ€è¦**äº’å‹•å¼è¼”åŠ©**ï¼š

#### éœ€è¦è¼”åŠ©çš„å…¸å‹å ´æ™¯

**1. èªç¾©æ¨¡ç³Šè½‰æ›**
```c
// C ç¨‹å¼ç¢¼
int* ptr = malloc(sizeof(int) * 10);
// ... ä½¿ç”¨ ptr
free(ptr);
```

è½‰æ›è‡³ Python æ™‚é¢è‡¨é¸æ“‡ï¼š
- é¸é … Aï¼š`ptr = [0] * 10`ï¼ˆä½¿ç”¨ listï¼‰
- é¸é … Bï¼š`ptr = array.array('i', [0] * 10)`ï¼ˆä½¿ç”¨ arrayï¼‰
- é¸é … Cï¼š`ptr = np.zeros(10, dtype=int)`ï¼ˆä½¿ç”¨ NumPyï¼‰

**ç³»çµ±ç„¡æ³•è‡ªå‹•æ±ºå®š**ï¼Œéœ€è¦ä½¿ç”¨è€…æ ¹æ“š**ä½¿ç”¨æƒ…å¢ƒ**é¸æ“‡ã€‚

**2. è·¨èªè¨€æ¦‚å¿µæ˜ å°„**
```c
// C çš„æŒ‡æ¨™é‹ç®—
int arr[5] = {1, 2, 3, 4, 5};
int* p = arr + 2;  // æŒ‡å‘ arr[2]
printf("%d", *p);  // è¼¸å‡º 3
```

è½‰æ›è‡³ Python æ™‚ï¼š
- ç›´è­¯ï¼š`p = id(arr) + 2 * sys.getsizeof(int)` âŒ **éŒ¯èª¤ä¸”å±éšª**
- èªç¾©è½‰æ›ï¼š`p = 2; print(arr[p])` âœ… **æ­£ç¢ºä½†å¤±å»æŒ‡æ¨™æ¦‚å¿µ**
- è§£é‡‹è½‰æ›ï¼šåŠ å…¥è¨»è§£èªªæ˜ âœ… **æ•™å­¸å‹å–„**

**3. ä¸€å°å¤šæ˜ å°„**

æŸäº› C èªè¨€æ¨¡å¼å¯æ˜ å°„åˆ°å¤šç¨® Python å¯¦ç¾ï¼š

| C æ¨¡å¼ | Python é¸é … | é©ç”¨å ´æ™¯ |
|--------|-------------|---------|
| `for(int i=0; i<n; i++)` | `for i in range(n)` | ä¸€èˆ¬æƒ…æ³ |
| | `for i, val in enumerate(lst)` | éœ€è¦åŒæ™‚å–å¾—ç´¢å¼•å’Œå€¼ |
| | `[f(i) for i in range(n)]` | List comprehension |
| | `map(f, range(n))` | å‡½æ•¸å¼é¢¨æ ¼ |

**4. çµæ§‹æå¤±èˆ‡é‡æ§‹**

```c
// C ç¨‹å¼ç¢¼ï¼šä½¿ç”¨ goto å¯¦ç¾ç‹€æ…‹æ©Ÿ
int state = 0;
loop:
    switch(state) {
        case 0: /* ... */ state = 1; goto loop;
        case 1: /* ... */ state = 2; goto loop;
        case 2: /* ... */ break;
    }
```

Python æ²’æœ‰ `goto`ï¼Œéœ€è¦é‡æ§‹ç‚ºï¼š
- é¸é … Aï¼šwhile + switch æ¨¡æ“¬
- é¸é … Bï¼šç‹€æ…‹æ©Ÿé¡åˆ¥
- é¸é … Cï¼šä¿ç•™è¨»è§£èªªæ˜åŸå§‹é‚è¼¯

---

### åŠ©æ‰‹è§’è‰²å®šä½

```typescript
/**
 * Transformation Assistant çš„è§’è‰²
 */
interface TransformationAssistant {
  /**
   * è§’è‰²ä¸€ï¼šæ±ºç­–å»ºè­°è€…
   * ç•¶ç³»çµ±é‡åˆ°ä¸ç¢ºå®šçš„è½‰æ›é¸æ“‡æ™‚ï¼Œæä¾›å»ºè­°
   */
  suggestOptions(context: TransformContext): TransformOption[];

  /**
   * è§’è‰²äºŒï¼šè½‰æ›é©—è­‰è€…
   * é©—è­‰ä½¿ç”¨è€…é¸æ“‡çš„è½‰æ›æ˜¯å¦èªç¾©æ­£ç¢º
   */
  validateTransform(
    source: FormData,
    target: FormData,
    userChoice: TransformOption
  ): ValidationResult;

  /**
   * è§’è‰²ä¸‰ï¼šçŸ¥è­˜æä¾›è€…
   * æä¾›è½‰æ›ç›¸é—œçš„æ•™å­¸è³‡è¨Š
   */
  explainTransform(
    source: FormData,
    target: FormData,
    option: TransformOption
  ): Explanation;

  /**
   * è§’è‰²å››ï¼šå­¸ç¿’è¨˜éŒ„è€…
   * è¨˜ä½ä½¿ç”¨è€…çš„é¸æ“‡åå¥½ï¼Œæ¸›å°‘æœªä¾†è©¢å•
   */
  learnPreference(
    context: TransformContext,
    userChoice: TransformOption
  ): void;
}
```

---

### äº’å‹•æµç¨‹è¨­è¨ˆ

#### åŸºæœ¬äº’å‹•æµç¨‹

```
ä½¿ç”¨è€…ç™¼èµ·è½‰æ›ï¼ˆä¾‹ï¼šC â†’ Pythonï¼‰
       â†“
ç³»çµ±å˜—è©¦è‡ªå‹•è½‰æ›
       â†“
  é‡åˆ°æ¨¡ç³Šæƒ…æ³ â”€â”€â”
       â†“          â”‚
 ä¿¡å¿ƒåº¦è©•ä¼°      â”‚ ä¿¡å¿ƒåº¦ â‰¥ 0.9
       â†“          â”‚ ç›´æ¥è½‰æ›
 ä¿¡å¿ƒåº¦ < 0.9 â†â”€â”€â”˜
       â†“
å•Ÿå‹• Assistant
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±•ç¤ºè½‰æ›é¸é …    â”‚
â”‚ - é¸é … A (æ¨è–¦) â”‚
â”‚ - é¸é … B        â”‚
â”‚ - é¸é … C        â”‚
â”‚ [æŸ¥çœ‹èªªæ˜]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
ä½¿ç”¨è€…é¸æ“‡
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é©—è­‰é¸æ“‡        â”‚
â”‚ - èªæ³•æª¢æŸ¥      â”‚
â”‚ - èªç¾©æª¢æŸ¥      â”‚
â”‚ - é¢¨æ ¼ä¸€è‡´æ€§    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
  é©—è­‰é€šéï¼Ÿ
   /        \
 å¦          æ˜¯
  â†“          â†“
é¡¯ç¤ºéŒ¯èª¤   è¨˜éŒ„åå¥½
  â†“          â†“
é‡æ–°é¸æ“‡   å®Œæˆè½‰æ›
```

#### ä¿¡å¿ƒåº¦è¨ˆç®—

```typescript
interface ConfidenceScore {
  syntaxConfidence: number;      // èªæ³•å±¤é¢ä¿¡å¿ƒåº¦ (0-1)
  semanticConfidence: number;    // èªç¾©å±¤é¢ä¿¡å¿ƒåº¦ (0-1)
  patternConfidence: number;     // æ¨¡å¼åŒ¹é…ä¿¡å¿ƒåº¦ (0-1)
  historyConfidence: number;     // æ­·å²é¸æ“‡ä¿¡å¿ƒåº¦ (0-1)
}

class ConfidenceCalculator {
  calculate(context: TransformContext): number {
    const scores = {
      syntaxConfidence: this.calculateSyntaxConfidence(context),
      semanticConfidence: this.calculateSemanticConfidence(context),
      patternConfidence: this.calculatePatternConfidence(context),
      historyConfidence: this.calculateHistoryConfidence(context)
    };

    // åŠ æ¬Šè¨ˆç®—ç¸½ä¿¡å¿ƒåº¦
    return (
      scores.syntaxConfidence * 0.2 +
      scores.semanticConfidence * 0.4 +
      scores.patternConfidence * 0.3 +
      scores.historyConfidence * 0.1
    );
  }

  /**
   * èªæ³•ä¿¡å¿ƒåº¦ï¼šèªæ³•æ¨¹æ˜¯å¦å®Œæ•´åŒ¹é…
   */
  calculateSyntaxConfidence(context: TransformContext): number {
    const { sourceAST, targetPattern } = context;
    return this.astMatcher.match(sourceAST, targetPattern).score;
  }

  /**
   * èªç¾©ä¿¡å¿ƒåº¦ï¼šèªç¾©ç­‰åƒ¹æ€§
   */
  calculateSemanticConfidence(context: TransformContext): number {
    const { sourceSemantics, targetSemantics } = context;
    return this.semanticAnalyzer.compareSemantics(
      sourceSemantics,
      targetSemantics
    );
  }

  /**
   * æ¨¡å¼ä¿¡å¿ƒåº¦ï¼šå·²çŸ¥æ¨¡å¼åŒ¹é…ç¨‹åº¦
   */
  calculatePatternConfidence(context: TransformContext): number {
    const knownPatterns = this.patternLibrary.findMatches(context.source);
    return knownPatterns.length > 0 ? knownPatterns[0].confidence : 0;
  }

  /**
   * æ­·å²ä¿¡å¿ƒåº¦ï¼šä½¿ç”¨è€…éå»çš„é¸æ“‡å‚¾å‘
   */
  calculateHistoryConfidence(context: TransformContext): number {
    const history = this.preferenceStore.getHistory(context.pattern);
    if (history.length === 0) return 0;

    // è¨ˆç®—ä¸€è‡´æ€§
    const mostFrequent = this.findMostFrequent(history);
    return mostFrequent.frequency / history.length;
  }
}
```

---

### è½‰æ›é¸é …ç”Ÿæˆ

```typescript
/**
 * è½‰æ›é¸é …ç”Ÿæˆå™¨
 */
class TransformOptionGenerator {
  /**
   * ç”Ÿæˆè½‰æ›é¸é …
   */
  generateOptions(
    source: CodeSnippet,
    targetLang: string,
    context: TransformContext
  ): TransformOption[] {
    // 1. å¾å·²çŸ¥æ¨¡å¼åº«ç”Ÿæˆé¸é …
    const patternOptions = this.generateFromPatterns(source, targetLang);

    // 2. å¾è½‰æ›è¦å‰‡ç”Ÿæˆé¸é …
    const ruleOptions = this.generateFromRules(source, targetLang);

    // 3. åˆä½µä¸¦æ’åº
    const allOptions = [...patternOptions, ...ruleOptions];

    // 4. è©•åˆ†æ’åº
    return this.rankOptions(allOptions, context);
  }

  /**
   * å¾æ¨¡å¼åº«ç”Ÿæˆé¸é …
   */
  private generateFromPatterns(
    source: CodeSnippet,
    targetLang: string
  ): TransformOption[] {
    const options: TransformOption[] = [];

    // æŸ¥æ‰¾åŒ¹é…çš„è½‰æ›æ¨¡å¼
    const patterns = this.patternLibrary.findMatches(source);

    for (const pattern of patterns) {
      const variants = pattern.getVariants(targetLang);

      for (const variant of variants) {
        options.push({
          id: generateId(),
          name: variant.name,
          description: variant.description,
          targetCode: variant.generate(source),
          confidence: variant.confidence,
          pros: variant.advantages,
          cons: variant.disadvantages,
          useCases: variant.useCases,
          tags: variant.tags
        });
      }
    }

    return options;
  }

  /**
   * é¸é …æ’åº
   */
  private rankOptions(
    options: TransformOption[],
    context: TransformContext
  ): TransformOption[] {
    return options
      .map(option => ({
        option,
        score: this.scoreOption(option, context)
      }))
      .sort((a, b) => b.score - a.score)
      .map(item => item.option);
  }

  /**
   * é¸é …è©•åˆ†
   */
  private scoreOption(
    option: TransformOption,
    context: TransformContext
  ): number {
    let score = option.confidence;

    // è€ƒæ…®ä½¿ç”¨è€…æ­·å²åå¥½
    const preference = this.preferenceStore.getPreference(
      context.pattern,
      option.id
    );
    if (preference) {
      score += preference.weight * 0.3;
    }

    // è€ƒæ…®æƒ…å¢ƒé©ç”¨åº¦
    const contextFit = this.evaluateContextFit(option, context);
    score += contextFit * 0.2;

    return score;
  }
}
```

#### è½‰æ›é¸é …è³‡æ–™çµæ§‹

```typescript
interface TransformOption {
  id: string;
  name: string;                    // é¸é …åç¨±
  description: string;             // ç°¡çŸ­æè¿°
  targetCode: string;              // è½‰æ›å¾Œçš„ç¨‹å¼ç¢¼
  confidence: number;              // ç³»çµ±ä¿¡å¿ƒåº¦ (0-1)

  // é¸é …è©•ä¼°
  pros: string[];                  // å„ªé»
  cons: string[];                  // ç¼ºé»
  useCases: string[];              // é©ç”¨å ´æ™¯
  tags: string[];                  // æ¨™ç±¤ï¼ˆå¦‚ "pythonic", "performance"ï¼‰

  // è½‰æ›è³‡è¨Š
  informationLoss: InformationLoss;  // è³‡è¨Šæå¤±åˆ†æ
  complexity: 'simple' | 'moderate' | 'complex';  // è¤‡é›œåº¦

  // å­¸ç¿’è¼”åŠ©
  explanation?: string;            // è©³ç´°èªªæ˜
  references?: Reference[];        // åƒè€ƒè³‡æ–™é€£çµ
}
```

---

### UI è¨­è¨ˆ

#### åŠ©æ‰‹é¢æ¿è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Transformation Assistant                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ åµæ¸¬åˆ°è¤‡é›œè½‰æ›ï¼šC æŒ‡æ¨™ â†’ Python            â”‚
â”‚                                             â”‚
â”‚ åŸå§‹ç¨‹å¼ç¢¼ï¼š                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ int* ptr = malloc(sizeof(int) * 10);â”‚   â”‚
â”‚ â”‚ free(ptr);                          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚ è«‹é¸æ“‡è½‰æ›æ–¹å¼ï¼š                            â”‚
â”‚                                             â”‚
â”‚ â— é¸é … A (æ¨è–¦) ä¿¡å¿ƒåº¦: 85%                â”‚
â”‚   ä½¿ç”¨ Python list                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ ptr = [0] * 10                      â”‚ â”‚
â”‚   â”‚ # è‡ªå‹•è¨˜æ†¶é«”ç®¡ç†ï¼Œç„¡éœ€æ‰‹å‹•é‡‹æ”¾          â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   âœ… ç°¡å–®ç›´è§€                               â”‚
â”‚   âœ… Python æ…£ç”¨å¯«æ³•                        â”‚
â”‚   âš ï¸  æ•ˆèƒ½ç•¥ä½æ–¼ array                      â”‚
â”‚                                             â”‚
â”‚ â—‹ é¸é … B ä¿¡å¿ƒåº¦: 65%                       â”‚
â”‚   ä½¿ç”¨ array æ¨¡çµ„                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ import array                        â”‚ â”‚
â”‚   â”‚ ptr = array.array('i', [0] * 10)   â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   âœ… æ•ˆèƒ½è¼ƒå¥½                               â”‚
â”‚   âœ… å‹åˆ¥å›ºå®š                               â”‚
â”‚   âš ï¸  éœ€è¦é¡å¤– import                       â”‚
â”‚                                             â”‚
â”‚ â—‹ é¸é … C ä¿¡å¿ƒåº¦: 70%                       â”‚
â”‚   ä½¿ç”¨ NumPy                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ import numpy as np                  â”‚ â”‚
â”‚   â”‚ ptr = np.zeros(10, dtype=int)      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   âœ… ç§‘å­¸è¨ˆç®—æ¨™æº–                           â”‚
â”‚   âœ… åŠŸèƒ½å¼·å¤§                               â”‚
â”‚   âš ï¸  éœ€è¦å®‰è£ NumPy                        â”‚
â”‚                                             â”‚
â”‚ [ æŸ¥çœ‹è©³ç´°èªªæ˜ ]  [ è¨˜ä½æˆ‘çš„é¸æ“‡ ]         â”‚
â”‚                                             â”‚
â”‚ [ å–æ¶ˆ ]  [ ç¢ºå®š ]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ¼¸é€²å¼æ­éœ²è¨­è¨ˆ

å°æ–¼**åˆå­¸è€…**ï¼Œé è¨­é¡¯ç¤ºï¼š
- âœ… æ¨è–¦é¸é …ï¼ˆå·²æ¨™è¨˜ï¼‰
- âœ… è½‰æ›çµæœç¨‹å¼ç¢¼
- âœ… ç°¡è¦å„ªç¼ºé»

é»æ“Šã€ŒæŸ¥çœ‹è©³ç´°èªªæ˜ã€å¾Œå±•é–‹ï¼š
- ğŸ“Š ä¿¡å¿ƒåº¦åˆ†æ
- ğŸ”¬ èªç¾©å·®ç•°èªªæ˜
- ğŸ“š ç›¸é—œæ•™å­¸è³‡æºé€£çµ
- ğŸ§ª æ¸¬è©¦æ¡ˆä¾‹å°æ¯”

å°æ–¼**é€²éšä½¿ç”¨è€…**ï¼ˆå¯åœ¨è¨­å®šä¸­èª¿æ•´ï¼‰ï¼š
- é è¨­å±•é–‹æ‰€æœ‰è³‡è¨Š
- é¡¯ç¤ºè½‰æ›è¦å‰‡ç´°ç¯€
- æä¾›æ‰‹å‹•ç·¨è¼¯é¸é …ç¨‹å¼ç¢¼

---

### åå¥½å­¸ç¿’ç³»çµ±

#### åå¥½å„²å­˜çµæ§‹

```typescript
interface UserPreference {
  userId: string;
  pattern: string;              // è½‰æ›æ¨¡å¼è­˜åˆ¥ç¢¼
  sourceLanguage: string;
  targetLanguage: string;

  // åå¥½é¸é …
  preferredOptionId: string;
  confidence: number;           // åå¥½ä¿¡å¿ƒåº¦ (0-1)

  // ä½¿ç”¨æƒ…å¢ƒ
  context: {
    projectType?: string;       // å°ˆæ¡ˆé¡å‹
    codeStyle?: string;         // ç¨‹å¼ç¢¼é¢¨æ ¼
    performancePriority?: boolean;  // æ˜¯å¦å„ªå…ˆè€ƒæ…®æ•ˆèƒ½
  };

  // çµ±è¨ˆè³‡è¨Š
  useCount: number;             // ä½¿ç”¨æ¬¡æ•¸
  lastUsed: Date;
  createdAt: Date;
}
```

#### åå¥½å­¸ç¿’é‚è¼¯

```typescript
class PreferenceLearner {
  /**
   * è¨˜éŒ„ä½¿ç”¨è€…é¸æ“‡
   */
  recordChoice(
    pattern: string,
    option: TransformOption,
    context: TransformContext
  ): void {
    const existing = this.preferenceStore.get(pattern);

    if (!existing) {
      // é¦–æ¬¡é¸æ“‡ï¼šå»ºç«‹æ–°åå¥½
      this.preferenceStore.set(pattern, {
        pattern,
        preferredOptionId: option.id,
        confidence: 0.6,  // åˆå§‹ä¿¡å¿ƒåº¦
        useCount: 1,
        lastUsed: new Date(),
        createdAt: new Date(),
        context: this.extractContext(context)
      });
    } else {
      // æ›´æ–°ç¾æœ‰åå¥½
      if (existing.preferredOptionId === option.id) {
        // é¸æ“‡ä¸€è‡´ï¼šå¢åŠ ä¿¡å¿ƒåº¦
        existing.confidence = Math.min(1.0, existing.confidence + 0.1);
        existing.useCount++;
      } else {
        // é¸æ“‡ä¸ä¸€è‡´ï¼šæª¢æŸ¥æ˜¯å¦æƒ…å¢ƒä¸åŒ
        if (this.isContextSimilar(existing.context, context)) {
          // æƒ…å¢ƒç›¸ä¼¼ä½†é¸æ“‡ä¸åŒï¼šé™ä½ä¿¡å¿ƒåº¦
          existing.confidence *= 0.8;
        } else {
          // æƒ…å¢ƒä¸åŒï¼šå»ºç«‹æ–°çš„æƒ…å¢ƒåŒ–åå¥½
          this.createContextualPreference(pattern, option, context);
        }
      }
      existing.lastUsed = new Date();
    }
  }

  /**
   * å–å¾—æ¨è–¦é¸é …
   */
  getRecommendation(
    pattern: string,
    context: TransformContext
  ): TransformOption | null {
    const preferences = this.preferenceStore.getAll(pattern);

    // æ‰¾æœ€åŒ¹é…çš„æƒ…å¢ƒåå¥½
    const matchedPref = preferences
      .filter(pref => this.isContextSimilar(pref.context, context))
      .sort((a, b) => {
        // å„ªå…ˆè€ƒæ…®ä¿¡å¿ƒåº¦å’Œä½¿ç”¨æ¬¡æ•¸
        const scoreA = a.confidence * 0.7 + (a.useCount / 100) * 0.3;
        const scoreB = b.confidence * 0.7 + (b.useCount / 100) * 0.3;
        return scoreB - scoreA;
      })[0];

    return matchedPref ? this.getOptionById(matchedPref.preferredOptionId) : null;
  }

  /**
   * æƒ…å¢ƒç›¸ä¼¼åº¦åˆ¤æ–·
   */
  private isContextSimilar(
    ctx1: TransformContext,
    ctx2: TransformContext
  ): boolean {
    // ç°¡å–®çš„ç›¸ä¼¼åº¦åˆ¤æ–·
    return (
      ctx1.projectType === ctx2.projectType &&
      ctx1.codeStyle === ctx2.codeStyle &&
      ctx1.performancePriority === ctx2.performancePriority
    );
  }
}
```

---

### é©—è­‰ç³»çµ±

```typescript
/**
 * è½‰æ›é©—è­‰å™¨
 */
class TransformValidator {
  /**
   * é©—è­‰è½‰æ›çµæœ
   */
  validate(
    source: CodeSnippet,
    target: CodeSnippet,
    option: TransformOption
  ): ValidationResult {
    const errors: ValidationError[] = [];
    const warnings: ValidationWarning[] = [];

    // 1. èªæ³•é©—è­‰
    const syntaxResult = this.validateSyntax(target);
    errors.push(...syntaxResult.errors);
    warnings.push(...syntaxResult.warnings);

    // 2. èªç¾©é©—è­‰
    const semanticResult = this.validateSemantics(source, target);
    errors.push(...semanticResult.errors);
    warnings.push(...semanticResult.warnings);

    // 3. é¢¨æ ¼é©—è­‰
    const styleResult = this.validateStyle(target);
    warnings.push(...styleResult.warnings);

    return {
      valid: errors.length === 0,
      errors,
      warnings
    };
  }

  /**
   * èªæ³•é©—è­‰
   */
  private validateSyntax(code: CodeSnippet): ValidationResult {
    try {
      const ast = this.parser.parse(code.content, code.language);
      return { valid: true, errors: [], warnings: [] };
    } catch (e) {
      return {
        valid: false,
        errors: [{
          type: 'syntax',
          message: e.message,
          location: e.location
        }],
        warnings: []
      };
    }
  }

  /**
   * èªç¾©é©—è­‰ï¼ˆåŸºæœ¬æª¢æŸ¥ï¼‰
   */
  private validateSemantics(
    source: CodeSnippet,
    target: CodeSnippet
  ): ValidationResult {
    const warnings: ValidationWarning[] = [];

    // æª¢æŸ¥è®Šæ•¸åç¨±æ˜¯å¦ä¿æŒä¸€è‡´
    const sourceVars = this.extractVariables(source);
    const targetVars = this.extractVariables(target);

    for (const varName of sourceVars) {
      if (!targetVars.includes(varName)) {
        warnings.push({
          type: 'semantic',
          message: `è®Šæ•¸ '${varName}' åœ¨è½‰æ›å¾Œæ¶ˆå¤±`,
          severity: 'medium'
        });
      }
    }

    // æª¢æŸ¥æ§åˆ¶æµçµæ§‹
    const sourceStructures = this.extractControlStructures(source);
    const targetStructures = this.extractControlStructures(target);

    if (sourceStructures.length !== targetStructures.length) {
      warnings.push({
        type: 'semantic',
        message: 'æ§åˆ¶æµçµæ§‹æ•¸é‡æ”¹è®Šï¼Œè«‹ç¢ºèªé‚è¼¯æ­£ç¢º',
        severity: 'high'
      });
    }

    return {
      valid: true,
      errors: [],
      warnings
    };
  }
}
```

---

### çŸ¥è­˜åº«è¨­è¨ˆ

#### è½‰æ›æ¨¡å¼åº«

```json
{
  "patterns": [
    {
      "id": "c-malloc-to-python",
      "name": "C malloc è½‰ Python",
      "sourcePattern": {
        "language": "c",
        "astPattern": {
          "type": "VariableDeclaration",
          "init": {
            "type": "CallExpression",
            "callee": { "name": "malloc" }
          }
        }
      },
      "targetVariants": [
        {
          "language": "python",
          "variantId": "list",
          "name": "ä½¿ç”¨ list",
          "confidence": 0.85,
          "template": "{{varName}} = [{{initValue}}] * {{size}}",
          "advantages": ["ç°¡å–®", "Python æ…£ç”¨"],
          "disadvantages": ["æ•ˆèƒ½ç•¥ä½"],
          "useCases": ["ä¸€èˆ¬ç”¨é€”", "åˆå­¸è€…"],
          "tags": ["pythonic", "beginner-friendly"]
        },
        {
          "language": "python",
          "variantId": "array",
          "name": "ä½¿ç”¨ array",
          "confidence": 0.65,
          "template": "import array\n{{varName}} = array.array('{{type}}', [{{initValue}}] * {{size}})",
          "advantages": ["æ•ˆèƒ½è¼ƒå¥½", "å‹åˆ¥å›ºå®š"],
          "disadvantages": ["éœ€è¦ import"],
          "useCases": ["æ•ˆèƒ½æ•æ„Ÿ", "å¤§é‡æ•¸å€¼é‹ç®—"],
          "tags": ["performance"]
        },
        {
          "language": "python",
          "variantId": "numpy",
          "name": "ä½¿ç”¨ NumPy",
          "confidence": 0.70,
          "template": "import numpy as np\n{{varName}} = np.zeros({{size}}, dtype={{type}})",
          "advantages": ["ç§‘å­¸è¨ˆç®—æ¨™æº–", "åŠŸèƒ½å¼·å¤§"],
          "disadvantages": ["éœ€è¦å®‰è£ NumPy"],
          "useCases": ["ç§‘å­¸è¨ˆç®—", "æ•¸æ“šåˆ†æ"],
          "tags": ["scientific", "data-science"]
        }
      ]
    },
    {
      "id": "c-for-loop-to-python",
      "name": "C for è¿´åœˆè½‰ Python",
      "sourcePattern": {
        "language": "c",
        "astPattern": {
          "type": "ForStatement",
          "init": { "type": "VariableDeclaration" },
          "test": { "type": "BinaryExpression", "operator": "<" },
          "update": { "type": "UpdateExpression", "operator": "++" }
        }
      },
      "targetVariants": [
        {
          "language": "python",
          "variantId": "range",
          "name": "ä½¿ç”¨ range()",
          "confidence": 0.9,
          "template": "for {{var}} in range({{start}}, {{end}}):\n    {{body}}",
          "advantages": ["ç°¡æ½”", "Pythonic"],
          "disadvantages": [],
          "useCases": ["ä¸€èˆ¬è¿´åœˆ"],
          "tags": ["pythonic"]
        },
        {
          "language": "python",
          "variantId": "enumerate",
          "name": "ä½¿ç”¨ enumerate()",
          "confidence": 0.75,
          "template": "for {{var}}, {{value}} in enumerate({{iterable}}):\n    {{body}}",
          "advantages": ["åŒæ™‚å–å¾—ç´¢å¼•å’Œå€¼"],
          "disadvantages": ["éœ€è¦å¯è¿­ä»£ç‰©ä»¶"],
          "useCases": ["éæ­· list ä¸”éœ€è¦ç´¢å¼•"],
          "tags": ["pythonic"]
        },
        {
          "language": "python",
          "variantId": "comprehension",
          "name": "List Comprehension",
          "confidence": 0.8,
          "template": "[{{expression}} for {{var}} in range({{start}}, {{end}})]",
          "advantages": ["ç°¡æ½”", "æ•ˆèƒ½å¥½"],
          "disadvantages": ["åƒ…é©ç”¨æ–¼ç”Ÿæˆ list"],
          "useCases": ["å»ºç«‹æ–° list"],
          "tags": ["pythonic", "functional"]
        }
      ]
    }
  ]
}
```

---

### èˆ‡å…¶ä»–ç³»çµ±çš„æ•´åˆ

```typescript
/**
 * Assistant èˆ‡è½‰æ›å¼•æ“çš„æ•´åˆ
 */
class IntegratedTransformationEngine {
  private engine: PolyglotTransformationEngine;
  private assistant: TransformationAssistant;

  async transform(
    input: FormData,
    targetForm: FormType,
    options: TransformOptions
  ): Promise<TransformResult> {
    // 1. å˜—è©¦è‡ªå‹•è½‰æ›
    const result = await this.engine.transform(input, targetForm, {
      ...options,
      returnConfidence: true
    });

    // 2. æª¢æŸ¥ä¿¡å¿ƒåº¦
    if (result.confidence < 0.9 && !options.autoAccept) {
      // ä¿¡å¿ƒåº¦ä¸è¶³ï¼Œå•Ÿå‹•åŠ©æ‰‹
      const assistedResult = await this.assistant.assist({
        source: input,
        target: result.output,
        options: result.options,
        confidence: result.confidence,
        context: this.buildContext(input, targetForm)
      });

      return assistedResult;
    }

    // 3. ä¿¡å¿ƒåº¦è¶³å¤ ï¼Œç›´æ¥è¿”å›
    return result;
  }
}
```

---

### å¾…è¨è«–å•é¡Œ

1. **åŠ©æ‰‹è§¸ç™¼æ™‚æ©Ÿ**
   - ä¿¡å¿ƒåº¦é–¾å€¼è¨­å®šç‚º 0.9 æ˜¯å¦åˆé©ï¼Ÿ
   - æ˜¯å¦æä¾›ã€Œç¸½æ˜¯è©¢å•ã€æˆ–ã€Œå¾ä¸è©¢å•ã€çš„è¨­å®šé¸é …ï¼Ÿ

2. **åå¥½å­¸ç¿’ç¯„åœ**
   - åå¥½æ˜¯å…¨å±€çš„é‚„æ˜¯æ¯å€‹å°ˆæ¡ˆç¨ç«‹ï¼Ÿ
   - æ˜¯å¦éœ€è¦æ”¯æ´åŒ¯å…¥/åŒ¯å‡ºåå¥½è¨­å®šï¼Ÿ

3. **é¸é …æ•¸é‡ä¸Šé™**
   - æœ€å¤šé¡¯ç¤ºå¹¾å€‹è½‰æ›é¸é …ï¼Ÿï¼ˆå»ºè­° 3-5 å€‹ï¼‰
   - å¦‚ä½•è™•ç†è¶…éä¸Šé™çš„é¸é …ï¼Ÿ

4. **é©—è­‰ç¨‹åº¦**
   - èªç¾©é©—è­‰çš„æ·±åº¦ï¼Ÿï¼ˆç›®å‰åƒ…åŸºæœ¬æª¢æŸ¥ï¼‰
   - æ˜¯å¦éœ€è¦åŸ·è¡Œæ¸¬è©¦ä¾†é©—è­‰ç­‰åƒ¹æ€§ï¼Ÿ

5. **æ•™å­¸æ¨¡å¼**
   - æ˜¯å¦éœ€è¦ã€Œæ•™å­¸æ¨¡å¼ã€ï¼Œè©³ç´°è§£é‡‹æ¯å€‹é¸æ“‡ï¼Ÿ
   - æ˜¯å¦æä¾›ã€Œå¿«é€Ÿæ¨¡å¼ã€ï¼Œåƒ…é¡¯ç¤ºæ¨è–¦é¸é …ï¼Ÿ

---

## è·¨èªè¨€æ”¯æ´

### é€éç©æœ¨çš„èªè¨€äº’è½‰

**æµç¨‹**ï¼š
```
C ç¨‹å¼ç¢¼
   â†“ [parsing + structuring]
é€šç”¨ç©æœ¨è¡¨ç¤º
   â†“ [Python generator]
Python ç¨‹å¼ç¢¼
```

**ç¯„ä¾‹**ï¼š

è¼¸å…¥ (C):
```c
for(int i = 0; i < 10; i++) {
    printf("%d\n", i);
}
```

â†“ çµæ§‹åŒ–

ç©æœ¨è¡¨ç¤º:
```blockly
[universal_for_loop]
  iterator: i
  start: 0
  end: 9
  body:
    [universal_print]
      format: "%d\n"
      values: [i]
```

â†“ Python ç”Ÿæˆ

è¼¸å‡º (Python):
```python
for i in range(0, 10):
    print(i)
```

### èªè¨€ç‰¹æ€§æ˜ å°„è¡¨

#### å¯è½‰æ›ç‰¹æ€§

| ç‰¹æ€§ | C | Python | JavaScript | ç­–ç•¥ |
|------|---|--------|------------|------|
| for è¿´åœˆ | âœ“ | âœ“ | âœ“ | é€šç”¨ç©æœ¨ |
| if-else | âœ“ | âœ“ | âœ“ | é€šç”¨ç©æœ¨ |
| å‡½å¼å®šç¾© | âœ“ | âœ“ | âœ“ | é€šç”¨ç©æœ¨ |
| é™£åˆ—/åˆ—è¡¨ | âœ“ | âœ“ | âœ“ | é€šç”¨ç©æœ¨ |

#### ä¸å¯ç›´æ¥è½‰æ›ç‰¹æ€§

| ç‰¹æ€§ | èªè¨€ | æ›¿ä»£æ–¹æ¡ˆ |
|------|------|----------|
| æŒ‡æ¨™ | C | Python: ç‰©ä»¶å¼•ç”¨<br>JS: ç„¡ç›´æ¥ç­‰åƒ¹ |
| åˆ—è¡¨æ¨å° | Python | C: for è¿´åœˆ<br>JS: map/filter |
| async/await | JS, Python | C: ç„¡ç›´æ¥ç­‰åƒ¹ï¼ˆå¤šåŸ·è¡Œç·’ï¼‰ |
| å·¨é›† | C | Python: è£é£¾å™¨<br>JS: ç„¡ç­‰åƒ¹ |

### è·¨èªè¨€è½‰æ›ç¯„ä¾‹

#### ç¯„ä¾‹ 1: Hello World (C â†’ Python)

**è¼¸å…¥ (C)**:
```c
#include <stdio.h>

int main() {
    printf("Hello, World!\n");
    return 0;
}
```

**è½‰æ›éç¨‹**:
```
1. Parse C code â†’ AST
2. Match pattern â†’ "hello_world_program" template
3. Structure â†’ Universal blocks:
   [program_entry]
     [print] "Hello, World!"
4. Serialize to Python â†’ Python generator
```

**è¼¸å‡º (Python)**:
```python
def main():
    print("Hello, World!")

if __name__ == "__main__":
    main()
```

#### ç¯„ä¾‹ 2: Bubble Sort (C â†’ JavaScript)

**è¼¸å…¥ (C)**:
```c
void bubble_sort(int arr[], int n) {
    for(int i = 0; i < n-1; i++) {
        for(int j = 0; j < n-i-1; j++) {
            if(arr[j] > arr[j+1]) {
                int temp = arr[j];
                arr[j] = arr[j+1];
                arr[j+1] = temp;
            }
        }
    }
}
```

**ç©æœ¨è¡¨ç¤º**:
```blockly
[function] bubble_sort(arr, n)
  [for] i from 0 to n-2
    [for] j from 0 to n-i-2
      [if] arr[j] > arr[j+1]
        [swap] arr[j], arr[j+1]
```

**è¼¸å‡º (JavaScript)**:
```javascript
function bubbleSort(arr) {
    const n = arr.length;
    for(let i = 0; i < n-1; i++) {
        for(let j = 0; j < n-i-1; j++) {
            if(arr[j] > arr[j+1]) {
                [arr[j], arr[j+1]] = [arr[j+1], arr[j]];
            }
        }
    }
}
```

---

## å°æ‡‰é—œä¿‚ç®¡ç†ç³»çµ±

> **æ ¸å¿ƒæŒ‘æˆ°**ï¼šå¦‚ä½•ç¶­è­· Sequence â†” Structure â†” Topology ä¹‹é–“çš„å°æ‡‰é—œä¿‚ï¼Œç¢ºä¿ä¸€è‡´æ€§èˆ‡å¯è¿½æº¯æ€§ï¼Ÿ

### è¨­è¨ˆå‹•æ©Ÿ

åœ¨å¤šå½¢æ…‹ç³»çµ±ä¸­ï¼ŒåŒä¸€ä»½ç¨‹å¼é‚è¼¯å¯ä»¥æœ‰ä¸‰ç¨®è¡¨ç¤ºå½¢å¼ï¼š

```
C ç¨‹å¼ç¢¼ (Sequence)
    â†• å°æ‡‰
é€šç”¨ç©æœ¨ (Structure)
    â†• å°æ‡‰
å‘¼å«åœ– (Topology)
```

**é—œéµå•é¡Œ**ï¼š
1. å¦‚ä½•è¨˜éŒ„é€™äº›å°æ‡‰é—œä¿‚ï¼Ÿ
2. å¦‚ä½•ç¢ºä¿å°æ‡‰é—œä¿‚çš„ä¸€è‡´æ€§ï¼Ÿ
3. ç•¶ä¸€å€‹å½¢æ…‹æ”¹è®Šæ™‚ï¼Œå¦‚ä½•æ›´æ–°å…¶ä»–å½¢æ…‹ï¼Ÿ
4. å¦‚ä½•è™•ç†ä¸€å°å¤šæˆ–å¤šå°ä¸€çš„æ˜ å°„ï¼Ÿ

---

### å°æ‡‰é—œä¿‚é¡å‹

#### 1. Template â†” Block å°æ‡‰

**ä¸€å°ä¸€æ˜ å°„ï¼ˆç†æƒ³æƒ…æ³ï¼‰**

```
templates/high-level/c/basics/hello-world/
  â”œâ”€â”€ meta.json       # çŸ¥è­˜å–®å…ƒå…ƒè³‡æ–™
  â”œâ”€â”€ sequence.c      # Sequence Form
  â”œâ”€â”€ structure.xml   # Structure Form (ä¸€å°ä¸€å°æ‡‰)
  â””â”€â”€ topology.json   # Topology Form
```

**è¨˜éŒ„æ–¹å¼** - åœ¨ meta.json ä¸­è¨˜éŒ„ï¼š
```json
{
  "id": "c-hello-world",
  "name": "Hello World",
  "language": "c",
  "mappings": {
    "structure": {
      "type": "universal",
      "path": "complete-programs/hello-world",
      "confidence": 1.0,
      "bidirectional": true
    }
  }
}
```

**ä¸€å°å¤šæ˜ å°„ï¼ˆå¸¸è¦‹æƒ…æ³ï¼‰**

åŒä¸€å€‹ Sequence Form å¯èƒ½å°æ‡‰å¤šç¨® Structure Form è®Šé«”ï¼š

```
templates/high-level/c/control/for-loop/
  â”œâ”€â”€ meta.json           # è¨˜éŒ„å¤šç¨® Structure è®Šé«”
  â”œâ”€â”€ sequence.c          # Sequence Form (åŒä¸€ä»½ç¨‹å¼ç¢¼)
  â”œâ”€â”€ structure-basic.xml         # Structure è®Šé«” 1: åŸºæœ¬è¿´åœˆ
  â”œâ”€â”€ structure-with-array.xml    # Structure è®Šé«” 2: é™£åˆ—èµ°è¨ª
  â”œâ”€â”€ structure-nested.xml        # Structure è®Šé«” 3: å·¢ç‹€è¿´åœˆ
  â””â”€â”€ topology.json       # Topology Form
```

**è¨˜éŒ„æ–¹å¼** - åœ¨ meta.json ä¸­è¨˜éŒ„ï¼š
```json
{
  "id": "c-for-loop",
  "forms": {
    "sequence": {
      "main": "sequence.c"
    },
    "structure": {
      "variants": [
        {
          "file": "structure-basic.xml",
          "description": "åŸºæœ¬è¿´åœˆ",
          "confidence": 0.9,
          "conditions": ["simple iteration", "no nesting"]
        },
        {
          "file": "structure-with-array.xml",
          "description": "é™£åˆ—èµ°è¨ª",
          "confidence": 0.85,
          "conditions": ["array traversal"]
        },
        {
          "file": "structure-nested.xml",
          "description": "å·¢ç‹€è¿´åœˆ",
          "confidence": 0.7,
          "conditions": ["nested loops"]
        }
      ]
    },
    "topology": {
      "graphs": ["topology.json"]
    }
  }
}
```

#### 2. Block â†” Topology å°æ‡‰

**Structure â†’ Topology** çš„å°æ‡‰é€šå¸¸æ˜¯**ä¸€å°å¤š**ï¼š

```
templates/high-level/c/projects/student-management/
  â”œâ”€â”€ meta.json
  â”œâ”€â”€ sequence.c          # Sequence Form
  â”œâ”€â”€ structure.xml       # Structure Form
  â””â”€â”€ topology.json       # Topology Form (åŒ…å«å¤šç¨®åœ–è­œé¡å‹)
```

**è¨˜éŒ„æ–¹å¼** - åœ¨ meta.json å’Œ topology.json ä¸­ï¼š

meta.json:
```json
{
  "id": "student-management-system",
  "forms": {
    "sequence": {
      "main": "sequence.c"
    },
    "structure": {
      "workspace": "structure.xml"
    },
    "topology": {
      "graphs": ["topology.json"],
      "types": ["call-graph", "data-flow", "dependency-graph"]
    }
  }
}
```

topology.json:
```json
{
  "version": "3.0",
  "graphs": [
    {
      "type": "call-graph",
      "autoGenerated": true,
      "sourceForm": "sequence",
      "nodes": [...],
      "edges": [...]
    },
    {
      "type": "data-flow",
      "autoGenerated": true,
      "sourceForm": "structure",
      "nodes": [...],
      "edges": [...]
    },
    {
      "type": "dependency-graph",
      "autoGenerated": false,
      "nodes": [...],
      "edges": [...]
    }
  ]
}
```

#### 3. Sequence â†” Topology ç›´æ¥å°æ‡‰

**è·³éä¸­é–“å½¢æ…‹** çš„ç›´æ¥è½‰æ›ï¼š

```
C ç¨‹å¼ç¢¼ â”€â”€â”€â”€â”€â†’ å‘¼å«åœ–
        (ç›´æ¥åˆ†æ AST)
```

**è¨˜éŒ„æ–¹å¼** - è‡ªå‹•ç”Ÿæˆæ™‚è¨˜éŒ„æ–¼åœ–è­œçš„ metadataï¼š
```json
{
  "graphId": "call-graph-xyz",
  "graphType": "call-graph",
  "source": {
    "form": "sequence",
    "language": "c",
    "templatePath": "c/10-advanced/templates/student-management",
    "generatedAt": "2025-10-20T10:30:00Z",
    "generationMethod": "ast-analysis"
  }
}
```

---

### å°æ‡‰é—œä¿‚ç´¢å¼•ç³»çµ±

#### å…¨å±€ç´¢å¼•æª”æ¡ˆ

**ä½ç½®**: `forms/_index/mappings.json`

**çµæ§‹**:
```json
{
  "version": "1.0",
  "lastUpdated": "2025-10-20T10:30:00Z",
  "mappings": {
    "sequence-to-structure": [
      {
        "sequenceId": "c-hello-world",
        "sequencePath": "sequence/c/01-basic/templates/hello-world",
        "structureId": "universal-hello-world",
        "structurePath": "structure/universal/complete-programs/hello-world",
        "mappingType": "one-to-one",
        "confidence": 1.0,
        "verified": true,
        "lastVerified": "2025-10-20"
      },
      {
        "sequenceId": "c-for-loop",
        "sequencePath": "sequence/c/02-control/templates/for-loop",
        "mappingType": "one-to-many",
        "targets": [
          {
            "structureId": "universal-for-basic",
            "structurePath": "structure/universal/loops/for-basic",
            "confidence": 0.9,
            "conditions": ["simple iteration"]
          },
          {
            "structureId": "universal-for-array",
            "structurePath": "structure/universal/loops/for-with-array",
            "confidence": 0.85,
            "conditions": ["array traversal"]
          }
        ]
      }
    ],
    "structure-to-topology": [
      {
        "structureId": "universal-hello-world",
        "structurePath": "structure/universal/complete-programs/hello-world",
        "mappingType": "one-to-many",
        "targets": [
          {
            "topologyType": "call-graph",
            "topologyPath": "topology/call-graph/hello-world.json",
            "autoGenerated": true
          },
          {
            "topologyType": "control-flow",
            "topologyPath": "topology/control-flow/hello-world.json",
            "autoGenerated": true
          }
        ]
      }
    ],
    "sequence-to-topology": [
      {
        "sequenceId": "c-student-management",
        "sequencePath": "sequence/c/10-advanced/templates/student-management",
        "topologyType": "call-graph",
        "topologyPath": "topology/call-graph/student-management.json",
        "directMapping": true,
        "method": "ast-analysis"
      }
    ]
  },
  "statistics": {
    "totalSequenceTemplates": 150,
    "totalStructureBlocks": 200,
    "totalTopologyGraphs": 50,
    "verifiedMappings": 120,
    "pendingMappings": 30
  }
}
```

---

### å°æ‡‰é—œä¿‚é©—è­‰

#### é©—è­‰æµç¨‹

```typescript
/**
 * å°æ‡‰é—œä¿‚é©—è­‰å™¨
 */
class MappingValidator {
  /**
   * é©—è­‰ Sequence â†’ Structure å°æ‡‰
   */
  async validateSequenceToStructure(
    sequencePath: string,
    structurePath: string
  ): Promise<ValidationResult> {
    // 1. è¼‰å…¥å…©é‚Šçš„è³‡æ–™
    const template = await this.loadTemplate(sequencePath);
    const block = await this.loadBlock(structurePath);

    // 2. é€²è¡Œé›™å‘è½‰æ›æ¸¬è©¦
    const structureFromSequence = await this.transformToStructure(template);
    const sequenceFromStructure = await this.transformToSequence(block);

    // 3. æ¯”è¼ƒçµæœ
    const forwardMatch = this.compareStructures(
      structureFromSequence,
      block
    );
    const backwardMatch = this.compareSequences(
      sequenceFromStructure,
      template
    );

    // 4. è¨ˆç®—ä¿¡å¿ƒåº¦
    const confidence = (forwardMatch.similarity + backwardMatch.similarity) / 2;

    return {
      valid: confidence > 0.8,
      confidence,
      forwardMatch,
      backwardMatch,
      issues: this.identifyIssues(forwardMatch, backwardMatch)
    };
  }

  /**
   * çµæ§‹æ¯”è¼ƒï¼ˆå¿½ç•¥æ ¼å¼å·®ç•°ï¼‰
   */
  private compareStructures(
    structure1: Structure,
    structure2: Structure
  ): ComparisonResult {
    const ast1 = this.structureToAST(structure1);
    const ast2 = this.structureToAST(structure2);

    return {
      similarity: this.calculateASTSimilarity(ast1, ast2),
      differences: this.findASTDifferences(ast1, ast2)
    };
  }

  /**
   * åºåˆ—æ¯”è¼ƒï¼ˆèªç¾©å±¤é¢ï¼‰
   */
  private compareSequences(
    seq1: string,
    seq2: string
  ): ComparisonResult {
    // å¿½ç•¥æ ¼å¼å·®ç•°ï¼Œæ¯”è¼ƒèªç¾©
    const semantics1 = this.extractSemantics(seq1);
    const semantics2 = this.extractSemantics(seq2);

    return {
      similarity: this.calculateSemanticSimilarity(semantics1, semantics2),
      differences: this.findSemanticDifferences(semantics1, semantics2)
    };
  }

  /**
   * è­˜åˆ¥å•é¡Œ
   */
  private identifyIssues(
    forwardMatch: ComparisonResult,
    backwardMatch: ComparisonResult
  ): ValidationIssue[] {
    const issues: ValidationIssue[] = [];

    if (forwardMatch.similarity < 0.9) {
      issues.push({
        type: 'forward-transformation',
        severity: 'medium',
        message: 'Sequence â†’ Structure è½‰æ›æå¤±éå¤§',
        details: forwardMatch.differences
      });
    }

    if (backwardMatch.similarity < 0.9) {
      issues.push({
        type: 'backward-transformation',
        severity: 'medium',
        message: 'Structure â†’ Sequence è½‰æ›æå¤±éå¤§',
        details: backwardMatch.differences
      });
    }

    return issues;
  }
}
```

#### è‡ªå‹•é©—è­‰æ’ç¨‹

```typescript
/**
 * å®šæœŸé©—è­‰æ’ç¨‹å™¨
 */
class ValidationScheduler {
  /**
   * æ¯é€±é©—è­‰æ‰€æœ‰å°æ‡‰é—œä¿‚
   */
  async scheduleWeeklyValidation() {
    const mappings = await this.loadAllMappings();

    for (const mapping of mappings) {
      const result = await this.validator.validate(mapping);

      if (!result.valid) {
        // è¨˜éŒ„é©—è­‰å¤±æ•—
        await this.reportValidationFailure(mapping, result);

        // é™ä½ä¿¡å¿ƒåº¦
        mapping.confidence *= 0.8;
        mapping.verified = false;
      } else {
        // æ›´æ–°é©—è­‰ç‹€æ…‹
        mapping.verified = true;
        mapping.lastVerified = new Date();
      }
    }

    // å„²å­˜æ›´æ–°å¾Œçš„å°æ‡‰é—œä¿‚
    await this.saveMappings(mappings);

    // ç”Ÿæˆé©—è­‰å ±å‘Š
    await this.generateValidationReport();
  }
}
```

---

### å°æ‡‰é—œä¿‚åŒæ­¥æ©Ÿåˆ¶

#### å–®å‘åŒæ­¥ç­–ç•¥

**å ´æ™¯ 1ï¼šä½¿ç”¨è€…ä¿®æ”¹ Sequenceï¼ˆæ–‡å­—æ¨¡æ¿ï¼‰**

```
1. ä½¿ç”¨è€…ç·¨è¼¯ templates/high-level/c/control/for-loop/sequence.c
       â†“
2. æª”æ¡ˆç›£æ§å™¨åµæ¸¬åˆ°è®Šæ›´
       â†“
3. æŸ¥è©¢ meta.json ä¸­çš„ forms é…ç½®
       â†“
4. æ‰¾åˆ°å°æ‡‰çš„ Structure Forms: structure-basic.xml, structure-with-array.xml
       â†“
5. æç¤ºä½¿ç”¨è€…ï¼š
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ åµæ¸¬åˆ°å°æ‡‰çš„ç©æœ¨å·²éæœŸ              â”‚
   â”‚ - sequence.c å·²ä¿®æ”¹                 â”‚
   â”‚ - ç©æœ¨æª”æ¡ˆå¯èƒ½éœ€è¦æ›´æ–°ï¼š            â”‚
   â”‚   â€¢ structure-basic.xml             â”‚
   â”‚   â€¢ structure-with-array.xml        â”‚
   â”‚                                     â”‚
   â”‚ [ è‡ªå‹•æ›´æ–° ] [ ç¨å¾Œè™•ç† ] [ å–æ¶ˆå°æ‡‰ ] â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
6a. è‹¥é¸æ“‡ã€Œè‡ªå‹•æ›´æ–°ã€ï¼š
    - åŸ·è¡Œ Sequence â†’ Structure è½‰æ›
    - æ›´æ–°å°æ‡‰çš„ structure-*.xml æª”æ¡ˆ
    - æ¨™è¨˜ç‚ºã€Œéœ€è¦äººå·¥æª¢æŸ¥ã€

6b. è‹¥é¸æ“‡ã€Œç¨å¾Œè™•ç†ã€ï¼š
    - æ¨™è¨˜å°æ‡‰é—œä¿‚ç‚ºã€Œout-of-syncã€
    - é™ä½ä¿¡å¿ƒåº¦
    - åŠ å…¥å¾…åŒæ­¥æ¸…å–®

6c. è‹¥é¸æ“‡ã€Œå–æ¶ˆå°æ‡‰ã€ï¼š
    - ç§»é™¤å°æ‡‰é—œä¿‚
    - åœ¨ç´¢å¼•ä¸­æ¨™è¨˜ç‚ºã€Œå·²å–æ¶ˆã€
```

**å ´æ™¯ 2ï¼šä½¿ç”¨è€…ä¿®æ”¹ Structureï¼ˆç©æœ¨ï¼‰**

```
1. ä½¿ç”¨è€…åœ¨ Blockly Editor ä¸­ä¿®æ”¹ç©æœ¨
       â†“
2. ç·¨è¼¯å™¨ä¿å­˜ structure.xmlï¼ˆç”Ÿæˆæ–°ç‰ˆæœ¬ structure-v2.xmlï¼‰
       â†“
3. æŸ¥è©¢ meta.json ä¸­çš„ forms é…ç½®
       â†“
4. æ‰¾åˆ°å°æ‡‰çš„ Sequence Form (sequence.c)
       â†“
5. æç¤ºä½¿ç”¨è€…ï¼š
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç©æœ¨å·²ä¿®æ”¹                          â”‚
   â”‚ - æª¢æ¸¬åˆ°èˆ‡ä»¥ä¸‹æ¨¡æ¿çš„å°æ‡‰ï¼š          â”‚
   â”‚   - C for-loop æ¨¡æ¿                 â”‚
   â”‚   - Python for-loop æ¨¡æ¿            â”‚
   â”‚                                     â”‚
   â”‚ æ˜¯å¦åŒæ­¥æ›´æ–°å°æ‡‰æ¨¡æ¿ï¼Ÿ              â”‚
   â”‚ [ å…¨éƒ¨æ›´æ–° ] [ é¸æ“‡æ€§æ›´æ–° ] [ ä¸æ›´æ–° ] â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
6. è‹¥é¸æ“‡æ›´æ–°ï¼š
   - åŸ·è¡Œ Structure â†’ Sequence è½‰æ›
   - ç”Ÿæˆæ–°ç¨‹å¼ç¢¼
   - é¡¯ç¤º diff ä¾›ä½¿ç”¨è€…ç¢ºèª
```

#### é›™å‘åŒæ­¥å”èª¿

```typescript
/**
 * é›™å‘åŒæ­¥å”èª¿å™¨
 */
class BidirectionalSyncCoordinator {
  /**
   * è™•ç†è¡çªçš„ä¿®æ”¹
   */
  async handleConflictingChanges(
    mapping: Mapping,
    sequenceChange: Change,
    structureChange: Change
  ): Promise<SyncResult> {
    // 1. æª¢æ¸¬è¡çª
    const conflict = this.detectConflict(sequenceChange, structureChange);

    if (!conflict) {
      // ç„¡è¡çªï¼Œåˆ†åˆ¥å¥—ç”¨
      return this.applyBothChanges(sequenceChange, structureChange);
    }

    // 2. æœ‰è¡çªï¼Œéœ€è¦ä½¿ç”¨è€…ä»‹å…¥
    const userChoice = await this.promptUserResolution({
      sequenceChange,
      structureChange,
      conflict
    });

    switch (userChoice) {
      case 'keep-sequence':
        // ä¿ç•™ Sequence è®Šæ›´ï¼ŒåŒæ­¥åˆ° Structure
        return this.syncSequenceToStructure(mapping, sequenceChange);

      case 'keep-structure':
        // ä¿ç•™ Structure è®Šæ›´,åŒæ­¥åˆ° Sequence
        return this.syncStructureToSequence(mapping, structureChange);

      case 'merge':
        // å˜—è©¦åˆä½µå…©é‚Šçš„è®Šæ›´
        return this.mergeChanges(mapping, sequenceChange, structureChange);

      case 'keep-both':
        // è§£é™¤å°æ‡‰é—œä¿‚ï¼Œä¿ç•™å…©é‚Šç¨ç«‹ç‰ˆæœ¬
        return this.unlinkMapping(mapping);
    }
  }

  /**
   * æç¤ºä½¿ç”¨è€…è§£æ±ºè¡çª
   */
  private async promptUserResolution(
    context: ConflictContext
  ): Promise<ResolutionChoice> {
    // é¡¯ç¤ºè¡çªè§£æ±º UI
    return showConflictResolutionDialog({
      title: 'åŒæ­¥è¡çª',
      message: 'åµæ¸¬åˆ° Sequence èˆ‡ Structure åŒæ™‚è¢«ä¿®æ”¹',
      sequenceChanges: context.sequenceChange.diff,
      structureChanges: context.structureChange.diff,
      options: [
        {
          value: 'keep-sequence',
          label: 'ä½¿ç”¨æ–‡å­—ç‰ˆæœ¬',
          description: 'ä»¥æ–‡å­—æ¨¡æ¿ç‚ºæº–ï¼Œæ›´æ–°ç©æœ¨'
        },
        {
          value: 'keep-structure',
          label: 'ä½¿ç”¨ç©æœ¨ç‰ˆæœ¬',
          description: 'ä»¥ç©æœ¨ç‚ºæº–ï¼Œæ›´æ–°æ–‡å­—æ¨¡æ¿'
        },
        {
          value: 'merge',
          label: 'å˜—è©¦åˆä½µ',
          description: 'ç³»çµ±å˜—è©¦åˆä½µå…©é‚Šçš„è®Šæ›´ï¼ˆå¯èƒ½å¤±æ•—ï¼‰'
        },
        {
          value: 'keep-both',
          label: 'ä¿ç•™å…©é‚Š',
          description: 'è§£é™¤å°æ‡‰é—œä¿‚ï¼Œç¶­æŒå…©å€‹ç¨ç«‹ç‰ˆæœ¬'
        }
      ]
    });
  }
}
```

---

### å°æ‡‰é—œä¿‚æ¨è–¦ç³»çµ±

#### è‡ªå‹•æ¨è–¦æµç¨‹

ç•¶å»ºç«‹æ–°çš„ Template æˆ– Block æ™‚ï¼Œç³»çµ±è‡ªå‹•æ¨è–¦å¯èƒ½çš„å°æ‡‰ï¼š

```typescript
/**
 * å°æ‡‰é—œä¿‚æ¨è–¦å¼•æ“
 */
class MappingRecommender {
  /**
   * ç‚ºæ–°å»ºç«‹çš„ Sequence template æ¨è–¦å°æ‡‰çš„ Structure
   */
  async recommendStructureForSequence(
    templatePath: string
  ): Promise<MappingRecommendation[]> {
    // 1. è¼‰å…¥æ¨¡æ¿
    const template = await this.loadTemplate(templatePath);

    // 2. åˆ†æ AST
    const ast = this.parseCode(template.code, template.language);

    // 3. æå–ç‰¹å¾µ
    const features = this.extractFeatures(ast);

    // 4. åœ¨ Structure åº«ä¸­æœå°‹ç›¸ä¼¼ç©æœ¨
    const candidates = await this.searchSimilarBlocks(features);

    // 5. è¨ˆç®—ç›¸ä¼¼åº¦ä¸¦æ’åº
    const recommendations = candidates
      .map(candidate => ({
        structurePath: candidate.path,
        confidence: this.calculateSimilarity(ast, candidate.ast),
        reasons: this.explainSimilarity(ast, candidate.ast),
        preview: this.generatePreview(candidate)
      }))
      .filter(rec => rec.confidence > 0.6)
      .sort((a, b) => b.confidence - a.confidence)
      .slice(0, 5);

    return recommendations;
  }

  /**
   * ç‰¹å¾µæå–
   */
  private extractFeatures(ast: AST): Features {
    return {
      // çµæ§‹ç‰¹å¾µ
      nodeCount: this.countNodes(ast),
      depth: this.calculateDepth(ast),
      controlStructures: this.extractControlStructures(ast),

      // èªç¾©ç‰¹å¾µ
      operations: this.extractOperations(ast),
      dataFlow: this.analyzeDataFlow(ast),

      // æ¨¡å¼ç‰¹å¾µ
      patterns: this.matchKnownPatterns(ast)
    };
  }

  /**
   * ç›¸ä¼¼åº¦è¨ˆç®—
   */
  private calculateSimilarity(ast1: AST, ast2: AST): number {
    // çµæ§‹ç›¸ä¼¼åº¦ (0-1)
    const structuralSim = this.compareStructure(ast1, ast2);

    // èªç¾©ç›¸ä¼¼åº¦ (0-1)
    const semanticSim = this.compareSemantics(ast1, ast2);

    // æ¨¡å¼ç›¸ä¼¼åº¦ (0-1)
    const patternSim = this.comparePatterns(ast1, ast2);

    // åŠ æ¬Šå¹³å‡
    return (
      structuralSim * 0.4 +
      semanticSim * 0.4 +
      patternSim * 0.2
    );
  }
}
```

#### æ¨è–¦ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”— å°æ‡‰é—œä¿‚æ¨è–¦                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ åµæ¸¬åˆ°æ–°çš„ C æ¨¡æ¿ï¼šfor-loop                 â”‚
â”‚ ç³»çµ±æ‰¾åˆ° 3 å€‹å¯èƒ½çš„å°æ‡‰ç©æœ¨ï¼š               â”‚
â”‚                                             â”‚
â”‚ 1. âœ¨ universal/loops/for-basic             â”‚
â”‚    ä¿¡å¿ƒåº¦: 92%                              â”‚
â”‚    åŸå› : çµæ§‹å®Œå…¨åŒ¹é…ï¼Œå–®å±¤è¿´åœˆ             â”‚
â”‚    [é è¦½] [å»ºç«‹å°æ‡‰]                        â”‚
â”‚                                             â”‚
â”‚ 2. universal/loops/for-with-array           â”‚
â”‚    ä¿¡å¿ƒåº¦: 78%                              â”‚
â”‚    åŸå› : åŒ…å«é™£åˆ—æ“ä½œï¼Œä½†æœ¬æ¨¡æ¿æœªä½¿ç”¨       â”‚
â”‚    [é è¦½] [å»ºç«‹å°æ‡‰]                        â”‚
â”‚                                             â”‚
â”‚ 3. universal/loops/for-nested               â”‚
â”‚    ä¿¡å¿ƒåº¦: 65%                              â”‚
â”‚    åŸå› : å·¢ç‹€çµæ§‹ï¼Œä½†æœ¬æ¨¡æ¿ç‚ºå–®å±¤           â”‚
â”‚    [é è¦½] [å»ºç«‹å°æ‡‰]                        â”‚
â”‚                                             â”‚
â”‚ [ å…¨éƒ¨å¿½ç•¥ ] [ æ‰‹å‹•æŒ‡å®š ]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å°æ‡‰é—œä¿‚æŸ¥è©¢ API

```typescript
/**
 * å°æ‡‰é—œä¿‚æŸ¥è©¢æœå‹™
 */
class MappingQueryService {
  /**
   * æ ¹æ“š Sequence è·¯å¾‘æŸ¥è©¢å°æ‡‰çš„ Structure
   */
  async findStructureBySequence(
    sequencePath: string
  ): Promise<StructureMapping[]> {
    const index = await this.loadMappingIndex();
    return index.mappings['sequence-to-structure']
      .filter(m => m.sequencePath === sequencePath);
  }

  /**
   * æ ¹æ“š Structure è·¯å¾‘æŸ¥è©¢å°æ‡‰çš„ Sequence
   */
  async findSequenceByStructure(
    structurePath: string
  ): Promise<SequenceMapping[]> {
    const index = await this.loadMappingIndex();
    return index.mappings['sequence-to-structure']
      .filter(m => m.structurePath === structurePath);
  }

  /**
   * æŸ¥è©¢å¤šè·³è·¯å¾‘ï¼ˆä¾‹å¦‚ Sequence â†’ Structure â†’ Topologyï¼‰
   */
  async findMultiHopPath(
    sourcePath: string,
    sourceForm: FormType,
    targetForm: FormType
  ): Promise<MappingPath[]> {
    const graph = await this.buildMappingGraph();
    return this.findPaths(graph, sourcePath, sourceForm, targetForm);
  }

  /**
   * å»ºç«‹å°æ‡‰é—œä¿‚åœ–
   */
  private async buildMappingGraph(): Promise<MappingGraph> {
    const index = await this.loadMappingIndex();
    const graph = new MappingGraph();

    // åŠ å…¥ Sequence â†’ Structure é‚Š
    for (const mapping of index.mappings['sequence-to-structure']) {
      graph.addEdge(
        mapping.sequencePath,
        mapping.structurePath,
        mapping.confidence
      );
    }

    // åŠ å…¥ Structure â†’ Topology é‚Š
    for (const mapping of index.mappings['structure-to-topology']) {
      for (const target of mapping.targets) {
        graph.addEdge(
          mapping.structurePath,
          target.topologyPath,
          1.0  // è‡ªå‹•ç”Ÿæˆçš„åœ–è­œï¼Œä¿¡å¿ƒåº¦å›ºå®šç‚º 1
        );
      }
    }

    // åŠ å…¥ç›´æ¥çš„ Sequence â†’ Topology é‚Š
    for (const mapping of index.mappings['sequence-to-topology']) {
      graph.addEdge(
        mapping.sequencePath,
        mapping.topologyPath,
        0.95  // ç›´æ¥è½‰æ›ï¼Œç•¥ä½æ–¼ 1
      );
    }

    return graph;
  }
}
```

---

### å¾…è¨è«–å•é¡Œ

1. **å°æ‡‰é—œä¿‚çš„ç²’åº¦**
   - æ˜¯å¦åªè¨˜éŒ„é ‚å±¤å°æ‡‰ï¼ˆæ¨¡æ¿ â†” ç©æœ¨ï¼‰ï¼Ÿ
   - é‚„æ˜¯ä¹Ÿè¨˜éŒ„ç´°ç²’åº¦å°æ‡‰ï¼ˆL2, L3ï¼‰ï¼Ÿ

2. **ä¿¡å¿ƒåº¦é–¾å€¼**
   - å¤šå°‘ä¿¡å¿ƒåº¦ä»¥ä¸‹è¦–ç‚ºã€Œä¸å¯é å°æ‡‰ã€ï¼Ÿ
   - ä¸å¯é å°æ‡‰æ˜¯å¦æ‡‰è©²å®šæœŸæ¸…ç†ï¼Ÿ

3. **åŒæ­¥ç­–ç•¥**
   - é è¨­æ˜¯ã€Œè‡ªå‹•åŒæ­¥ã€é‚„æ˜¯ã€Œè©¢å•ä½¿ç”¨è€…ã€ï¼Ÿ
   - ä¸åŒé¡å‹çš„ä¿®æ”¹æ˜¯å¦æ‡‰æœ‰ä¸åŒç­–ç•¥ï¼Ÿ

4. **è¡çªè§£æ±º**
   - æ˜¯å¦éœ€è¦ã€Œä¸‰æ–¹åˆä½µã€å·¥å…·ï¼Ÿ
   - å¦‚ä½•è™•ç†ç„¡æ³•è‡ªå‹•åˆä½µçš„è¡çªï¼Ÿ

5. **å°æ‡‰é—œä¿‚ç‰ˆæœ¬æ§åˆ¶**
   - å°æ‡‰é—œä¿‚çš„æ­·å²æ˜¯å¦éœ€è¦ä¿ç•™ï¼Ÿ
   - æ˜¯å¦éœ€è¦ã€Œå›æ»¾ã€åŠŸèƒ½ï¼Ÿ

---

## Template Registry

> **æ¦‚å¿µ**ï¼šé›†ä¸­å¼æ¨¡æ¿è¨»å†Šè¡¨ï¼Œç®¡ç†æ‰€æœ‰å½¢æ…‹çš„æ¨¡æ¿/ç©æœ¨/åœ–è­œï¼Œæä¾›çµ±ä¸€çš„æŸ¥è©¢ã€ç‰ˆæœ¬æ§åˆ¶ã€ä¾è³´ç®¡ç†ä»‹é¢ã€‚

### è¨­è¨ˆå‹•æ©Ÿ

éš¨è‘—ç³»çµ±è¦æ¨¡æ“´å¤§ï¼Œéœ€è¦ä¸€å€‹**é›†ä¸­å¼ç®¡ç†ç³»çµ±**ï¼š

**é¢è‡¨çš„å•é¡Œ**ï¼š
- ğŸ“¦ æ¨¡æ¿åˆ†æ•£åœ¨ä¸åŒç›®éŒ„ï¼Œé›£ä»¥çµ±ä¸€ç®¡ç†
- ğŸ” æŸ¥è©¢æ•ˆç‡ä½ï¼ˆéœ€è¦éæ­·æª”æ¡ˆç³»çµ±ï¼‰
- ğŸ”— ä¾è³´é—œä¿‚ä¸æ˜ç¢º
- ğŸ“Š ç¼ºä¹çµ±è¨ˆå’Œåˆ†æèƒ½åŠ›
- ğŸ”„ ç‰ˆæœ¬ç®¡ç†æ··äº‚
- ğŸ·ï¸ æ¨™ç±¤å’Œåˆ†é¡ä¸ä¸€è‡´

**Registry çš„åƒ¹å€¼**ï¼š
- âœ… çµ±ä¸€çš„å…ƒè³‡æ–™ç®¡ç†
- âœ… å¿«é€ŸæŸ¥è©¢å’Œæª¢ç´¢
- âœ… ä¾è³´é—œä¿‚è¿½è¹¤
- âœ… ç‰ˆæœ¬æ§åˆ¶å’Œæ›´æ–°
- âœ… çµ±è¨ˆå’Œåˆ†æ
- âœ… API å­˜å–ä»‹é¢

---

### Registry æ¶æ§‹è¨­è¨ˆ

#### æ ¸å¿ƒè³‡æ–™çµæ§‹

```typescript
/**
 * Template Registry Entry
 * v3.0: æ”¯æ´æ’ä»¶ç³»çµ±å’Œå¤šèªè¨€å±¤ç´š
 */
interface RegistryEntry {
  // åŸºæœ¬è³‡è¨Š
  id: string;                      // å”¯ä¸€è­˜åˆ¥ç¢¼
  type: 'sequence' | 'structure' | 'topology';  // å½¢æ…‹é¡å‹
  path: string;                    // æª”æ¡ˆç³»çµ±è·¯å¾‘
  name: string;                    // é¡¯ç¤ºåç¨±
  description: string;             // æè¿°

  // åˆ†é¡èˆ‡æ¨™ç±¤
  category: string;                // åˆ†é¡ï¼ˆå¦‚ "loops", "algorithms"ï¼‰
  tags: string[];                  // æ¨™ç±¤ï¼ˆå¦‚ "beginner", "advanced"ï¼‰

  // v3.0: èªè¨€å±¤ç´šæ”¯æ´
  languageLevel: {
    type: "natural" | "high-level" | "low-level" | "machine" | "hdl" | "physical";
    specific?: string;             // å…·é«”èªè¨€ï¼ˆå¦‚ "python", "x86-asm", "verilog"ï¼‰
  };
  granularity: "L0" | "L1" | "L2" | "L3";  // ç²’åº¦å±¤ç´š

  // ç‰ˆæœ¬è³‡è¨Š
  version: string;                 // ç‰ˆæœ¬è™Ÿï¼ˆèªç¾©åŒ–ç‰ˆæœ¬ï¼‰
  createdAt: Date;                 // å»ºç«‹æ™‚é–“
  updatedAt: Date;                 // æœ€å¾Œæ›´æ–°æ™‚é–“
  author: string;                  // ä½œè€…

  // ä¾è³´é—œä¿‚
  dependencies: Dependency[];      // ä¾è³´çš„å…¶ä»–æ¨¡æ¿
  usedBy: string[];                // è¢«å“ªäº›æ¨¡æ¿ä½¿ç”¨

  // å°æ‡‰é—œä¿‚
  mappings: {
    sequence?: string[];           // å°æ‡‰çš„ Sequence templates
    structure?: string[];          // å°æ‡‰çš„ Structure blocks
    topology?: string[];           // å°æ‡‰çš„ Topology graphs
  };

  // çµ±è¨ˆè³‡è¨Š
  stats: {
    usageCount: number;            // ä½¿ç”¨æ¬¡æ•¸
    favoriteCount: number;         // æ”¶è—æ¬¡æ•¸
    lastUsed?: Date;               // æœ€å¾Œä½¿ç”¨æ™‚é–“
  };

  // å“è³ªæŒ‡æ¨™
  quality: {
    verified: boolean;             // æ˜¯å¦å·²é©—è­‰
    rating: number;                // è©•åˆ† (0-5)
    reviews: number;               // è©•è«–æ•¸
  };

  // å…ƒè³‡æ–™ï¼ˆå¾åŸå§‹ meta.json è¼‰å…¥ï¼‰
  metadata: Record<string, any>;

  // v3.0: æ’ä»¶ç³»çµ±æ”¯æ´
  plugins?: {
    installed: string[];           // å·²å®‰è£çš„æ’ä»¶åç¨±
    data: Record<string, any>;     // æ’ä»¶æä¾›çš„é¡å¤–è³‡æ–™
  };
}

/**
 * ä¾è³´é—œä¿‚
 */
interface Dependency {
  id: string;                      // ä¾è³´çš„æ¨¡æ¿ ID
  type: 'required' | 'optional';   // ä¾è³´é¡å‹
  version: string;                 // ç‰ˆæœ¬è¦æ±‚ï¼ˆå¦‚ "^1.0.0"ï¼‰
  reason?: string;                 // ä¾è³´åŸå› 
}
```

#### Registry æª”æ¡ˆçµæ§‹

```
forms/_registry/
â”œâ”€â”€ registry.db                    # ä¸»è¦è³‡æ–™åº«ï¼ˆSQLiteï¼‰
â”œâ”€â”€ index.json                     # å¿«é€ŸæŸ¥è©¢ç´¢å¼•
â”œâ”€â”€ cache/                         # å¿«å–
â”‚   â”œâ”€â”€ by-language/
â”‚   â”œâ”€â”€ by-category/
â”‚   â””â”€â”€ by-tag/
â””â”€â”€ backups/                       # å‚™ä»½
    â”œâ”€â”€ 2025-10-20.db
    â””â”€â”€ 2025-10-19.db
```

---

### Registry æ ¸å¿ƒåŠŸèƒ½

#### 1. è¨»å†Šèˆ‡ç´¢å¼•

```typescript
/**
 * Template Registry ç®¡ç†å™¨
 * v3.0: æ”¯æ´æ’ä»¶ç³»çµ±
 */
class TemplateRegistry {
  private db: Database;
  private cache: Cache;
  private pluginManager: PluginManager;  // v3.0: æ’ä»¶ç®¡ç†å™¨

  /**
   * è¨»å†Šæ–°æ¨¡æ¿
   * v3.0: æ”¯æ´æ’ä»¶ç”Ÿå‘½é€±æœŸé‰¤å­
   */
  async register(entry: RegistryEntry): Promise<void> {
    // 1. é©—è­‰å”¯ä¸€æ€§
    if (await this.exists(entry.id)) {
      throw new Error(`Template ${entry.id} already registered`);
    }

    // 2. é©—è­‰ä¾è³´
    await this.validateDependencies(entry.dependencies);

    // v3.0: 3. è§¸ç™¼æ’ä»¶çš„ onLoad é‰¤å­
    if (entry.plugins?.installed) {
      for (const pluginName of entry.plugins.installed) {
        const plugin = this.pluginManager.getPlugin(pluginName);
        if (plugin?.onLoad) {
          await plugin.onLoad(entry);
        }
      }
    }

    // 4. å¯«å…¥è³‡æ–™åº«
    await this.db.insert('templates', entry);

    // 5. æ›´æ–°ç´¢å¼•
    await this.updateIndices(entry);

    // 6. æ¸…é™¤ç›¸é—œå¿«å–
    await this.cache.invalidate(['all', `category:${entry.category}`]);

    // 7. è§¸ç™¼äº‹ä»¶
    this.emit('registered', entry);
  }

  /**
   * æ‰¹æ¬¡è¨»å†Šï¼ˆåˆå§‹åŒ–æ™‚ä½¿ç”¨ï¼‰
   */
  async registerAll(rootPath: string): Promise<RegistrationResult> {
    const results = {
      registered: [],
      failed: [],
      skipped: []
    };

    // 1. æƒææ‰€æœ‰æ¨¡æ¿ç›®éŒ„
    const paths = await this.scanTemplateDirectories(rootPath);

    // 2. é€ä¸€è¨»å†Š
    for (const path of paths) {
      try {
        const entry = await this.loadTemplateEntry(path);
        await this.register(entry);
        results.registered.push(entry.id);
      } catch (error) {
        results.failed.push({ path, error: error.message });
      }
    }

    return results;
  }

  /**
   * æ›´æ–°è¨»å†Šè³‡è¨Š
   */
  async update(id: string, updates: Partial<RegistryEntry>): Promise<void> {
    const existing = await this.get(id);
    if (!existing) {
      throw new Error(`Template ${id} not found`);
    }

    // å¢åŠ ç‰ˆæœ¬è™Ÿ
    updates.version = this.incrementVersion(existing.version);
    updates.updatedAt = new Date();

    await this.db.update('templates', { id }, updates);
    await this.cache.invalidate([id]);
    this.emit('updated', { id, updates });
  }
}
```

#### 2. æŸ¥è©¢èˆ‡æª¢ç´¢

```typescript
/**
 * Registry æŸ¥è©¢æœå‹™
 */
class RegistryQueryService {
  /**
   * æ ¹æ“š ID æŸ¥è©¢
   */
  async getById(id: string): Promise<RegistryEntry | null> {
    // å„ªå…ˆå¾å¿«å–å–å¾—
    const cached = await this.cache.get(id);
    if (cached) return cached;

    // å¾è³‡æ–™åº«æŸ¥è©¢
    const entry = await this.db.query(
      'SELECT * FROM templates WHERE id = ?',
      [id]
    );

    if (entry) {
      await this.cache.set(id, entry);
    }

    return entry;
  }

  /**
   * æŒ‰åˆ†é¡æŸ¥è©¢
   */
  async findByCategory(
    category: string,
    options?: QueryOptions
  ): Promise<RegistryEntry[]> {
    const cacheKey = `category:${category}`;
    const cached = await this.cache.get(cacheKey);
    if (cached) return cached;

    const entries = await this.db.query(
      'SELECT * FROM templates WHERE category = ? ORDER BY name',
      [category]
    );

    await this.cache.set(cacheKey, entries);
    return entries;
  }

  /**
   * æŒ‰æ¨™ç±¤æŸ¥è©¢
   */
  async findByTags(
    tags: string[],
    matchAll: boolean = false
  ): Promise<RegistryEntry[]> {
    if (matchAll) {
      // éœ€è¦åŒ¹é…æ‰€æœ‰æ¨™ç±¤
      return this.db.query(`
        SELECT * FROM templates
        WHERE ${tags.map(() => 'tags LIKE ?').join(' AND ')}
      `, tags.map(tag => `%${tag}%`));
    } else {
      // åŒ¹é…ä»»ä¸€æ¨™ç±¤
      return this.db.query(`
        SELECT * FROM templates
        WHERE ${tags.map(() => 'tags LIKE ?').join(' OR ')}
      `, tags.map(tag => `%${tag}%`));
    }
  }

  /**
   * å…¨æ–‡æœå°‹
   */
  async search(
    query: string,
    options?: SearchOptions
  ): Promise<SearchResult[]> {
    // ä½¿ç”¨å…¨æ–‡ç´¢å¼•æœå°‹
    const results = await this.db.query(`
      SELECT *,
        (CASE
          WHEN name LIKE ? THEN 100
          WHEN description LIKE ? THEN 50
          WHEN tags LIKE ? THEN 30
          ELSE 0
        END) as relevance
      FROM templates
      WHERE name LIKE ? OR description LIKE ? OR tags LIKE ?
      ORDER BY relevance DESC, usageCount DESC
      LIMIT ?
    `, [
      `%${query}%`, `%${query}%`, `%${query}%`,
      `%${query}%`, `%${query}%`, `%${query}%`,
      options?.limit || 20
    ]);

    return results;
  }

  /**
   * é€²éšæŸ¥è©¢ï¼ˆçµ„åˆæ¢ä»¶ï¼‰
   * v3.0: æ”¯æ´èªè¨€å±¤ç´šå’Œæ’ä»¶æŸ¥è©¢
   */
  async advancedSearch(criteria: SearchCriteria): Promise<RegistryEntry[]> {
    const conditions = [];
    const params = [];

    if (criteria.type) {
      conditions.push('type = ?');
      params.push(criteria.type);
    }

    // v3.0: èªè¨€å±¤ç´šæŸ¥è©¢
    if (criteria.languageLevel) {
      conditions.push('languageLevel_type = ?');
      params.push(criteria.languageLevel);
    }

    if (criteria.specificLanguage) {
      conditions.push('languageLevel_specific = ?');
      params.push(criteria.specificLanguage);
    }

    // v3.0: ç²’åº¦å±¤ç´šæŸ¥è©¢
    if (criteria.granularity) {
      conditions.push('granularity = ?');
      params.push(criteria.granularity);
    }

    if (criteria.categories && criteria.categories.length > 0) {
      conditions.push(`category IN (${criteria.categories.map(() => '?').join(',')})`);
      params.push(...criteria.categories);
    }

    if (criteria.minRating) {
      conditions.push('quality_rating >= ?');
      params.push(criteria.minRating);
    }

    if (criteria.verified !== undefined) {
      conditions.push('quality_verified = ?');
      params.push(criteria.verified ? 1 : 0);
    }

    // v3.0: æ’ä»¶æŸ¥è©¢
    if (criteria.hasPlugin) {
      conditions.push('plugins_installed LIKE ?');
      params.push(`%${criteria.hasPlugin}%`);
    }

    const whereClause = conditions.length > 0
      ? `WHERE ${conditions.join(' AND ')}`
      : '';

    return this.db.query(`
      SELECT * FROM templates
      ${whereClause}
      ORDER BY ${criteria.sortBy || 'usageCount'} DESC
    `, params);
  }

  /**
   * v3.0: æŒ‰èªè¨€å±¤ç´šæŸ¥è©¢
   */
  async findByLanguageLevel(
    languageLevel: string,
    specificLanguage?: string
  ): Promise<RegistryEntry[]> {
    const cacheKey = `language:${languageLevel}:${specificLanguage || 'all'}`;
    const cached = await this.cache.get(cacheKey);
    if (cached) return cached;

    let query = 'SELECT * FROM templates WHERE languageLevel_type = ?';
    const params = [languageLevel];

    if (specificLanguage) {
      query += ' AND languageLevel_specific = ?';
      params.push(specificLanguage);
    }

    const entries = await this.db.query(query + ' ORDER BY name', params);
    await this.cache.set(cacheKey, entries);
    return entries;
  }

  /**
   * v3.0: æŒ‰ç²’åº¦å±¤ç´šæŸ¥è©¢
   */
  async findByGranularity(granularity: string): Promise<RegistryEntry[]> {
    const cacheKey = `granularity:${granularity}`;
    const cached = await this.cache.get(cacheKey);
    if (cached) return cached;

    const entries = await this.db.query(
      'SELECT * FROM templates WHERE granularity = ? ORDER BY name',
      [granularity]
    );

    await this.cache.set(cacheKey, entries);
    return entries;
  }

  /**
   * v3.0: æŒ‰æ’ä»¶æŸ¥è©¢
   */
  async findByPlugin(pluginName: string): Promise<RegistryEntry[]> {
    const cacheKey = `plugin:${pluginName}`;
    const cached = await this.cache.get(cacheKey);
    if (cached) return cached;

    const entries = await this.db.query(
      'SELECT * FROM templates WHERE plugins_installed LIKE ? ORDER BY name',
      [`%${pluginName}%`]
    );

    await this.cache.set(cacheKey, entries);
    return entries;
  }
}
```

#### 3. ä¾è³´ç®¡ç†

```typescript
/**
 * ä¾è³´ç®¡ç†å™¨
 */
class DependencyManager {
  /**
   * è§£æä¾è³´æ¨¹
   */
  async resolveDependencies(
    templateId: string
  ): Promise<DependencyTree> {
    const entry = await this.registry.getById(templateId);
    if (!entry) {
      throw new Error(`Template ${templateId} not found`);
    }

    const tree: DependencyTree = {
      id: templateId,
      entry,
      dependencies: []
    };

    // éè¿´è§£æä¾è³´
    for (const dep of entry.dependencies) {
      const depTree = await this.resolveDependencies(dep.id);
      tree.dependencies.push(depTree);
    }

    return tree;
  }

  /**
   * æª¢æŸ¥å¾ªç’°ä¾è³´
   */
  async detectCircularDependencies(
    templateId: string
  ): Promise<CircularDependency[]> {
    const visited = new Set<string>();
    const stack: string[] = [];
    const circles: CircularDependency[] = [];

    const dfs = async (id: string) => {
      if (stack.includes(id)) {
        // ç™¼ç¾å¾ªç’°
        const circleStart = stack.indexOf(id);
        circles.push({
          cycle: [...stack.slice(circleStart), id]
        });
        return;
      }

      if (visited.has(id)) return;

      visited.add(id);
      stack.push(id);

      const entry = await this.registry.getById(id);
      if (entry) {
        for (const dep of entry.dependencies) {
          await dfs(dep.id);
        }
      }

      stack.pop();
    };

    await dfs(templateId);
    return circles;
  }

  /**
   * è¨ˆç®—å½±éŸ¿ç¯„åœï¼ˆç•¶æŸå€‹æ¨¡æ¿æ›´æ–°æ™‚ï¼‰
   */
  async calculateImpact(templateId: string): Promise<ImpactAnalysis> {
    const entry = await this.registry.getById(templateId);
    if (!entry) {
      throw new Error(`Template ${templateId} not found`);
    }

    // æ‰¾å‡ºæ‰€æœ‰ä¾è³´æ­¤æ¨¡æ¿çš„æ¨¡æ¿
    const directDependents = entry.usedBy;

    // éè¿´æ‰¾å‡ºé–“æ¥ä¾è³´
    const allDependents = new Set<string>(directDependents);
    for (const depId of directDependents) {
      const subImpact = await this.calculateImpact(depId);
      subImpact.directDependents.forEach(id => allDependents.add(id));
    }

    return {
      templateId,
      directDependents,
      totalAffected: allDependents.size,
      affectedTemplates: Array.from(allDependents)
    };
  }
}
```

#### 4. æ’ä»¶æ•´åˆ

> **v3.0 æ–°å¢**ï¼šRegistry èˆ‡æ’ä»¶ç³»çµ±çš„æ·±åº¦æ•´åˆ

```typescript
/**
 * Registry Plugin Manager
 * ç®¡ç† Registry å±¤ç´šçš„æ’ä»¶åŠŸèƒ½
 */
class RegistryPluginManager {
  private pluginManager: PluginManager;
  private registry: TemplateRegistry;

  /**
   * ç‚ºæ¨¡æ¿é™„åŠ æ’ä»¶æ•¸æ“š
   */
  async attachPluginData(entry: RegistryEntry): Promise<RegistryEntry> {
    if (!entry.plugins?.installed) {
      return entry;
    }

    // å¾æ¯å€‹æ’ä»¶æ”¶é›†å…ƒè³‡æ–™
    const pluginData: Record<string, any> = {};

    for (const pluginName of entry.plugins.installed) {
      const plugin = this.pluginManager.getPlugin(pluginName);
      if (plugin?.provideMetadata) {
        const metadata = await plugin.provideMetadata(entry);
        pluginData[pluginName] = metadata;
      }
    }

    // é™„åŠ åˆ° entry
    return {
      ...entry,
      plugins: {
        ...entry.plugins,
        data: pluginData
      }
    };
  }

  /**
   * æ‰¹æ¬¡é™„åŠ æ’ä»¶æ•¸æ“š
   */
  async batchAttachPluginData(
    entries: RegistryEntry[]
  ): Promise<RegistryEntry[]> {
    return Promise.all(
      entries.map(entry => this.attachPluginData(entry))
    );
  }

  /**
   * æ’ä»¶é©—è­‰
   */
  async validateWithPlugins(entry: RegistryEntry): Promise<ValidationResult> {
    const errors: ValidationError[] = [];
    const warnings: ValidationWarning[] = [];

    if (!entry.plugins?.installed) {
      return { valid: true, errors, warnings };
    }

    for (const pluginName of entry.plugins.installed) {
      const plugin = this.pluginManager.getPlugin(pluginName);
      if (plugin?.provideValidation) {
        const result = await plugin.provideValidation(entry);
        errors.push(...result.errors);
        warnings.push(...result.warnings);
      }
    }

    return {
      valid: errors.length === 0,
      errors,
      warnings
    };
  }

  /**
   * æ’ä»¶å·¥å…·è¨»å†Š
   * å…è¨±æ’ä»¶æä¾›è‡ªå®šç¾©å·¥å…·ï¼ˆå¦‚èªæ³•æª¢æŸ¥ã€å„ªåŒ–å»ºè­°ï¼‰
   */
  async registerPluginTools(pluginName: string): Promise<void> {
    const plugin = this.pluginManager.getPlugin(pluginName);
    if (!plugin?.provideTools) {
      return;
    }

    const tools = await plugin.provideTools();

    // è¨»å†Šå·¥å…·åˆ° Registry
    for (const tool of tools) {
      this.registry.registerTool({
        name: tool.name,
        plugin: pluginName,
        execute: tool.execute,
        description: tool.description
      });
    }
  }

  /**
   * æŸ¥è©¢æ’ä»¶çµ±è¨ˆ
   */
  async getPluginStats(pluginName: string): Promise<PluginStats> {
    const entries = await this.registry.queryService.findByPlugin(pluginName);

    return {
      pluginName,
      totalTemplates: entries.length,
      byLanguageLevel: this.groupByLanguageLevel(entries),
      byGranularity: this.groupByGranularity(entries),
      averageRating: this.calculateAverageRating(entries),
      totalUsage: entries.reduce((sum, e) => sum + e.stats.usageCount, 0)
    };
  }

  /**
   * æ’ä»¶æ›´æ–°å‚³æ’­
   * ç•¶æ’ä»¶æ›´æ–°æ™‚ï¼Œé€šçŸ¥æ‰€æœ‰ä½¿ç”¨è©²æ’ä»¶çš„æ¨¡æ¿
   */
  async propagatePluginUpdate(
    pluginName: string,
    newVersion: string
  ): Promise<PropagationResult> {
    const affectedEntries = await this.registry.queryService.findByPlugin(pluginName);

    const results = {
      updated: [],
      failed: [],
      requiresManualUpdate: []
    };

    for (const entry of affectedEntries) {
      try {
        // å˜—è©¦è‡ªå‹•æ›´æ–°æ’ä»¶æ•¸æ“š
        const updated = await this.attachPluginData(entry);
        await this.registry.update(entry.id, updated);
        results.updated.push(entry.id);
      } catch (error) {
        if (error.code === 'BREAKING_CHANGE') {
          results.requiresManualUpdate.push(entry.id);
        } else {
          results.failed.push({ id: entry.id, error: error.message });
        }
      }
    }

    return results;
  }

  private groupByLanguageLevel(entries: RegistryEntry[]) {
    return entries.reduce((acc, entry) => {
      const key = entry.languageLevel.type;
      acc[key] = (acc[key] || 0) + 1;
      return acc;
    }, {} as Record<string, number>);
  }

  private groupByGranularity(entries: RegistryEntry[]) {
    return entries.reduce((acc, entry) => {
      acc[entry.granularity] = (acc[entry.granularity] || 0) + 1;
      return acc;
    }, {} as Record<string, number>);
  }

  private calculateAverageRating(entries: RegistryEntry[]): number {
    if (entries.length === 0) return 0;
    const sum = entries.reduce((acc, e) => acc + e.quality.rating, 0);
    return sum / entries.length;
  }
}
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š

```typescript
// 1. é™„åŠ æ’ä»¶æ•¸æ“šæŸ¥è©¢
const hdlTemplates = await registry.queryService.findByLanguageLevel('hdl');
const withPluginData = await registryPluginManager.batchAttachPluginData(hdlTemplates);

// 2. æ’ä»¶é©—è­‰
const validationResult = await registryPluginManager.validateWithPlugins(template);
if (!validationResult.valid) {
  console.error('é©—è­‰å¤±æ•—:', validationResult.errors);
}

// 3. æŸ¥è©¢æ’ä»¶çµ±è¨ˆ
const hdlPluginStats = await registryPluginManager.getPluginStats('hdl-plugin');
console.log(`HDL Plugin ä½¿ç”¨æ–¼ ${hdlPluginStats.totalTemplates} å€‹æ¨¡æ¿`);

// 4. æ’ä»¶æ›´æ–°å‚³æ’­
const result = await registryPluginManager.propagatePluginUpdate('hdl-plugin', '2.0.0');
console.log(`æˆåŠŸæ›´æ–° ${result.updated.length} å€‹æ¨¡æ¿`);
console.log(`éœ€è¦æ‰‹å‹•æ›´æ–° ${result.requiresManualUpdate.length} å€‹æ¨¡æ¿`);
```

---

#### 5. ç‰ˆæœ¬æ§åˆ¶

```typescript
/**
 * ç‰ˆæœ¬ç®¡ç†å™¨
 */
class VersionManager {
  /**
   * ç™¼å¸ƒæ–°ç‰ˆæœ¬
   */
  async publishVersion(
    templateId: string,
    versionType: 'major' | 'minor' | 'patch',
    changelog: string
  ): Promise<VersionInfo> {
    const entry = await this.registry.getById(templateId);
    if (!entry) {
      throw new Error(`Template ${templateId} not found`);
    }

    // è¨ˆç®—æ–°ç‰ˆæœ¬è™Ÿ
    const newVersion = this.incrementVersion(entry.version, versionType);

    // å„²å­˜ç‰ˆæœ¬æ­·å²
    await this.saveVersionHistory(templateId, {
      version: entry.version,
      content: await this.loadTemplateContent(entry.path),
      changelog: changelog,
      publishedAt: new Date()
    });

    // æ›´æ–° Registry
    await this.registry.update(templateId, {
      version: newVersion
    });

    return {
      templateId,
      oldVersion: entry.version,
      newVersion,
      changelog
    };
  }

  /**
   * å›æ»¾åˆ°æŒ‡å®šç‰ˆæœ¬
   */
  async rollback(
    templateId: string,
    targetVersion: string
  ): Promise<void> {
    const history = await this.getVersionHistory(templateId);
    const targetSnapshot = history.find(h => h.version === targetVersion);

    if (!targetSnapshot) {
      throw new Error(`Version ${targetVersion} not found`);
    }

    // æ¢å¾©å…§å®¹
    const entry = await this.registry.getById(templateId);
    await this.writeTemplateContent(entry.path, targetSnapshot.content);

    // æ›´æ–° Registryï¼ˆæ¨™è¨˜ç‚ºå›æ»¾ï¼‰
    await this.registry.update(templateId, {
      version: `${targetVersion}-rollback`,
      updatedAt: new Date()
    });
  }

  /**
   * ç‰ˆæœ¬è™Ÿéå¢
   */
  private incrementVersion(
    current: string,
    type: 'major' | 'minor' | 'patch'
  ): string {
    const [major, minor, patch] = current.split('.').map(Number);

    switch (type) {
      case 'major':
        return `${major + 1}.0.0`;
      case 'minor':
        return `${major}.${minor + 1}.0`;
      case 'patch':
        return `${major}.${minor}.${patch + 1}`;
    }
  }
}
```

---

### Registry API

```typescript
/**
 * Template Registry API
 */
class TemplateRegistryAPI {
  // === æŸ¥è©¢ API ===

  /** GET /registry/templates/:id - å–å¾—å–®ä¸€æ¨¡æ¿è³‡è¨Š */
  async getTemplate(id: string): Promise<RegistryEntry>;

  /** GET /registry/templates - åˆ—å‡ºæ‰€æœ‰æ¨¡æ¿ */
  async listTemplates(options?: ListOptions): Promise<RegistryEntry[]>;

  /** GET /registry/search?q=... - æœå°‹æ¨¡æ¿ */
  async searchTemplates(query: string): Promise<SearchResult[]>;

  /** POST /registry/search/advanced - é€²éšæœå°‹ */
  async advancedSearch(criteria: SearchCriteria): Promise<RegistryEntry[]>;

  // === åˆ†é¡èˆ‡æ¨™ç±¤ ===

  /** GET /registry/categories - å–å¾—æ‰€æœ‰åˆ†é¡ */
  async getCategories(): Promise<Category[]>;

  /** GET /registry/tags - å–å¾—æ‰€æœ‰æ¨™ç±¤ */
  async getTags(): Promise<Tag[]>;

  /** GET /registry/templates/by-category/:category - æŒ‰åˆ†é¡æŸ¥è©¢ */
  async getByCategory(category: string): Promise<RegistryEntry[]>;

  /** GET /registry/templates/by-tag/:tag - æŒ‰æ¨™ç±¤æŸ¥è©¢ */
  async getByTag(tag: string): Promise<RegistryEntry[]>;

  // === ä¾è³´ç®¡ç† ===

  /** GET /registry/templates/:id/dependencies - å–å¾—ä¾è³´æ¨¹ */
  async getDependencies(id: string): Promise<DependencyTree>;

  /** GET /registry/templates/:id/dependents - å–å¾—è¢«ä¾è³´åˆ—è¡¨ */
  async getDependents(id: string): Promise<string[]>;

  /** GET /registry/templates/:id/impact - è¨ˆç®—å½±éŸ¿ç¯„åœ */
  async getImpact(id: string): Promise<ImpactAnalysis>;

  // === çµ±è¨ˆèˆ‡åˆ†æ ===

  /** GET /registry/stats - å–å¾—çµ±è¨ˆè³‡è¨Š */
  async getStatistics(): Promise<RegistryStatistics>;

  /** GET /registry/templates/:id/stats - å–å¾—å–®ä¸€æ¨¡æ¿çµ±è¨ˆ */
  async getTemplateStats(id: string): Promise<TemplateStatistics>;

  // === ç‰ˆæœ¬ç®¡ç† ===

  /** GET /registry/templates/:id/versions - å–å¾—ç‰ˆæœ¬æ­·å² */
  async getVersionHistory(id: string): Promise<VersionHistory[]>;

  /** POST /registry/templates/:id/publish - ç™¼å¸ƒæ–°ç‰ˆæœ¬ */
  async publishVersion(
    id: string,
    type: 'major' | 'minor' | 'patch',
    changelog: string
  ): Promise<VersionInfo>;

  /** POST /registry/templates/:id/rollback - å›æ»¾ç‰ˆæœ¬ */
  async rollbackVersion(id: string, targetVersion: string): Promise<void>;

  // === ç®¡ç† API ===

  /** POST /registry/templates - è¨»å†Šæ–°æ¨¡æ¿ */
  async registerTemplate(entry: RegistryEntry): Promise<void>;

  /** PUT /registry/templates/:id - æ›´æ–°æ¨¡æ¿è³‡è¨Š */
  async updateTemplate(id: string, updates: Partial<RegistryEntry>): Promise<void>;

  /** DELETE /registry/templates/:id - åˆªé™¤æ¨¡æ¿ */
  async deleteTemplate(id: string): Promise<void>;

  /** POST /registry/rebuild - é‡å»ºæ•´å€‹ Registry */
  async rebuildRegistry(): Promise<RegistrationResult>;
}
```

---

### Registry åˆå§‹åŒ–

```typescript
/**
 * Registry åˆå§‹åŒ–å™¨
 */
class RegistryInitializer {
  /**
   * åˆå§‹åŒ– Registryï¼ˆé¦–æ¬¡å•Ÿå‹•æ™‚ï¼‰
   */
  async initialize(formsRoot: string): Promise<void> {
    console.log('Initializing Template Registry...');

    // 1. å»ºç«‹è³‡æ–™åº«
    await this.createDatabase();

    // 2. å»ºç«‹ç´¢å¼•
    await this.createIndices();

    // 3. æƒæä¸¦è¨»å†Šæ‰€æœ‰æ¨¡æ¿
    const result = await this.scanAndRegister(formsRoot);

    console.log(`Registry initialized: ${result.registered.length} templates registered`);

    // 4. å»ºç«‹ä¾è³´é—œä¿‚
    await this.buildDependencyGraph();

    // 5. å»ºç«‹å°æ‡‰é—œä¿‚ç´¢å¼•
    await this.buildMappingIndex();

    console.log('Registry initialization complete');
  }

  /**
   * æƒæä¸¦è¨»å†Šæ‰€æœ‰æ¨¡æ¿
   */
  private async scanAndRegister(root: string): Promise<RegistrationResult> {
    const result: RegistrationResult = {
      registered: [],
      failed: [],
      skipped: []
    };

    // æƒæ Sequence templates
    await this.scanSequenceTemplates(`${root}/sequence`, result);

    // æƒæ Structure blocks
    await this.scanStructureBlocks(`${root}/structure`, result);

    // æƒæ Topology graphs
    await this.scanTopologyGraphs(`${root}/topology`, result);

    return result;
  }
}
```

---

### å¾…è¨è«–å•é¡Œ

1. **Registry å„²å­˜æ–¹å¼**
   - SQLite æ˜¯å¦è¶³å¤ ï¼Ÿé‚„æ˜¯éœ€è¦æ›´å¼·å¤§çš„è³‡æ–™åº«ï¼Ÿ
   - æ˜¯å¦éœ€è¦æ”¯æ´åˆ†æ•£å¼ Registryï¼Ÿ

2. **å¿«å–ç­–ç•¥**
   - å¿«å–çš„æœ‰æ•ˆæœŸï¼Ÿ
   - ä½•æ™‚è©²æ¸…é™¤å¿«å–ï¼Ÿ

3. **ç‰ˆæœ¬è™Ÿæ ¼å¼**
   - æ˜¯å¦åš´æ ¼éµå¾ªèªç¾©åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰ï¼Ÿ
   - å¦‚ä½•è™•ç†ä¸ç›¸å®¹çš„ç‰ˆæœ¬æ›´æ–°ï¼Ÿ

4. **ä¾è³´è§£æ**
   - æ˜¯å¦æ”¯æ´ç‰ˆæœ¬ç¯„åœï¼ˆå¦‚ `^1.0.0`, `~1.2.3`ï¼‰ï¼Ÿ
   - å¦‚ä½•è™•ç†ä¾è³´è¡çªï¼Ÿ

5. **Registry åŒæ­¥**
   - æª”æ¡ˆç³»çµ±èˆ‡ Registry ä¸åŒæ­¥æ™‚å¦‚ä½•è™•ç†ï¼Ÿ
   - æ˜¯å¦éœ€è¦ã€ŒRegistry å„ªå…ˆã€æ¨¡å¼ï¼Ÿ

---

## å¯¦æ–½è·¯ç·šåœ–

### v0.3.2 - æ–‡å­—æ¨¡æ¿æ”¹ç‰ˆ (ç•¶å‰è¦åŠƒ) â¸ï¸ **æš«ç·©å¯¦æ–½**

**ç›®æ¨™**: è®“æ–‡å­—æ¨¡æ¿å¯ä»¥ç›´æ¥ç”¨ç·¨è¼¯å™¨ç·¨è¼¯

**èƒŒæ™¯**: ç¶“éæ·±å…¥è¨è«–å¾Œï¼Œç™¼ç¾å–®ç´”çš„æ¨¡æ¿æ”¹ç‰ˆç„¡æ³•å……åˆ†ç™¼æ®å¤šå½¢æ…‹æ¶æ§‹çš„æ½›åŠ›ã€‚**æ±ºå®šæš«ç·© v0.3.2ï¼Œç›´æ¥é€²å…¥ v0.4.0 ç©æœ¨ç³»çµ±é–‹ç™¼**ã€‚

#### ä¸‰ç¨®å¯èƒ½é¸é …çš„åˆ†æ

åœ¨è¨è«–éç¨‹ä¸­è€ƒæ…®äº†ä¸‰ç¨®å¯èƒ½çš„ v0.3.2 å¯¦æ–½æ–¹æ¡ˆï¼š

**é¸é … Aï¼šä¿å®ˆå‡ç´šï¼ˆåŸå§‹æ–¹æ¡ˆï¼‰**
```
ç•¶å‰: templates/{language}/{category}/templates/{name}/
æ”¹ç‚º: templates/{language}/{category}/templates/{name}/
        â”œâ”€â”€ code.{ext}
        â”œâ”€â”€ README.md
        â”œâ”€â”€ meta.json
        â””â”€â”€ examples/
```

âœ… **å„ªé»**:
- æœ€å°æ”¹å‹•ï¼Œé¢¨éšªä½
- å‘å¾Œå…¼å®¹æ€§å¥½
- å¿«é€Ÿå¯¦æ–½ï¼ˆ1-2 é€±ï¼‰

âŒ **ç¼ºé»**:
- ç„¡æ³•å……åˆ†åˆ©ç”¨å¤šå½¢æ…‹æ¶æ§‹
- æœªä¾†ä»éœ€å¤§è¦æ¨¡é‡æ§‹
- ã€Œéæ¸¡æ€§ã€è¨­è¨ˆï¼ŒæŠ•è³‡å›å ±ç‡ä½

**é¸é … Bï¼šä¸­åº¦é‡æ§‹**
```
forms/
â”œâ”€â”€ _index/                    # å…¨å±€ç´¢å¼•
â”œâ”€â”€ sequence/{language}/...    # é·ç§»ç¾æœ‰ templates/
â””â”€â”€ (é ç•™ structure/, topology/)
```

âœ… **å„ªé»**:
- é–‹å§‹å»ºç«‹ forms/ æ¶æ§‹
- ç‚ºæœªä¾†æ“´å±•å¥ å®šåŸºç¤
- æŠ•è³‡ä¸æœƒæµªè²»

âŒ **ç¼ºé»**:
- ä¸­ç­‰è¤‡é›œåº¦
- éœ€è¦è³‡æ–™é·ç§»å·¥å…·
- å¯èƒ½å¼•å…¥é¢¨éšª

**é¸é … Cï¼šå®Œæ•´å¯¦ä½œï¼ˆæ¿€é€²æ–¹æ¡ˆï¼‰**
```
forms/
â”œâ”€â”€ _index/              # å®Œæ•´ç´¢å¼•ç³»çµ±
â”œâ”€â”€ _registry/           # Template Registry
â”œâ”€â”€ sequence/            # å®Œæ•´åºåˆ—å½¢æ…‹
â”œâ”€â”€ structure/           # å®Œæ•´ç©æœ¨ç³»çµ±
â””â”€â”€ topology/            # å®Œæ•´åœ–è­œç³»çµ±
```

âœ… **å„ªé»**:
- ä¸€æ¬¡åˆ°ä½ï¼Œé¿å…å¤šæ¬¡é‡æ§‹
- å®Œæ•´é«”é©—å¤šå½¢æ…‹æ¶æ§‹åƒ¹å€¼
- é•·æœŸæŠ•è³‡å›å ±ç‡æœ€é«˜

âŒ **ç¼ºé»**:
- é–‹ç™¼æ™‚é–“é•·ï¼ˆ2-3 å€‹æœˆï¼‰
- è¤‡é›œåº¦é«˜
- é¢¨éšªè¼ƒå¤§

#### æœ€çµ‚æ±ºç­–ï¼šç›´æ¥é€²å…¥ v0.4.0

**ç†ç”±**:
1. **é¸é … A åƒ¹å€¼æœ‰é™** - ã€Œéæ¸¡æ€§ã€è¨­è¨ˆæœƒé€ æˆäºŒæ¬¡é‡æ§‹ï¼Œä¸å¦‚ç›´æ¥é€²å…¥ä¸‹ä¸€éšæ®µ
2. **é¸é … B ä¸ä¸Šä¸ä¸‹** - æ—¢æ‰¿æ“”äº†éƒ¨åˆ†é¢¨éšªï¼Œåˆç„¡æ³•å……åˆ†é«”é©—å¤šå½¢æ…‹æ¶æ§‹
3. **é¸é … C èˆ‡ v0.4.0 é‡ç–Š** - ä¸å¦‚ç›´æ¥é€²å…¥ v0.4.0ï¼Œç²å¾—å®Œæ•´åƒ¹å€¼

**ç­–ç•¥èª¿æ•´**:
- â¸ï¸ **æš«ç·©** v0.3.2 æ¨¡æ¿æ”¹ç‰ˆ
- ğŸš€ **ç›´æ¥é–‹å§‹** v0.4.0 ç©æœ¨ç³»çµ±é–‹ç™¼
- ğŸ“‹ **ç›®å‰ç‹€æ…‹** v0.3.1 ä¿æŒç©©å®šï¼Œç¹¼çºŒè¨­è¨ˆèˆ‡è¦åŠƒéšæ®µ

**ç”¨æˆ¶å¼•ç”¨**:
> "ç¾åœ¨é‚„æœ‰å¾ˆå¤šè¦ä»”ç´°è¨è«–èˆ‡æ€è€ƒçš„åœ°æ–¹ï¼Œä¸ç”¨æ€¥è‘—å¯¦ä½œï¼Œç¾åœ¨é‚„åœ¨è¨­è¨ˆåŠåˆ†æéœ€æ±‚ã€‚"

---

### v0.4.0 - ç©æœ¨ç³»çµ± (æ ¸å¿ƒ) ğŸ¯ **é‡æ–°è¨­è¨ˆ**

**ç›®æ¨™**: å¯¦ç¾æ–‡å­— â†” ç©æœ¨ é›™å‘è½‰æ›ï¼ˆåŸºæ–¼å››ç´šç©æœ¨ç³»çµ±ï¼‰

**æ ¸å¿ƒç‰¹æ€§**:
1. **å››ç´šç©æœ¨ç³»çµ±** (L0/L1/L2/L3)
   - L0: ç³»çµ±ç´šï¼ˆå¤šæ¨¡æ¿çµ„åˆï¼‰
   - L1: æ¨¡æ¿ç´šï¼ˆå®Œæ•´ç¨‹å¼ï¼‰
   - L2: èªå¥ç´šï¼ˆæ§åˆ¶çµæ§‹ï¼‰
   - L3: è¡¨é”å¼ç´šï¼ˆé‹ç®—å…ƒç´ ï¼‰

2. **å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶**
   - ç©æœ¨å¯å±•é–‹æŸ¥çœ‹å…§éƒ¨ç´°ç¯€
   - æ”¯æ´å¤šå±¤ç´šå±•é–‹ï¼ˆL0â†’L1â†’L2â†’L3ï¼‰
   - Structure Form ç‰ˆæœ¬æ§åˆ¶

3. **å°æ‡‰é—œä¿‚ç®¡ç†**
   - è‡ªå‹•å»ºç«‹ Sequence â†” Structure å°æ‡‰
   - å°æ‡‰é—œä¿‚é©—è­‰èˆ‡åŒæ­¥
   - è¡çªè§£æ±ºæ©Ÿåˆ¶

4. **Template Registry**
   - é›†ä¸­å¼æ¨¡æ¿/ç©æœ¨ç®¡ç†
   - ä¾è³´è¿½è¹¤èˆ‡ç‰ˆæœ¬æ§åˆ¶
   - å¿«é€ŸæŸ¥è©¢èˆ‡æª¢ç´¢

**å¯¦æ–½ç¯„åœ**:
- âœ… å»ºç«‹ templates/ çŸ¥è­˜å–®å…ƒæ¶æ§‹
  - templates/{language-level}/ - æŒ‰èªè¨€å±¤ç´šçµ„ç¹”
  - æ¯å€‹æ¨¡æ¿åŒ…å«å®Œæ•´çš„ä¸‰å½¢æ…‹æª”æ¡ˆï¼ˆsequence.*, structure.*, topology.*ï¼‰
  - templates/_registry/ - Template Registry
  - çµ±ä¸€çš„ meta.json æ ¼å¼ï¼ˆv3.0ï¼‰

- âœ… ç©æœ¨ç³»çµ±æ ¸å¿ƒ
  - L0/L1/L2/L3 ç©æœ¨å®šç¾©
  - é€šç”¨ç©æœ¨åº«ï¼ˆuniversal blocksï¼‰
  - èªè¨€ç‰¹å®šç©æœ¨ï¼ˆC, Python, JavaScriptï¼‰
  - å±•é–‹/æ‘ºç–Šæ©Ÿåˆ¶

- âœ… è½‰æ›å¼•æ“
  - Sequence â†’ Structure (çµæ§‹åŒ–)
  - Structure â†’ Sequence (åºåˆ—åŒ–)
  - ä¿¡å¿ƒåº¦è©•ä¼°
  - æå¤±è¿½è¹¤

- âœ… å°æ‡‰é—œä¿‚ç³»çµ±
  - å°æ‡‰é—œä¿‚ç´¢å¼• (mappings.json)
  - è‡ªå‹•æ¨è–¦å¼•æ“
  - é©—è­‰èˆ‡åŒæ­¥æ©Ÿåˆ¶
  - è¡çªè§£æ±º UI

- âœ… Registry ç³»çµ±
  - SQLite è³‡æ–™åº«
  - è¨»å†Šèˆ‡æŸ¥è©¢ API
  - ä¾è³´ç®¡ç†
  - ç‰ˆæœ¬æ§åˆ¶

- âœ… UI é¢æ¿
  - Blockly Editor Panelï¼ˆåŸºç¤ç‰ˆï¼‰
  - å±•é–‹/æ‘ºç–Šæ§åˆ¶
  - å°æ‡‰é—œä¿‚ç®¡ç†ä»‹é¢

**æ™‚ç¨‹**: 3-4 å€‹æœˆ

**é‡Œç¨‹ç¢‘**:
- **Month 1**: forms/ æ¶æ§‹ + L1/L2 ç©æœ¨ç³»çµ±
- **Month 2**: è½‰æ›å¼•æ“ + å°æ‡‰é—œä¿‚ç³»çµ±
- **Month 3**: Registry + å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶
- **Month 4**: UI æ•´åˆ + æ¸¬è©¦å„ªåŒ–

---

### v0.4.x - ç©æœ¨ç³»çµ±å¢å¼·

**v0.4.1 - L3 è¡¨é”å¼ç´šç©æœ¨**
- âœ… L3 ç²’åº¦æ”¯æ´
- âœ… è¡¨é”å¼ç´šç©æœ¨å®šç¾©
- âœ… ç´°ç²’åº¦è½‰æ›

**v0.4.2 - è·¨èªè¨€è½‰æ›**
- âœ… C â†” Python åŸºç¤è½‰æ›
- âœ… Transformation Assistant åŸºç¤ç‰ˆ
- âœ… è½‰æ›æ¨¡å¼åº«

**v0.4.3 - å„ªåŒ–èˆ‡ç©©å®š**
- âœ… æ•ˆèƒ½å„ªåŒ–
- âœ… éŒ¯èª¤è™•ç†å¢å¼·
- âœ… ä½¿ç”¨è€…é«”é©—æ”¹å–„

**é è¨ˆæ™‚ç¨‹**: v0.4.0 å®Œæˆå¾Œ 2-3 å€‹æœˆ

### v0.5.0 - åœ–è­œç³»çµ± (å®Œæ•´) ğŸŒ

**ç›®æ¨™**: å¯¦ç¾ä¸‰å½¢æ…‹å®Œæ•´è½‰æ›ï¼ˆSequence â†” Structure â†” Topologyï¼‰

**æ ¸å¿ƒç‰¹æ€§**:
1. **å››ç¨®åœ–è­œé¡å‹**
   - Call Graphï¼ˆå‘¼å«åœ–ï¼‰- å‡½å¼å‘¼å«é—œä¿‚
   - Data Flowï¼ˆæ•¸æ“šæµåœ–ï¼‰- æ•¸æ“šæµå‘è¿½è¹¤
   - Dependency Graphï¼ˆä¾è³´åœ–ï¼‰- æ¨¡çµ„ä¾è³´é—œä¿‚
   - Control Flowï¼ˆæ§åˆ¶æµåœ–ï¼‰- ç¨‹å¼åŸ·è¡Œè·¯å¾‘

2. **æ··åˆäº’å‹•æ¨¡å¼**
   - Call Graph: å”¯è®€ + å¯èª¿æ•´å¸ƒå±€
   - Data Flow: å”¯è®€ + å¯èª¿æ•´å¸ƒå±€
   - Dependency Graph: å¯ç·¨è¼¯çµæ§‹
   - Control Flow: å”¯è®€

3. **å…­ç¨®å¸ƒå±€ç®—æ³•**
   - Hierarchicalï¼ˆéšå±¤å¼ï¼‰
   - Force-Directedï¼ˆåŠ›å°å‘ï¼‰
   - Circularï¼ˆç’°å½¢ï¼‰
   - Orthogonalï¼ˆæ­£äº¤ï¼‰
   - Radialï¼ˆè¼»å°„ï¼‰
   - Layeredï¼ˆåˆ†å±¤ï¼‰

4. **æ™ºæ…§å¸ƒå±€æ¨è–¦**
   - æ ¹æ“šåœ–è­œç‰¹å¾µè‡ªå‹•æ¨è–¦å¸ƒå±€
   - ä½¿ç”¨è€…å¯æ‰‹å‹•åˆ‡æ›
   - å¸ƒå±€åƒæ•¸å¯èª¿æ•´

**å¯¦æ–½ç¯„åœ**:
- âœ… åœ–è­œè³‡æ–™çµæ§‹
  - Graph, Node, Edge å®šç¾©
  - åœ–è­œé¡å‹ç³»çµ±
  - åœ–è­œåºåˆ—åŒ–æ ¼å¼

- âœ… åœ–è­œç”Ÿæˆå¼•æ“
  - Sequence â†’ Topology (AST åˆ†æ)
  - Structure â†’ Topology (ç©æœ¨éæ­·)
  - é—œä¿‚æå–æ¼”ç®—æ³•

- âœ… åœ–è­œè½‰æ›å¼•æ“
  - Topology â†’ Sequence (æ‹“æ’²æ’åº)
  - Topology â†’ Structure (æ¨¡å¼åŒ¹é…)

- âœ… å¸ƒå±€ç³»çµ±
  - å…­ç¨®å¸ƒå±€ç®—æ³•å¯¦ä½œ
  - è‡ªå‹•å¸ƒå±€æ¨è–¦
  - å¸ƒå±€åƒæ•¸ UI

- âœ… äº’å‹•ç³»çµ±
  - å”¯è®€æ¨¡å¼ï¼ˆæŸ¥çœ‹ã€ç¸®æ”¾ï¼‰
  - å¯ç·¨è¼¯æ¨¡å¼ï¼ˆæ–°å¢ã€åˆªé™¤ã€é€£æ¥ï¼‰
  - å¸ƒå±€èª¿æ•´æ¨¡å¼

- âœ… Node Flow Panel
  - åœ–è­œæ¸²æŸ“å¼•æ“
  - äº’å‹•æ§åˆ¶
  - å¸ƒå±€åˆ‡æ›å™¨
  - åŒ¯å‡ºåŠŸèƒ½

**æ™‚ç¨‹**: 3-4 å€‹æœˆ

**é‡Œç¨‹ç¢‘**:
- **Month 1**: åœ–è­œè³‡æ–™çµæ§‹ + ç”Ÿæˆå¼•æ“
- **Month 2**: å¸ƒå±€ç®—æ³• + è‡ªå‹•æ¨è–¦
- **Month 3**: äº’å‹•ç³»çµ± + Node Flow Panel
- **Month 4**: å„ªåŒ– + æ•´åˆæ¸¬è©¦

---

### v0.5.x - åœ–è­œç³»çµ±å¢å¼·

**v0.5.1 - é€²éšåœ–è­œåˆ†æ**
- âœ… åœ–è­œç°¡åŒ–æ¼”ç®—æ³•
- âœ… é—œéµè·¯å¾‘åˆ†æ
- âœ… å¾ªç’°åµæ¸¬

**v0.5.2 - ç¨‹å¼ç¢¼é‡æ§‹å·¥å…·**
- âœ… åŸºæ–¼åœ–è­œçš„é‡æ§‹å»ºè­°
- âœ… ä¾è³´è§£è€¦åˆ†æ
- âœ… ç¨‹å¼ç¢¼æ¨¡çµ„åŒ–å»ºè­°

**v0.5.3 - æ•ˆèƒ½å„ªåŒ–**
- âœ… å¤§å‹åœ–è­œæ‡¶è¼‰å…¥
- âœ… å±¤ç´šç¸®æ”¾
- âœ… è¦–è¦ºåŒ–å„ªåŒ–

**é è¨ˆæ™‚ç¨‹**: v0.5.0 å®Œæˆå¾Œ 2-3 å€‹æœˆ

---

### v0.6.0 - è‡ªç„¶èªè¨€æ¨¡æ¿ç³»çµ± ğŸ“ **v3.0 æ–°å¢**

> **v3.0 æ ¸å¿ƒæ›´æ–°**ï¼šè‡ªç„¶èªè¨€æˆç‚ºç¬¬ä¸€ç­‰å…¬æ°‘ï¼Œæ”¯æ´ Spec-Driven Development

**ç›®æ¨™**: å°‡è‡ªç„¶èªè¨€æå‡ç‚ºèˆ‡ç¨‹å¼èªè¨€åŒç­‰çš„èªè¨€å±¤ç´šï¼Œæ”¯æ´è¦æ ¼é©…å‹•é–‹ç™¼å·¥ä½œæµ

**æ ¸å¿ƒç‰¹æ€§**:

1. **Spec Template ç³»çµ±**
   - Markdown è¦æ ¼æ¨¡æ¿
   - çµæ§‹åŒ–æ¬„ä½ï¼ˆMethod, Path, Request, Responseï¼‰
   - æ¦‚å¿µå‹è®Šæ•¸ç³»çµ±ï¼ˆ{{concept:http-method}}ï¼‰
   - ç¯„ä¾‹èˆ‡æ¸¬è©¦æ¡ˆä¾‹

2. **SpecKit æ·±åº¦æ•´åˆ**
   - /specify éšæ®µçš„æ¨¡æ¿å»ºè­°
   - /implement éšæ®µçš„ Code Template æ¨è–¦
   - spec.md â†” template é›™å‘åŒæ­¥
   - Spec è®Šæ›´è¿½è¹¤

3. **æ¦‚å¿µç®¡ç†ç³»çµ±ï¼ˆPhase 2ï¼‰**
   - é¡å‹åŒ–æ¦‚å¿µï¼ˆConcept Typesï¼‰
   - æ¦‚å¿µé©—è­‰ï¼ˆValidation Rulesï¼‰
   - æ¦‚å¿µé—œä¿‚ï¼ˆConcept Graphï¼‰
   - å¯é‡ç”¨æ¦‚å¿µåº«

4. **Natural Language ä¸‰å½¢æ…‹**
   - Sequence: Markdown æ–‡å­—è¦æ ¼
   - Structure: æ¦‚å¿µç©æœ¨ï¼ˆBlockly for Specsï¼‰
   - Topology: æ¦‚å¿µåœ–ï¼ˆConcept Mapï¼‰

**å¯¦æ–½ç¯„åœ**:

- âœ… **Spec Template æ ¼å¼**
  - Markdown æ¨¡æ¿è§£æå™¨
  - çµæ§‹åŒ–æ¬„ä½æå–
  - è®Šæ•¸ç³»çµ± v2ï¼ˆé¡å‹åŒ–æ¦‚å¿µï¼‰
  - æ¨¡æ¿é©—è­‰å™¨

- âœ… **SpecKit æ•´åˆ**
  - .speckit/ ç›®éŒ„çµæ§‹æ”¯æ´
  - /specify éšæ®µé‰¤å­
  - /implement éšæ®µå»ºè­°
  - Spec-Code å°æ‡‰é—œä¿‚

- âœ… **æ¦‚å¿µç®¡ç†**
  - Concept Type å®šç¾©
  - Concept Validation
  - Concept æŸ¥è©¢èˆ‡æ¨è–¦
  - Concept Graphï¼ˆåŸºç¤ç‰ˆï¼‰

- âœ… **è‡ªç„¶èªè¨€è½‰æ›**
  - Natural Language â†’ High-Level Codeï¼ˆé€é Coding Agentï¼‰
  - Code â†’ Natural Language Specï¼ˆæ–‡æª”ç”Ÿæˆï¼‰
  - Spec â†” Structureï¼ˆæ¦‚å¿µç©æœ¨ï¼‰

- âœ… **UI å¢å¼·**
  - Spec Template ç·¨è¼¯å™¨
  - æ¦‚å¿µç€è¦½å™¨
  - Spec-Code å°æ‡‰è¦–åœ–
  - SpecKit å·¥ä½œæµæ•´åˆ

**æ™‚ç¨‹**: 3-4 å€‹æœˆ

**é‡Œç¨‹ç¢‘**:
- **Month 1**: Spec Template æ ¼å¼ + è§£æå™¨
- **Month 2**: SpecKit æ•´åˆ + å·¥ä½œæµ
- **Month 3**: æ¦‚å¿µç®¡ç†ç³»çµ±ï¼ˆPhase 2ï¼‰
- **Month 4**: è‡ªç„¶èªè¨€è½‰æ› + UI æ•´åˆ

**ä¾è³´é—œä¿‚**:
- éœ€è¦ v0.4.0 çš„ Registry ç³»çµ±
- éœ€è¦ v0.5.0 çš„è½‰æ›å¼•æ“åŸºç¤
- èˆ‡ SpecKit åœ˜éšŠå”ä½œï¼ˆå¯èƒ½ï¼‰

---

### v0.6.x - è‡ªç„¶èªè¨€å¢å¼·

**v0.6.1 - çŸ¥è­˜åœ–è­œï¼ˆPhase 3ï¼‰**
- âœ… æ¦‚å¿µåœ–å®Œæ•´å¯¦ä½œ
- âœ… æ¦‚å¿µé—œä¿‚æ¨ç†
- âœ… çŸ¥è­˜æŸ¥è©¢èªè¨€

**v0.6.2 - AI è¼”åŠ©è¦æ ¼ç”Ÿæˆ**
- âœ… å¾å°è©±ç”Ÿæˆè¦æ ¼
- âœ… è¦æ ¼è£œå…¨å»ºè­°
- âœ… è¦æ ¼å“è³ªæª¢æŸ¥

**v0.6.3 - å¤šèªè¨€è¦æ ¼**
- âœ… ä¸­æ–‡ Spec Template
- âœ… æ—¥æ–‡ Spec Template
- âœ… å¤šèªè¨€æ¦‚å¿µå°æ‡‰

**é è¨ˆæ™‚ç¨‹**: v0.6.0 å®Œæˆå¾Œ 2-3 å€‹æœˆ

---

### v0.7.0 - åº•å±¤èˆ‡ç¡¬é«”é–‹ç™¼æ”¯æ´ âš™ï¸ **v3.0 æ–°å¢**

> **v3.0 æ ¸å¿ƒæ›´æ–°**ï¼šæ“´å±•åˆ°ä½éšèªè¨€ã€æ©Ÿå™¨èªè¨€ã€HDL å’Œå¯¦é«”é›»è·¯

**ç›®æ¨™**: æ”¯æ´å®Œæ•´çš„æŠ½è±¡å±¤ç´šï¼Œå¾è‡ªç„¶èªè¨€åˆ°ç‰©ç†é›»è·¯

**æ ¸å¿ƒç‰¹æ€§**:

1. **Assembly æ¨¡æ¿ç³»çµ±**
   - x86-64, ARM, RISC-V æ”¯æ´
   - æŒ‡ä»¤ç´šæ¨¡æ¿ï¼ˆL3ï¼‰
   - æš«å­˜å™¨åˆ†é…æ¨¡å¼
   - ç³»çµ±å‘¼å«æ¨¡æ¿

2. **HDL æ¨¡æ¿ç³»çµ±**
   - Verilog, VHDL, SystemVerilog
   - æ¨¡çµ„æ¨¡æ¿ï¼ˆL1ï¼‰
   - åŸºæœ¬å…ƒä»¶æ¨¡æ¿ï¼ˆL2ï¼‰
   - æ™‚åºåœ–ç”Ÿæˆ

3. **Machine Code å¯è¦–åŒ–**
   - æŒ‡ä»¤ç·¨ç¢¼é¡¯ç¤º
   - ç®¡ç·šåœ–ï¼ˆTopologyï¼‰
   - åŸ·è¡Œè¿½è¹¤

4. **æ’ä»¶ç³»çµ±æ·±åŒ–**
   - Assembly Pluginï¼ˆæš«å­˜å™¨ã€é€±æœŸï¼‰
   - HDL Pluginï¼ˆæ™‚åºã€è³‡æºã€ç¶œåˆï¼‰
   - Machine Code Pluginï¼ˆæ€§èƒ½åˆ†æï¼‰

**å¯¦æ–½ç¯„åœ**:

- âœ… **Assembly æ”¯æ´**
  - ä¸‰å¤§æ¶æ§‹æ¨¡æ¿åº«ï¼ˆx86-64, ARM, RISC-Vï¼‰
  - æŒ‡ä»¤ç©æœ¨ï¼ˆBlockly for Assemblyï¼‰
  - æš«å­˜å™¨æµç¨‹åœ–ï¼ˆTopologyï¼‰
  - çµ„åˆèªè¨€ â†” æ©Ÿå™¨ç¢¼è½‰æ›

- âœ… **HDL æ”¯æ´**
  - Verilog/VHDL æ¨¡æ¿åº«
  - æ¨¡çµ„ç©æœ¨ï¼ˆHierarchical Blocksï¼‰
  - RTL åœ–ï¼ˆSchematic Topologyï¼‰
  - HDL â†” ç¶²è¡¨è½‰æ›

- âœ… **Machine Code æ”¯æ´**
  - æŒ‡ä»¤ç·¨ç¢¼æ¨¡æ¿
  - ç®¡ç·šåœ–ç”Ÿæˆ
  - åŸ·è¡Œè¿½è¹¤è¦–è¦ºåŒ–

- âœ… **æ’ä»¶ç³»çµ±**
  - Assembly Pluginï¼ˆå®Œæ•´ç‰ˆï¼‰
  - HDL Pluginï¼ˆå®Œæ•´ç‰ˆï¼‰
  - æ’ä»¶ API v2ï¼ˆæ”¯æ´æ‰€æœ‰èªè¨€å±¤ç´šï¼‰

- âœ… **å·¥å…·éˆæ•´åˆ**
  - nasm, gas æ•´åˆï¼ˆAssemblyï¼‰
  - Vivado, Quartus æ•´åˆï¼ˆHDLï¼‰
  - objdump æ•´åˆï¼ˆMachine Codeï¼‰

- âœ… **UI å¢å¼·**
  - é›™çª—æ ¼ç·¨è¼¯å™¨ï¼ˆCode + Binary/Schematicï¼‰
  - æš«å­˜å™¨/è³‡æºç›£è¦–å™¨
  - æ™‚åºåˆ†æè¦–åœ–

**æ™‚ç¨‹**: 3-4 å€‹æœˆ

**é‡Œç¨‹ç¢‘**:
- **Month 1**: Assembly æ¨¡æ¿ + æ’ä»¶
- **Month 2**: HDL æ¨¡æ¿ + RTL åœ–
- **Month 3**: Machine Code å¯è¦–åŒ– + æ’ä»¶ API v2
- **Month 4**: å·¥å…·éˆæ•´åˆ + UI å¢å¼·

**ç‰¹æ®Šéœ€æ±‚**:
- éœ€è¦ç¡¬é«”èƒŒæ™¯å°ˆå®¶å”ä½œ
- éœ€è¦ç²¾ç¢ºçš„ä½å…ƒå±¤ç´šè™•ç†
- éœ€è¦èˆ‡ç¡¬é«”å·¥å…·éˆæ·±åº¦æ•´åˆ

---

### v0.7.x - åº•å±¤é–‹ç™¼å¢å¼·

**v0.7.1 - æ€§èƒ½åˆ†æå·¥å…·**
- âœ… æŒ‡ä»¤é€±æœŸåˆ†æ
- âœ… è³‡æºä½¿ç”¨åˆ†æï¼ˆHDLï¼‰
- âœ… ç†±é»æª¢æ¸¬

**v0.7.2 - å„ªåŒ–å»ºè­°**
- âœ… çµ„åˆèªè¨€å„ªåŒ–æ¨¡å¼
- âœ… HDL ç¶œåˆå„ªåŒ–
- âœ… æ©Ÿå™¨ç¢¼å°é½Šå„ªåŒ–

**v0.7.3 - é™¤éŒ¯æ”¯æ´**
- âœ… æš«å­˜å™¨ç›£è¦–
- âœ… æ³¢å½¢åœ–ï¼ˆHDLï¼‰
- âœ… æ–·é»èˆ‡å–®æ­¥åŸ·è¡Œ

**é è¨ˆæ™‚ç¨‹**: v0.7.0 å®Œæˆå¾Œ 2-3 å€‹æœˆ

---

### v1.0 - çµ±ä¸€å¤šèªè¨€å¹³å° + ç¤¾ç¾¤èˆ‡ AI ğŸš€ **v3.0 æ›´æ–°**

**ç›®æ¨™**: å®Œæ•´çš„è·¨èªè¨€å±¤ç´šå¤šå½¢æ…‹å¹³å°ï¼Œæ•´åˆ AI èˆ‡ç¤¾ç¾¤

**v3.0 æ›´æ–°**: å¾ã€Œç¨‹å¼ç¢¼æ¨¡æ¿å·¥å…·ã€å‡ç´šç‚ºã€Œè·¨èªè¨€å±¤ç´šçŸ¥è­˜å¹³å°ã€

**æ ¸å¿ƒç‰¹æ€§**:

1. **çµ±ä¸€èªè¨€æ¶æ§‹**
   - 6 å€‹èªè¨€å±¤ç´šå®Œæ•´æ”¯æ´ï¼ˆNatural â†’ Physicalï¼‰
   - è·¨å±¤ç´šè½‰æ›ï¼ˆå¦‚ Spec â†’ HDL ç›´é€šï¼‰
   - çµ±ä¸€çš„å…ƒè³‡æ–™èˆ‡è¨»è§£ç³»çµ±
   - é ˜åŸŸæ’ä»¶ç”Ÿæ…‹ç³»çµ±

2. **AI æ·±åº¦æ•´åˆ**
   - è‡ªç„¶èªè¨€ç†è§£ï¼ˆSpec ç”Ÿæˆï¼‰
   - æ™ºæ…§è½‰æ›å»ºè­°ï¼ˆè·¨èªè¨€ã€è·¨å½¢æ…‹ï¼‰
   - ç¨‹å¼ç¢¼è£œå…¨èˆ‡å„ªåŒ–
   - è¨­è¨ˆæ„åœ–æ¨ç†

3. **ç¤¾ç¾¤å¹³å°**
   - è·¨èªè¨€å±¤ç´šçš„æ¨¡æ¿åˆ†äº«
   - æ’ä»¶å¸‚å ´
   - å”ä½œé–‹ç™¼ï¼ˆå¤šäººç·¨è¼¯ Spec/Code/HDLï¼‰
   - å“è³ªèªè­‰ç³»çµ±

4. **ä¼æ¥­åŠŸèƒ½**
   - åœ˜éšŠæ¨¡æ¿åº«ç®¡ç†
   - æ¬Šé™èˆ‡å¯©æ ¸æµç¨‹
   - ä½¿ç”¨åˆ†æèˆ‡å ±å‘Š
   - ç§æœ‰éƒ¨ç½²æ”¯æ´

**å¯¦æ–½ç¯„åœ**:

- âœ… **çµ±ä¸€èªè¨€å¹³å°**
  - å®Œæ•´çš„ 6 å±¤ç´šæ”¯æ´
  - è·¨å±¤ç´šè½‰æ›å¼•æ“
  - çµ±ä¸€ Registryï¼ˆæ”¯æ´æ‰€æœ‰å±¤ç´šï¼‰
  - æ’ä»¶ç”Ÿæ…‹ç³»çµ±

- âœ… **AI èƒ½åŠ›**
  - æ”¶æ–‚æ€§åˆ†æèˆ‡å„ªåŒ–
  - è‡ªç·¨ç¢¼è¨“ç·´è³‡æ–™æ”¶é›†
  - AI æ„åœ–ç†è§£
  - æ™ºæ…§è½‰æ›å»ºè­°ï¼ˆè·¨èªè¨€ã€è·¨å±¤ç´šï¼‰
  - è¨­è¨ˆæ±ºç­–æ¨ç†

- âœ… **ç¤¾ç¾¤åŠŸèƒ½**
  - æ¨¡æ¿/ç©æœ¨/åœ–è­œåˆ†äº«
  - æ’ä»¶å¸‚å ´
  - è©•åˆ†èˆ‡è©•è«–ç³»çµ±
  - å”ä½œåŠŸèƒ½

- âœ… **ä¼æ¥­åŠŸèƒ½**
  - åœ˜éšŠç®¡ç†
  - ç§æœ‰æ¨¡æ¿åº«
  - å¯©æ ¸å·¥ä½œæµ
  - ä½¿ç”¨çµ±è¨ˆ

**æ™‚ç¨‹**: 6-12 å€‹æœˆ

**é‡Œç¨‹ç¢‘**:
- **Quarter 1**: çµ±ä¸€èªè¨€å¹³å°åŸºç¤
- **Quarter 2**: AI èƒ½åŠ›é–‹ç™¼
- **Quarter 3**: ç¤¾ç¾¤å¹³å°å»ºè¨­
- **Quarter 4**: ä¼æ¥­åŠŸèƒ½ + ç©©å®šåŒ–

**æˆåŠŸæŒ‡æ¨™**:
- æ”¯æ´æ‰€æœ‰ 6 å€‹èªè¨€å±¤ç´š
- ç¤¾ç¾¤è²¢ç» 1000+ æ¨¡æ¿
- æ’ä»¶ç”Ÿæ…‹ 50+ æ’ä»¶
- ä¼æ¥­å®¢æˆ¶æ¡ç”¨

---

## é–‹æ”¾å•é¡Œ

ä»¥ä¸‹æ˜¯å°šæœªå®Œå…¨è§£æ±ºã€éœ€è¦é€²ä¸€æ­¥è¨è«–çš„å•é¡Œï¼š

---

### æ ¸å¿ƒæ¶æ§‹å•é¡Œ

#### 1. ç©æœ¨å±•é–‹æ‘ºç–Šçš„è¦–è¦ºå‘ˆç¾ ğŸ”

**å•é¡Œ**: L0 ç³»çµ±ç´šç©æœ¨æ‡‰è©²å¦‚ä½•è¦–è¦ºåŒ–å‘ˆç¾ï¼Ÿ

**é¸é …**:
- A. ã€Œè¶…ç´šç©æœ¨ã€- ç‰¹æ®Šçš„å¤§å‹ç©æœ¨
- B. ã€Œå®¹å™¨ç©æœ¨ã€- å¯å®¹ç´å…¶ä»–ç©æœ¨çš„å®¹å™¨
- C. ã€Œåˆ†é ç³»çµ±ã€- ä½¿ç”¨ Tab åˆ‡æ›ä¸åŒæ¨¡æ¿

**å¾…è¨è«–**:
- å“ªç¨®æ–¹å¼æœ€ç›´è¦ºï¼Ÿ
- å¦‚ä½•è™•ç†å¤§é‡æ¨¡æ¿çš„æƒ…æ³ï¼ˆ10+ å€‹æ¨¡æ¿ï¼‰ï¼Ÿ
- æ˜¯å¦æ”¯æ´å·¢ç‹€å®¹å™¨ï¼Ÿ

---

#### 2. å¤šå±¤ç´šå±•é–‹çš„è¦–åœ–ç®¡ç† ğŸ“±

**å•é¡Œ**: ç•¶åŒæ™‚å±•é–‹å¤šå€‹å±¤ç´šæ™‚ï¼ˆL0â†’L1â†’L2ï¼‰ï¼Œå¦‚ä½•é¿å…ç•«é¢æ··äº‚ï¼Ÿ

**é¸é …**:
- A. å–ä»£åŸç©æœ¨ï¼ˆå±•é–‹å¾Œéš±è—åŸæœ¬çš„æ‘ºç–Šç©æœ¨ï¼‰
- B. ä¸¦æ’é¡¯ç¤ºï¼ˆåŸç©æœ¨ + å±•é–‹è¦–åœ–ï¼‰
- C. è¦†è“‹é¡¯ç¤ºï¼ˆmodal æˆ– overlayï¼‰
- D. åˆ†é é¡¯ç¤ºï¼ˆä¸åŒå±¤ç´šåœ¨ä¸åŒ tabï¼‰

**å¾…è¨è«–**:
- å¦‚ä½•æ¨™ç¤ºç•¶å‰å±¤ç´šï¼Ÿ
- æ˜¯å¦éœ€è¦ã€ŒéºµåŒ…å±‘ã€å°èˆªï¼Ÿ
- å¦‚ä½•å¿«é€Ÿè·³å›ä¸Šå±¤ï¼Ÿ

---

#### 3. æ‘ºç–Šåˆ†æ•¸çš„é–¾å€¼è¨­å®š âš–ï¸

**å•é¡Œ**: æ‘ºç–Šåˆ†æ•¸å¤šå°‘æ‰ç®—ã€Œé©åˆæ‘ºç–Šã€ï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**:
```typescript
if (foldingScore.total >= 0.8) {
  // å»ºè­°æ‘ºç–Š
}
```

**å¾…è¨è«–**:
- 0.8 æ˜¯å¦åˆé©ï¼Ÿ
- æ˜¯å¦éœ€è¦ä¾æ“šæƒ…å¢ƒèª¿æ•´ï¼ˆæ•™å­¸ vs. é–‹ç™¼ï¼‰ï¼Ÿ
- ä½¿ç”¨è€…æ˜¯å¦å¯è‡ªè¨‚é–¾å€¼ï¼Ÿ

---

#### 4. å°æ‡‰é—œä¿‚çš„ç²’åº¦ç¯„åœ ğŸ”—

**å•é¡Œ**: å°æ‡‰é—œä¿‚æ‡‰è©²è¨˜éŒ„åˆ°ä»€éº¼ç²’åº¦ï¼Ÿ

**é¸é …**:
- A. åƒ…é ‚å±¤ï¼ˆTemplate â†” L1 Blockï¼‰
- B. åŒ…å« L2ï¼ˆTemplate â†” L1 + L2 ç´°ç¯€ï¼‰
- C. å®Œæ•´è¨˜éŒ„ï¼ˆTemplate â†” L1 + L2 + L3ï¼‰

**è€ƒé‡**:
- **é¸é … A**: ç°¡å–®ï¼Œä½†ç´°ç¯€å°æ‡‰æœƒéºå¤±
- **é¸é … B**: å¹³è¡¡ï¼Œè¨˜éŒ„ä¸»è¦çµæ§‹
- **é¸é … C**: å®Œæ•´ï¼Œä½†è³‡æ–™é‡å¤§ä¸”ç¶­è­·è¤‡é›œ

**å¾…è¨è«–**:
- ç´°ç²’åº¦å°æ‡‰çš„å¯¦éš›åƒ¹å€¼ï¼Ÿ
- ç¶­è­·æˆæœ¬ vs. ä½¿ç”¨åƒ¹å€¼ï¼Ÿ

---

#### 5. å°æ‡‰é—œä¿‚ä¿¡å¿ƒåº¦é–¾å€¼ ğŸ“Š

**å•é¡Œ**: å¤šå°‘ä¿¡å¿ƒåº¦ä»¥ä¸‹è¦–ç‚ºã€Œä¸å¯é å°æ‡‰ã€ï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**:
- ä¿¡å¿ƒåº¦ â‰¥ 0.9: è‡ªå‹•å»ºç«‹å°æ‡‰
- ä¿¡å¿ƒåº¦ 0.6-0.9: æ¨è–¦çµ¦ä½¿ç”¨è€…ç¢ºèª
- ä¿¡å¿ƒåº¦ < 0.6: ä¸æ¨è–¦

**å¾…è¨è«–**:
- é–¾å€¼æ˜¯å¦åˆé©ï¼Ÿ
- ä¸å¯é å°æ‡‰ï¼ˆ< 0.6ï¼‰æ˜¯å¦æ‡‰è©²å®šæœŸæ¸…ç†ï¼Ÿ
- æ¸…ç†é€±æœŸï¼Ÿï¼ˆæ¯é€±ã€æ¯æœˆï¼‰

---

#### 6. åŒæ­¥ç­–ç•¥çš„é è¨­è¡Œç‚º ğŸ”„

**å•é¡Œ**: ç•¶åµæ¸¬åˆ°å°æ‡‰é—œä¿‚ä¸ä¸€è‡´æ™‚ï¼Œé è¨­è¡Œç‚ºæ˜¯ä»€éº¼ï¼Ÿ

**é¸é …**:
- A. è‡ªå‹•åŒæ­¥ï¼ˆé¢¨éšªï¼šå¯èƒ½è¦†è“‹ä½¿ç”¨è€…è®Šæ›´ï¼‰
- B. è©¢å•ä½¿ç”¨è€…ï¼ˆè¼ƒå®‰å…¨ä½†éœ€è¦äº’å‹•ï¼‰
- C. ä¾ä¿®æ”¹é¡å‹æ±ºå®šï¼ˆå°è®Šæ›´è‡ªå‹•ï¼Œå¤§è®Šæ›´è©¢å•ï¼‰

**å¾…è¨è«–**:
- å¦‚ä½•å®šç¾©ã€Œå°è®Šæ›´ã€vsã€Œå¤§è®Šæ›´ã€ï¼Ÿ
- æ˜¯å¦æä¾›ã€ŒéœéŸ³æ¨¡å¼ã€ï¼ˆä¸å†æç¤ºï¼‰ï¼Ÿ
- ä¸åŒä½¿ç”¨è€…è§’è‰²æ˜¯å¦æœ‰ä¸åŒé è¨­ï¼ˆåˆå­¸è€… vs. é€²éšï¼‰ï¼Ÿ

---

#### 7. Transformation Assistant è§¸ç™¼æ™‚æ©Ÿ ğŸ¤–

**å•é¡Œ**: ä»€éº¼æƒ…æ³ä¸‹å•Ÿå‹• Transformation Assistantï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**: ä¿¡å¿ƒåº¦ < 0.9

**å¾…è¨è«–**:
- é–¾å€¼æ˜¯å¦åˆé©ï¼Ÿ
- æ˜¯å¦æä¾›è¨­å®šé¸é …ï¼š
  - ã€Œç¸½æ˜¯è©¢å•ã€æ¨¡å¼ï¼ˆæ‰€æœ‰è½‰æ›éƒ½è©¢å•ï¼‰
  - ã€Œå¾ä¸è©¢å•ã€æ¨¡å¼ï¼ˆä¿¡ä»»ç³»çµ±è‡ªå‹•è½‰æ›ï¼‰
  - ã€Œæ™ºæ…§æ¨¡å¼ã€ï¼ˆé è¨­ï¼Œä¿¡å¿ƒåº¦ < 0.9 æ‰è©¢å•ï¼‰

---

#### 8. åå¥½å­¸ç¿’çš„ç¯„åœèˆ‡éš”é›¢ ğŸ“š

**å•é¡Œ**: ä½¿ç”¨è€…åå¥½æ‡‰è©²æ˜¯å…¨å±€çš„é‚„æ˜¯æ¯å€‹å°ˆæ¡ˆç¨ç«‹ï¼Ÿ

**é¸é …**:
- A. å…¨å±€åå¥½ï¼ˆæ‰€æœ‰å°ˆæ¡ˆå…±ç”¨ï¼‰
- B. å°ˆæ¡ˆåå¥½ï¼ˆæ¯å€‹å°ˆæ¡ˆç¨ç«‹ï¼‰
- C. æ··åˆæ¨¡å¼ï¼ˆå…¨å±€é è¨­ + å°ˆæ¡ˆè¦†è“‹ï¼‰

**ç›¸é—œå•é¡Œ**:
- æ˜¯å¦æ”¯æ´åŒ¯å…¥/åŒ¯å‡ºåå¥½è¨­å®šï¼Ÿ
- åœ˜éšŠå”ä½œæ™‚å¦‚ä½•å…±äº«åå¥½ï¼Ÿ
- æ˜¯å¦éœ€è¦ã€Œåå¥½é…ç½®æª”ã€ï¼ˆé¡ä¼¼ .eslintrcï¼‰ï¼Ÿ

---

### å¯¦ä½œç´°ç¯€å•é¡Œ

#### 9. Transformation Assistant é¸é …æ•¸é‡ä¸Šé™ ğŸ“‹

**å•é¡Œ**: æœ€å¤šé¡¯ç¤ºå¹¾å€‹è½‰æ›é¸é …ï¼Ÿ

**å»ºè­°**: 3-5 å€‹

**å¾…è¨è«–**:
- å¦‚ä½•è™•ç†è¶…éä¸Šé™çš„é¸é …ï¼Ÿ
  - åªé¡¯ç¤ºæœ€é«˜åˆ†çš„ 5 å€‹
  - æä¾›ã€Œé¡¯ç¤ºæ›´å¤šã€æŒ‰éˆ•
  - é€²éšæœå°‹/éæ¿¾åŠŸèƒ½
- åˆå­¸è€… vs. é€²éšä½¿ç”¨è€…æ˜¯å¦æœ‰ä¸åŒä¸Šé™ï¼Ÿ

---

#### 10. èªç¾©é©—è­‰çš„æ·±åº¦ ğŸ”¬

**å•é¡Œ**: å°æ‡‰é—œä¿‚é©—è­‰æ‡‰è©²åšåˆ°å¤šæ·±å…¥ï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**: åŸºæœ¬æª¢æŸ¥ï¼ˆè®Šæ•¸åç¨±ã€æ§åˆ¶çµæ§‹æ•¸é‡ï¼‰

**å¯èƒ½çš„å¢å¼·**:
- æ•¸æ“šæµåˆ†æ
- èªç¾©ç­‰åƒ¹æ€§æ¸¬è©¦
- åŸ·è¡Œæ¸¬è©¦ï¼ˆå¯¦éš›é‹è¡Œç¨‹å¼ç¢¼æ¯”è¼ƒè¼¸å‡ºï¼‰

**å¾…è¨è«–**:
- é©—è­‰æ·±åº¦ vs. æ•ˆèƒ½é–‹éŠ·ï¼Ÿ
- æ˜¯å¦éœ€è¦ã€Œå¿«é€Ÿé©—è­‰ã€å’Œã€Œæ·±åº¦é©—è­‰ã€æ¨¡å¼ï¼Ÿ

---

#### 11. Registry å„²å­˜æ–¹å¼é¸æ“‡ ğŸ’¾

**å•é¡Œ**: SQLite æ˜¯å¦è¶³å¤ ï¼Ÿé‚„æ˜¯éœ€è¦æ›´å¼·å¤§çš„è³‡æ–™åº«ï¼Ÿ

**è€ƒé‡**:
- **SQLite å„ªé»**: è¼•é‡ã€ç„¡éœ€é¡å¤–ä¼ºæœå™¨ã€æ˜“æ–¼éƒ¨ç½²
- **SQLite ç¼ºé»**: ä¸¦ç™¼èƒ½åŠ›æœ‰é™ã€åŠŸèƒ½è¼ƒç°¡å–®

**å¾…è¨è«–**:
- é æœŸçš„æ¨¡æ¿æ•¸é‡è¦æ¨¡ï¼Ÿï¼ˆæ•¸ç™¾ã€æ•¸åƒã€æ•¸è¬ï¼Ÿï¼‰
- æ˜¯å¦éœ€è¦æ”¯æ´åˆ†æ•£å¼ Registryï¼Ÿ
- é›²ç«¯åŒæ­¥éœ€æ±‚ï¼Ÿ

---

#### 12. Registry å¿«å–ç­–ç•¥ âš¡

**å•é¡Œ**: å¿«å–çš„æœ‰æ•ˆæœŸå’Œæ¸…é™¤æ™‚æ©Ÿï¼Ÿ

**å¾…è¨è«–**:
- å¿«å–æœ‰æ•ˆæœŸï¼ˆ5 åˆ†é˜ã€1 å°æ™‚ã€æ°¸ä¹…ç›´åˆ°æ›´æ–°ï¼‰ï¼Ÿ
- ä½•æ™‚è©²æ¸…é™¤å¿«å–ï¼š
  - æª”æ¡ˆç³»çµ±è®Šæ›´
  - æ‰‹å‹•é‡æ–°æ•´ç†
  - å®šæ™‚æ¸…é™¤
- LRU vs. LFU ç­–ç•¥ï¼Ÿ

---

#### 13. ç‰ˆæœ¬è™Ÿæ ¼å¼èˆ‡è¦ç¯„ ğŸ“¦

**å•é¡Œ**: æ˜¯å¦åš´æ ¼éµå¾ªèªç¾©åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰ï¼Ÿ

**Semantic Versioning**: `MAJOR.MINOR.PATCH`
- MAJOR: ä¸ç›¸å®¹çš„ API è®Šæ›´
- MINOR: å‘å¾Œç›¸å®¹çš„åŠŸèƒ½æ–°å¢
- PATCH: å‘å¾Œç›¸å®¹çš„éŒ¯èª¤ä¿®æ­£

**å¾…è¨è«–**:
- æ¨¡æ¿/ç©æœ¨æ˜¯å¦é©ç”¨æ­¤è¦ç¯„ï¼Ÿ
- å¦‚ä½•å®šç¾©ã€Œä¸ç›¸å®¹è®Šæ›´ã€ï¼ˆå°æ¨¡æ¿è€Œè¨€ï¼‰ï¼Ÿ
- æ˜¯å¦éœ€è¦é ç™¼å¸ƒç‰ˆæœ¬ï¼ˆalpha, beta, rcï¼‰ï¼Ÿ

---

#### 14. ä¾è³´ç‰ˆæœ¬ç¯„åœæ”¯æ´ ğŸ¯

**å•é¡Œ**: æ˜¯å¦æ”¯æ´ç‰ˆæœ¬ç¯„åœï¼ˆå¦‚ `^1.0.0`, `~1.2.3`ï¼‰ï¼Ÿ

**npm é¢¨æ ¼èªæ³•**:
- `^1.0.0` - æ¥å— 1.x.xï¼ˆMINOR, PATCH å¯è®Šï¼‰
- `~1.2.3` - æ¥å— 1.2.xï¼ˆåªæœ‰ PATCH å¯è®Šï¼‰
- `1.0.0` - ç²¾ç¢ºç‰ˆæœ¬

**å¾…è¨è«–**:
- æ˜¯å¦éœ€è¦é€™ç¨®å½ˆæ€§ï¼Ÿ
- å¦‚ä½•è™•ç†ä¾è³´è¡çªï¼ˆA éœ€è¦ ^1.0.0ï¼ŒB éœ€è¦ ^2.0.0ï¼‰ï¼Ÿ
- æ˜¯å¦æä¾›è¡çªè§£æ±ºå·¥å…·ï¼Ÿ

---

#### 15. Registry èˆ‡æª”æ¡ˆç³»çµ±çš„åŒæ­¥å„ªå…ˆæ¬Š ğŸ“

**å•é¡Œ**: ç•¶ Registry èˆ‡æª”æ¡ˆç³»çµ±ä¸ä¸€è‡´æ™‚ï¼Œä»¥å“ªå€‹ç‚ºæº–ï¼Ÿ

**å ´æ™¯**:
- ä½¿ç”¨è€…ç›´æ¥ä¿®æ”¹æª”æ¡ˆç³»çµ±ï¼Œä½† Registry å°šæœªæ›´æ–°
- Registry æœ‰è¨˜éŒ„ï¼Œä½†æª”æ¡ˆå·²è¢«åˆªé™¤

**é¸é …**:
- A. æª”æ¡ˆç³»çµ±å„ªå…ˆï¼ˆæª”æ¡ˆæ˜¯ source of truthï¼‰
- B. Registry å„ªå…ˆï¼ˆRegistry æ˜¯ source of truthï¼‰
- C. é¡¯ç¤ºè­¦å‘Šï¼Œè®“ä½¿ç”¨è€…æ±ºå®š

**å¾…è¨è«–**:
- å“ªç¨®æ¨¡å¼æœ€ç¬¦åˆä½¿ç”¨è€…é æœŸï¼Ÿ
- æ˜¯å¦æä¾›ã€ŒRegistry å„ªå…ˆã€æ¨¡å¼é¸é …ï¼Ÿ

---

### ä½¿ç”¨è€…é«”é©—å•é¡Œ

#### 16. æ•™å­¸æ¨¡å¼ vs. å¿«é€Ÿæ¨¡å¼ ğŸ“

**å•é¡Œ**: æ˜¯å¦éœ€è¦é‡å°ä¸åŒä½¿ç”¨è€…æä¾›ä¸åŒæ¨¡å¼ï¼Ÿ

**æ•™å­¸æ¨¡å¼**:
- è©³ç´°è§£é‡‹æ¯å€‹è½‰æ›é¸é …
- é¡¯ç¤ºå®Œæ•´çš„ä¿¡å¿ƒåº¦åˆ†æ
- æä¾›å­¸ç¿’è³‡æºé€£çµ

**å¿«é€Ÿæ¨¡å¼**:
- åƒ…é¡¯ç¤ºæ¨è–¦é¸é …
- æœ€å°‘äº’å‹•
- ä¿¡ä»»ç³»çµ±è‡ªå‹•é¸æ“‡

**å¾…è¨è«–**:
- å¦‚ä½•åˆ¤æ–·ä½¿ç”¨è€…æ‡‰è©²ç”¨å“ªç¨®æ¨¡å¼ï¼Ÿ
- æ˜¯å¦éœ€è¦ã€Œæ··åˆæ¨¡å¼ã€ï¼ˆä¾ä»»å‹™é¡å‹è‡ªå‹•åˆ‡æ›ï¼‰ï¼Ÿ
- æ¨¡å¼åˆ‡æ›æ˜¯å¦æ‡‰è©²å®¹æ˜“ï¼ˆä¸€éµåˆ‡æ›ï¼‰ï¼Ÿ

---

### åŸæœ‰å•é¡Œæ›´æ–°

#### 17. ç©æœ¨èˆ‡æ¨¡æ¿çš„é—œä¿‚ âœ… **å·²è§£æ±º**

**æ±ºç­–**: æ¡ç”¨ D é¸é … - ä¸­å¤®è¨»å†Šè¡¨è¨˜éŒ„å°æ‡‰é—œä¿‚

**å¯¦ä½œ**:
- å°æ‡‰é—œä¿‚ç´¢å¼• (`forms/_index/mappings.json`)
- Template Registry æ•´åˆ
- è‡ªå‹•æ¨è–¦èˆ‡é©—è­‰ç³»çµ±

---

#### 18. ç²’åº¦å±¤ç´šçš„è©³ç´°è¨­è¨ˆ âœ… **å·²å®šç¾©**

**æ±ºç­–**: å››ç´šç©æœ¨ç³»çµ± (L0/L1/L2/L3)

- **L0**: ç³»çµ±ç´šï¼ˆå¤šæ¨¡æ¿çµ„åˆèˆ‡å”ä½œï¼‰
- **L1**: æ¨¡æ¿ç´šï¼ˆå®Œæ•´ç¨‹å¼åŠŸèƒ½å–®å…ƒï¼‰
- **L2**: èªå¥ç´šï¼ˆæ§åˆ¶çµæ§‹èˆ‡åŠŸèƒ½å€å¡Šï¼‰
- **L3**: è¡¨é”å¼ç´šï¼ˆåŸºæœ¬é‹ç®—èˆ‡æ“ä½œå…ƒç´ ï¼‰

**è¨­è¨ˆéˆæ„Ÿ**: å—ç”Ÿç‰©å­¸ä¸­è›‹ç™½è³ªå››ç´šçµæ§‹å•Ÿç™¼ï¼ˆè©³è¦‹é™„éŒ„ Cï¼‰

---

#### 19. è½‰æ›æº–ç¢ºåº¦çš„è©•ä¼°æ¨™æº– ğŸ“Š

**å•é¡Œ**: å¦‚ä½•é‡åŒ–è½‰æ›çš„æº–ç¢ºåº¦ï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**: å¤šç¶­åº¦è©•ä¼°
- AST ç›¸ä¼¼åº¦ï¼ˆçµæ§‹å±¤é¢ï¼‰
- èªç¾©ç›¸ä¼¼åº¦ï¼ˆæ„ç¾©å±¤é¢ï¼‰
- æ¨¡å¼åŒ¹é…ä¿¡å¿ƒåº¦

**å¾…è¨è«–**:
- æ˜¯å¦éœ€è¦ä½¿ç”¨è€…å›é¥‹è©•åˆ†ï¼Ÿ
- æ¸¬è©¦æ¡ˆä¾‹é€šéç‡å¦‚ä½•æ•´åˆï¼Ÿ

---

#### 20. ç©æœ¨çš„ç‰ˆæœ¬å…¼å®¹æ€§ ğŸ”„

**å•é¡Œ**: ç•¶ç©æœ¨å®šç¾©æ›´æ–°æ™‚ï¼Œå¦‚ä½•è™•ç†èˆŠçš„ workspaceï¼Ÿ

**æŒ‘æˆ°**:
- å‘å¾Œå…¼å®¹
- è‡ªå‹•é·ç§»
- ç‰ˆæœ¬æª¢æ¸¬

**å¾…è¨­è¨ˆ**:
- Structure Form ç‰ˆæœ¬æ¨™è¨˜
- è‡ªå‹•é·ç§»è…³æœ¬
- é™ç´šï¼ˆfallbackï¼‰ç­–ç•¥

---

#### 21. å¤§å‹ç¨‹å¼çš„åœ–è­œæ•ˆèƒ½ âš¡

**å•é¡Œ**: æ•¸åƒè¡Œç¨‹å¼ç¢¼çš„åœ–è­œå¦‚ä½•æœ‰æ•ˆé¡¯ç¤ºå’Œäº’å‹•ï¼Ÿ

**è¦åŠƒ** (v0.5.3):
- æ‡¶è¼‰å…¥
- å±¤ç´šç¸®æ”¾
- è¦–è¦ºåŒ–å„ªåŒ–
- åœ–ç°¡åŒ–æ¼”ç®—æ³•

---

#### 22. è·¨èªè¨€è½‰æ›çš„ç¯„åœ ğŸŒ

**å•é¡Œ**: æ‡‰è©²æ”¯æ´å“ªäº›èªè¨€ä¹‹é–“çš„äº’è½‰ï¼Ÿå„ªå…ˆç´šå¦‚ä½•ï¼Ÿ

**å„ªå…ˆç´š**:
1. C â†” Python (v0.4.2)
2. C â†” JavaScript (v0.4.x)
3. Python â†” JavaScript (v0.4.x)
4. å…¶ä»–èªè¨€ï¼ˆv0.5+ï¼‰

---

#### 23. AI æ•´åˆçš„å…·é«”æ–¹å¼ ğŸ¤–

**å•é¡Œ**: å¦‚ä½•åˆ©ç”¨æ”¶é›†çš„è³‡æ–™è¨“ç·´ AIï¼Ÿ

**è¦åŠƒ** (v1.0):
- æ„åœ–è­˜åˆ¥æ¨¡å‹
- æ¨è–¦ç³»çµ±æ¨¡å‹
- ç¨‹å¼ç¢¼è£œå…¨æ¨¡å‹
- éŒ¯èª¤æª¢æ¸¬æ¨¡å‹

**å¾…æ¢ç´¢**:
- è‡ªç·¨ç¢¼å™¨ï¼ˆAutoencoderï¼‰è¨“ç·´
- æ”¶æ–‚æ€§åˆ†æè³‡æ–™æ”¶é›†
- éš±ç§ä¿è­·æ©Ÿåˆ¶

---

### v3.0 æ–°å¢å•é¡Œ

ä»¥ä¸‹æ˜¯ v3.0 å¼•å…¥çš„æ–°æ¦‚å¿µæ‰€å¸¶ä¾†çš„å¾…è§£æ±ºå•é¡Œï¼š

---

#### 24. è‡ªç„¶èªè¨€ L3 æ¦‚å¿µç²’åº¦ ğŸ“ **v3.0 æ–°å¢**

**å•é¡Œ**: Natural Language çš„ L3ï¼ˆè¡¨é”å¼ç´šï¼‰æ‡‰è©²æœ‰å¤šç´°ï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**:
- L3 = æ¦‚å¿µç‰‡æ®µï¼ˆå¦‚ "ä½¿ç”¨è€…", "JWT token", "éæœŸæ™‚é–“24å°æ™‚"ï¼‰

**é¸é …**:
- A. **ç²—ç²’åº¦** - å®Œæ•´èªç¾©å–®å…ƒï¼ˆ"ä½¿ç”¨è€…èªè­‰ä½¿ç”¨JWT tokenï¼Œæœ‰æ•ˆæœŸ24å°æ™‚"ï¼‰
- B. **ä¸­ç²’åº¦** - æ¦‚å¿µç‰‡æ®µï¼ˆ"ä½¿ç”¨è€…", "JWT token", "æœ‰æ•ˆæœŸ24å°æ™‚"ï¼‰â€” **ç•¶å‰é¸æ“‡**
- C. **ç´°ç²’åº¦** - å–®è©/çŸ­èªç´šåˆ¥ï¼ˆ"ä½¿ç”¨è€…", "JWT", "token", "24", "å°æ™‚"ï¼‰

**å¾…è¨è«–**:
- å¤ªç²— â†’ é›£ä»¥çµ„åˆå’Œé‡ç”¨
- å¤ªç´° â†’ å¤±å»èªç¾©å®Œæ•´æ€§
- å¦‚ä½•åœ¨éˆæ´»æ€§èˆ‡å¯ç†è§£æ€§ä¹‹é–“å¹³è¡¡ï¼Ÿ
- ä¸åŒé ˜åŸŸï¼ˆAPI spec vs. Algorithm specï¼‰æ˜¯å¦éœ€è¦ä¸åŒç²’åº¦ï¼Ÿ

---

#### 25. æ¦‚å¿µé¡å‹ç³»çµ±çš„è¤‡é›œåº¦ ğŸ¯ **v3.0 æ–°å¢**

**å•é¡Œ**: Concept Type ç³»çµ±æ‡‰è©²æœ‰å¤šè¤‡é›œï¼Ÿ

**ç•¶å‰è¨­è¨ˆ** (Phase 2):
```typescript
interface ConceptType {
  name: string;
  category: string;
  validation?: ValidationRule[];
  options?: string[];
}
```

**å¯èƒ½æ“´å±•** (Phase 3):
- ç¹¼æ‰¿é—œä¿‚ï¼ˆ"RestMethod extends HttpMethod"ï¼‰
- çµ„åˆé—œä¿‚ï¼ˆ"Endpoint contains Method + Path + Request + Response"ï¼‰
- ç´„æŸé—œä¿‚ï¼ˆ"If Method=GET, then Request should be null"ï¼‰

**å¾…è¨è«–**:
- éœ€è¦å®Œæ•´çš„å‹åˆ¥ç³»çµ±å—ï¼Ÿé‚„æ˜¯ç°¡å–®çš„æ¨™ç±¤å°±å¤ ï¼Ÿ
- å¦‚ä½•é¿å…éåº¦å·¥ç¨‹åŒ–ï¼Ÿ
- ä½¿ç”¨è€…å­¸ç¿’æˆæœ¬ vs. è¡¨é”èƒ½åŠ›ï¼Ÿ

---

#### 26. æ¦‚å¿µåœ–è­œçš„å¯¦ä½œæŠ€è¡“é¸æ“‡ ğŸ•¸ï¸ **v3.0 æ–°å¢**

**å•é¡Œ**: Knowledge Graph æ‡‰è©²ç”¨ä»€éº¼æŠ€è¡“å¯¦ä½œï¼Ÿ

**é¸é …**:
- A. **è¼•é‡ç´š** - JSON ç‰©ä»¶åœ– + ç°¡å–®æŸ¥è©¢
- B. **ä¸­é‡ç´š** - åœ–è³‡æ–™åº«ï¼ˆå¦‚ Neo4j Embeddedï¼‰
- C. **é‡é‡ç´š** - å®Œæ•´åœ–è³‡æ–™åº«ï¼ˆNeo4j Server, ArangoDBï¼‰

**è€ƒé‡**:
- **é¸é … A**: ç°¡å–®ï¼Œä½†æŸ¥è©¢èƒ½åŠ›æœ‰é™
- **é¸é … B**: å¹³è¡¡ï¼Œä½†å¢åŠ ä¾è³´
- **é¸é … C**: å¼·å¤§ï¼Œä½†è¤‡é›œåº¦å’Œè³‡æºéœ€æ±‚é«˜

**å¾…è¨è«–**:
- VS Code Extension çš„è³‡æºé™åˆ¶
- æŸ¥è©¢éœ€æ±‚çš„å¯¦éš›è¤‡é›œåº¦
- æ˜¯å¦éœ€è¦æ”¯æ´ SPARQL æˆ– Cypher æŸ¥è©¢ï¼Ÿ

---

#### 27. Spec â†” Code å°æ‡‰çš„æº–ç¢ºåº¦é–¾å€¼ ğŸ”— **v3.0 æ–°å¢**

**å•é¡Œ**: SpecKit æ•´åˆä¸­ï¼Œå¤šå°‘ä¿¡å¿ƒåº¦æ‰å»ºç«‹ Spec-Code å°æ‡‰ï¼Ÿ

**ç•¶å‰è¨­è¨ˆ**:
- ä¿¡å¿ƒåº¦ â‰¥ 0.85: è‡ªå‹•å»ºç«‹å°æ‡‰
- ä¿¡å¿ƒåº¦ 0.6-0.85: æ¨è–¦çµ¦ä½¿ç”¨è€…ç¢ºèª
- ä¿¡å¿ƒåº¦ < 0.6: ä¸æ¨è–¦

**å¾…è¨è«–**:
- é–¾å€¼æ˜¯å¦åˆé©ï¼Ÿ
- è‡ªå‹•å°æ‡‰å¤±æ•—çš„é¢¨éšª vs. æ¸›å°‘ä½¿ç”¨è€…è² æ“”
- æ˜¯å¦éœ€è¦æ ¹æ“šå°ˆæ¡ˆèª¿æ•´é–¾å€¼ï¼Ÿ
- æ˜¯å¦éœ€è¦ã€Œè©¦ç”¨æœŸã€ï¼ˆprovisional mappingï¼‰æ©Ÿåˆ¶ï¼Ÿ

---

#### 28. Assembly/HDL çš„ Blockly è¡¨ç¤º âš™ï¸ **v3.0 æ–°å¢**

**å•é¡Œ**: ä½éšèªè¨€æ˜¯å¦é©åˆç”¨ Blocklyï¼Ÿ

**æŒ‘æˆ°**:
- Assembly: éœ€è¦ç²¾ç¢ºæ§åˆ¶æš«å­˜å™¨ã€ä½å€
- HDL: éœ€è¦è¡¨é”æ™‚åºã€ä¸¦è¡Œ
- Blockly çš„ã€Œæ‹–æ”¾å‹å–„ã€èˆ‡ã€Œç²¾ç¢ºæ§åˆ¶ã€ä¹‹é–“çš„å¼µåŠ›

**é¸é …**:
- A. **æ¨™æº– Blockly** - ç°¡åŒ–è¡¨ç¤ºï¼Œæå¤±éƒ¨åˆ†ç²¾ç¢ºæ€§
- B. **æ“´å±• Blockly** - å®¢è£½åŒ–ç©æœ¨æ”¯æ´ç²¾ç¢ºæ§åˆ¶
- C. **æ··åˆæ¨¡å¼** - Blockly ç”¨æ–¼é«˜å±¤æ¶æ§‹ï¼Œæ–‡å­—ç”¨æ–¼ä½å±¤ç´°ç¯€

**å¾…è¨è«–**:
- ç›®æ¨™ä½¿ç”¨è€…æ˜¯èª°ï¼Ÿï¼ˆåˆå­¸è€… vs. å°ˆå®¶ï¼‰
- ã€Œæ•™å­¸å‹å–„ã€vs. ã€Œå¯¦ç”¨æ€§ã€çš„å„ªå…ˆé †åº
- æ˜¯å¦éœ€è¦ä¸åŒæ¨¡å¼ï¼ˆç°¡åŒ–æ¨¡å¼ vs. å°ˆå®¶æ¨¡å¼ï¼‰ï¼Ÿ

---

#### 29. Machine Code çš„å¯ç·¨è¼¯æ€§ ğŸ”¢ **v3.0 æ–°å¢**

**å•é¡Œ**: Machine Code å½¢æ…‹æ‡‰è©²å…è¨±ç·¨è¼¯å—ï¼Ÿ

**é¸é …**:
- A. **å”¯è®€** - Machine Code åƒ…ä¾›æŸ¥çœ‹
- B. **æœ‰é™ç·¨è¼¯** - å…è¨±ä¿®æ”¹æŒ‡ä»¤åƒæ•¸ï¼Œä¸å…è¨±æ–°å¢/åˆªé™¤
- C. **å®Œå…¨å¯ç·¨è¼¯** - æ”¯æ´å®Œæ•´çš„æ©Ÿå™¨ç¢¼ç·¨è¼¯

**è€ƒé‡**:
- Machine Code é€šå¸¸æ˜¯ç·¨è­¯çµæœï¼Œæ‰‹å‹•ç·¨è¼¯é¢¨éšªé«˜
- æŸäº›å„ªåŒ–å ´æ™¯éœ€è¦æ‰‹å‹•èª¿æ•´æ©Ÿå™¨ç¢¼
- å¦‚ä½•ç¢ºä¿ç·¨è¼¯å¾Œçš„ Machine Code åˆæ³•ï¼Ÿ

**å¾…è¨è«–**:
- ç›®æ¨™å ´æ™¯ï¼ˆæ•™å­¸ã€é€†å‘å·¥ç¨‹ã€å„ªåŒ–ï¼‰
- ç·¨è¼¯å¾Œå¦‚ä½•åŒæ­¥å› Assembly/High-Level Codeï¼Ÿ
- æ˜¯å¦éœ€è¦ã€Œå°ˆå®¶æ¨¡å¼ã€ï¼Ÿ

---

#### 30. æ’ä»¶çš„å®‰å…¨æ€§èˆ‡æ²™ç®± ğŸ”’ **v3.0 æ–°å¢**

**å•é¡Œ**: æ’ä»¶ç³»çµ±éœ€è¦å¤šå¼·çš„å®‰å…¨æ€§ä¿è­·ï¼Ÿ

**é¢¨éšª**:
- æƒ¡æ„æ’ä»¶å¯èƒ½å­˜å–æª”æ¡ˆç³»çµ±
- æƒ¡æ„æ’ä»¶å¯èƒ½ç«Šå–ç¨‹å¼ç¢¼
- æƒ¡æ„æ’ä»¶å¯èƒ½å½±éŸ¿ç·¨è¼¯å™¨ç©©å®šæ€§

**é¸é …**:
- A. **ä¿¡ä»»æ¨¡å¼** - ä¸é™åˆ¶æ’ä»¶ï¼ˆåƒ…å®˜æ–¹/ç¤¾ç¾¤èªè­‰ï¼‰
- B. **æ¬Šé™æ¨¡å¼** - æ’ä»¶éœ€è²æ˜æ¬Šé™ï¼Œä½¿ç”¨è€…å¯©æ ¸
- C. **æ²™ç®±æ¨¡å¼** - æ’ä»¶åœ¨éš”é›¢ç’°å¢ƒåŸ·è¡Œ

**å¾…è¨è«–**:
- VS Code Extension API çš„é™åˆ¶
- ä½¿ç”¨è€…é«”é©— vs. å®‰å…¨æ€§
- ç¤¾ç¾¤æ’ä»¶çš„å¯©æ ¸æ©Ÿåˆ¶

---

#### 31. è·¨èªè¨€å±¤ç´šè½‰æ›çš„å¯è¡Œæ€§ ğŸŒ‰ **v3.0 æ–°å¢**

**å•é¡Œ**: æ˜¯å¦æ”¯æ´ã€Œè·³èºå¼ã€è½‰æ›ï¼ˆå¦‚ Spec â†’ HDLï¼‰ï¼Ÿ

**ç•¶å‰æ¶æ§‹**:
```
Natural Language â†’ High-Level â†’ Low-Level â†’ Machine â†’ HDL â†’ Physical
```

**ã€Œè·³èºå¼ã€è½‰æ›ç¯„ä¾‹**:
- Spec â†’ HDLï¼ˆç›´æ¥æè¿°ç¡¬é«”éœ€æ±‚ï¼‰
- Spec â†’ Assemblyï¼ˆåµŒå…¥å¼ç³»çµ±ï¼‰
- High-Level â†’ HDLï¼ˆé«˜éšç¶œåˆ HLSï¼‰

**æŒ‘æˆ°**:
- è·¨è¶Šå¤šå±¤ï¼Œè³‡è¨Šæå¤±æ›´å¤§
- è½‰æ›æº–ç¢ºåº¦é›£ä»¥ä¿è­‰
- éœ€è¦é ˜åŸŸå°ˆå®¶çŸ¥è­˜

**å¾…è¨è«–**:
- å“ªäº›ã€Œè·³èºå¼ã€è½‰æ›æœ‰å¯¦éš›éœ€æ±‚ï¼Ÿ
- æ˜¯å¦é€éã€Œä¸­é–“å±¤ç´šã€çš„é€£çºŒè½‰æ›å¯¦ç¾ï¼Ÿ
- AI è¼”åŠ©çš„å¿…è¦æ€§ï¼Ÿ

---

#### 32. å…ƒè³‡æ–™çš„å¤šèªè¨€æ”¯æ´ ğŸŒ **v3.0 æ–°å¢**

**å•é¡Œ**: å…ƒè³‡æ–™ï¼ˆè¨»è§£ã€è¨­è¨ˆç†ç”±ï¼‰æ˜¯å¦éœ€è¦å¤šèªè¨€ï¼Ÿ

**å ´æ™¯**:
- åœ‹éš›åœ˜éšŠå”ä½œ
- æ¨¡æ¿ç¤¾ç¾¤åˆ†äº«
- æ•™å­¸ææ–™æœ¬åœ°åŒ–

**é¸é …**:
- A. **è‹±æ–‡å”¯ä¸€** - ç°¡å–®ï¼Œä½†é™åˆ¶éè‹±èªä½¿ç”¨è€…
- B. **ä¸»+ç¿»è­¯** - ä¸»è¦èªè¨€ + æ©Ÿå™¨ç¿»è­¯
- C. **å¤šèªè¨€å„²å­˜** - æ¯å€‹è¨»è§£æœ‰å¤šå€‹èªè¨€ç‰ˆæœ¬

**å¾…è¨è«–**:
- å„²å­˜æ ¼å¼ï¼ˆå–®ä¸€æª”æ¡ˆ vs. åˆ†èªè¨€æª”æ¡ˆï¼‰
- ç¿»è­¯å“è³ªä¿è­‰
- UI åˆ‡æ›èªè¨€çš„æ–¹å¼

---

#### 33. æ’ä»¶æ›´æ–°çš„å‘å¾Œå…¼å®¹æ€§ â™»ï¸ **v3.0 æ–°å¢**

**å•é¡Œ**: æ’ä»¶æ›´æ–°æ™‚å¦‚ä½•è™•ç†èˆŠç‰ˆæ¨¡æ¿ï¼Ÿ

**å ´æ™¯**:
- HDL Plugin 2.0 æ–°å¢æ™‚åºåˆ†æåŠŸèƒ½
- èˆŠæ¨¡æ¿ä½¿ç”¨ HDL Plugin 1.0 çš„è³‡æ–™æ ¼å¼
- æ˜¯å¦è‡ªå‹•é·ç§»ï¼Ÿé‚„æ˜¯ä¿æŒèˆŠç‰ˆï¼Ÿ

**é¸é …**:
- A. **è‡ªå‹•é·ç§»** - å˜—è©¦è‡ªå‹•è½‰æ›ï¼Œå¤±æ•—å‰‡é€šçŸ¥
- B. **æ‰‹å‹•é·ç§»** - æç¤ºä½¿ç”¨è€…é€ä¸€æª¢æŸ¥ä¸¦é·ç§»
- C. **å¤šç‰ˆæœ¬å…±å­˜** - å…è¨±èˆŠæ¨¡æ¿ç¹¼çºŒä½¿ç”¨èˆŠæ’ä»¶

**å¾…è¨è«–**:
- é·ç§»å¤±æ•—çš„è™•ç†ç­–ç•¥
- æ˜¯å¦éœ€è¦æ’ä»¶çš„ Migration Scriptï¼Ÿ
- ç‰ˆæœ¬é–å®š vs. è‡ªå‹•æ›´æ–°

---

#### 34. Coding Agent åå¥½èˆ‡æ¨¡æ¿æ¨è–¦ ğŸ¤– **v3.0 æ–°å¢**

**å•é¡Œ**: ä¸åŒ Coding Agentï¼ˆClaude, Copilot, Cursorï¼‰æœ‰ä¸åŒé¢¨æ ¼ï¼Œå¦‚ä½•èª¿æ•´æ¨è–¦ï¼Ÿ

**è§€å¯Ÿ**:
- Claude: åå¥½è©³ç´°è¨»è§£ã€å®Œæ•´éŒ¯èª¤è™•ç†
- Copilot: åå¥½ç°¡æ½”ç¨‹å¼ç¢¼ã€å¸¸è¦‹æ¨¡å¼
- Cursor: åå¥½å°ˆæ¡ˆé¢¨æ ¼ã€ä¸Šä¸‹æ–‡ç›¸é—œ

**é¸é …**:
- A. **çµ±ä¸€æ¨è–¦** - ä¸å€åˆ† Coding Agent
- B. **Agent Profile** - ç‚ºæ¯å€‹ Agent è¨­å®šåå¥½æ¬Šé‡
- C. **å­¸ç¿’å¼èª¿æ•´** - æ ¹æ“š Agent çš„å¯¦éš›é¸æ“‡å­¸ç¿’

**å¾…è¨è«–**:
- æ˜¯å¦å€¼å¾—æŠ•è³‡é–‹ç™¼æ­¤åŠŸèƒ½ï¼Ÿ
- ä½¿ç”¨è€…æ˜¯å¦åœ¨æ„é€™ç¨®ç´°ç¯€ï¼Ÿ
- Agent API æ˜¯å¦æä¾›è¶³å¤ è³‡è¨Šï¼Ÿ

---

## é™„éŒ„

### A. å°ˆæœ‰åè©å°ç…§è¡¨

| è‹±æ–‡ | ä¸­æ–‡ | èªªæ˜ |
|------|------|------|
| Sequence Form | æ–‡å­—å½¢æ…‹ | å‚³çµ±çš„ç·šæ€§ç¨‹å¼ç¢¼ |
| Structure Form | ç©æœ¨å½¢æ…‹ | Blockly ç©æœ¨è¡¨ç¤º |
| Topology Form | åœ–è­œå½¢æ…‹ | é—œä¿‚ç¶²çµ¡è¡¨ç¤º |
| Structuring | çµæ§‹åŒ– | æ–‡å­— â†’ ç©æœ¨ |
| Serialization | åºåˆ—åŒ– | ç©æœ¨ â†’ æ–‡å­— |
| Topologization | åœ–è­œåŒ– | å…¶ä»– â†’ åœ–è­œ |
| Sequentialization | åºåˆ—åŒ– | åœ–è­œ â†’ æ–‡å­— |
| Universal Block | é€šç”¨ç©æœ¨ | è·¨èªè¨€ç©æœ¨ |
| Language-Specific Block | èªè¨€ç‰¹å®šç©æœ¨ | å–®ä¸€èªè¨€ç©æœ¨ |
| Granularity | ç²’åº¦ | ç©æœ¨çš„è©³ç´°ç¨‹åº¦ |
| Convergence | æ”¶æ–‚ | å¤šæ¬¡è½‰æ›è¶¨æ–¼ç©©å®š |
| Lossiness | æå¤±æ€§ | è½‰æ›ä¸­çš„è³‡è¨Šéºå¤± |

### B. åƒè€ƒæ–‡ç»

- [Blockly å®˜æ–¹æ–‡æª”](https://developers.google.com/blockly)
- [AST Explorer](https://astexplorer.net/)
- [Graphviz](https://graphviz.org/)
- [TextBricks PRD](./PRD.md)
- [è›‹ç™½è³ªçµæ§‹ï¼ˆç¶­åŸºç™¾ç§‘ï¼‰](https://zh.wikipedia.org/wiki/è›‹ç™½è³ªçµæ§‹)
- [ä¸­å¿ƒæ³•å‰‡ï¼ˆCentral Dogmaï¼‰](https://zh.wikipedia.org/wiki/ä¸­å¿ƒæ³•å‰‡)

---

### C. èˆ‡ SpecKit æ•´åˆ ğŸ”— **v3.0 æ–°å¢**

> **v3.0 æ ¸å¿ƒæ›´æ–°**ï¼šTextBricks èˆ‡ SpecKit æ·±åº¦æ•´åˆï¼Œæ”¯æ´å®Œæ•´çš„ Spec-Driven Development å·¥ä½œæµ

#### C.1 SpecKit ç°¡ä»‹

**SpecKit** æ˜¯ GitHub æ¨å‡ºçš„è¦æ ¼é©…å‹•é–‹ç™¼å·¥å…·åŒ…ï¼Œæä¾›çµæ§‹åŒ–çš„è»Ÿé«”é–‹ç™¼æµç¨‹ï¼š

```
/specify   â†’ æ’°å¯«è¦æ ¼ (spec.md)
   â†“
/implement â†’ å¯¦ä½œåŠŸèƒ½ (æ ¹æ“š spec)
   â†“
/test      â†’ æ¸¬è©¦é©—è­‰ (ç¢ºä¿ç¬¦åˆ spec)
   â†“
/review    â†’ å¯©æŸ¥èˆ‡è¿­ä»£
```

**æ ¸å¿ƒç†å¿µ**ï¼š
- **Spec æ˜¯ç¬¬ä¸€å…¬æ°‘** - æ‰€æœ‰é–‹ç™¼å¾è¦æ ¼é–‹å§‹
- **AI è¼”åŠ©å¯¦ä½œ** - Coding Agent æ ¹æ“š spec ç”Ÿæˆç¨‹å¼ç¢¼
- **è¦æ ¼å³æ–‡æª”** - spec.md åŒæ™‚æ˜¯éœ€æ±‚ã€è¨­è¨ˆã€æ¸¬è©¦è¦ç¯„
- **å”ä½œå‹å–„** - æ¸…æ™°çš„è¦æ ¼é™ä½æºé€šæˆæœ¬

**SpecKit çš„å±€é™**ï¼š
- âŒ æ²’æœ‰è¦æ ¼æ¨¡æ¿ç³»çµ±ï¼ˆæ¯æ¬¡å¾ç©ºç™½é–‹å§‹ï¼‰
- âŒ æ²’æœ‰æ¦‚å¿µé‡ç”¨æ©Ÿåˆ¶ï¼ˆé‡è¤‡æè¿°ç›¸åŒæ¦‚å¿µï¼‰
- âŒ ç¼ºä¹ Spec â†” Code é›™å‘åŒæ­¥
- âŒ æ²’æœ‰è¦–è¦ºåŒ–å·¥å…·ï¼ˆç´”æ–‡å­—ï¼‰

**TextBricks çš„è£œå……åƒ¹å€¼**ï¼š
- âœ… Spec Template ç³»çµ±ï¼ˆå¿«é€Ÿç”¢ç”Ÿçµæ§‹åŒ–è¦æ ¼ï¼‰
- âœ… æ¦‚å¿µç®¡ç†ç³»çµ±ï¼ˆå¯é‡ç”¨çš„é¡å‹åŒ–æ¦‚å¿µï¼‰
- âœ… Spec â†” Code é›™å‘å°æ‡‰
- âœ… ä¸‰å½¢æ…‹è¦–è¦ºåŒ–ï¼ˆSequence/Structure/Topologyï¼‰

---

#### C.2 æ•´åˆæ¶æ§‹

**æ•´é«”æµç¨‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SpecKit Workflow                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚                    â”‚
    /specify              /implement            /test
         â”‚                    â”‚                    â”‚
         â†“                    â†“                    â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TextBricks â”‚      â”‚  TextBricks â”‚      â”‚ SpecKit  â”‚
  â”‚ Spec Temple â”‚â”€â”€â”¬â”€â”€â†’â”‚ Code Temple â”‚      â”‚  Native  â”‚
  â”‚   å»ºè­°ç³»çµ±   â”‚  â”‚   â”‚   å»ºè­°ç³»çµ±   â”‚      â”‚          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚         â”‚          â”‚
         â”‚    Spec-Code       â”‚
         â”‚   å°æ‡‰é—œä¿‚è¿½è¹¤      â”‚
         â”‚         â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Template   â”‚
        â”‚  Registry   â”‚
        â”‚ (çµ±ä¸€ç®¡ç†)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**TextBricks çš„è§’è‰²**ï¼š
1. **/specify éšæ®µ** - æä¾› Spec Template å»ºè­°
2. **/implement éšæ®µ** - æ ¹æ“š spec æ¨è–¦ Code Template
3. **æŒçºŒè¿½è¹¤** - ç¶­è­· Spec â†” Code å°æ‡‰é—œä¿‚
4. **è¦–è¦ºåŒ–** - æä¾›ä¸‰å½¢æ…‹æŸ¥çœ‹èˆ‡ç·¨è¼¯

---

#### C.3 å¯¦éš›æ•´åˆæ–¹å¼

##### 1. ç›®éŒ„çµæ§‹æ•´åˆ

```
project/
â”œâ”€â”€ .speckit/                    # SpecKit ç®¡ç†ç›®éŒ„
â”‚   â”œâ”€â”€ specs/
â”‚   â”‚   â”œâ”€â”€ feature-a/
â”‚   â”‚   â”‚   â”œâ”€â”€ spec.md         # è¦æ ¼æ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ .textbricks/    # TextBricks æ“´å…… â­
â”‚   â”‚   â”‚       â”œâ”€â”€ template.json      # ä½¿ç”¨çš„ Spec Template
â”‚   â”‚   â”‚       â”œâ”€â”€ concepts.json      # æå–çš„æ¦‚å¿µ
â”‚   â”‚   â”‚       â””â”€â”€ mappings.json      # Spec â†’ Code å°æ‡‰
â”‚   â”‚   â””â”€â”€ feature-b/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ config.json
â”‚
â”œâ”€â”€ src/                         # å¯¦ä½œç¨‹å¼ç¢¼
â”‚   â”œâ”€â”€ feature-a/
â”‚   â”‚   â”œâ”€â”€ implementation.py
â”‚   â”‚   â””â”€â”€ .textbricks/        # TextBricks æ“´å…… â­
â”‚   â”‚       â”œâ”€â”€ templates.json  # ä½¿ç”¨çš„ Code Template
â”‚   â”‚       â””â”€â”€ mappings.json   # Code â†’ Spec å°æ‡‰
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ .textbricks/                 # TextBricks å…¨å±€è¨­å®š
    â””â”€â”€ config.json
```

##### 2. /specify éšæ®µæ•´åˆ

**å ´æ™¯**: é–‹ç™¼è€…åŸ·è¡Œ `/specify` é–‹å§‹æ’°å¯«æ–°åŠŸèƒ½è¦æ ¼

**TextBricks ä»‹å…¥é»**:

```typescript
// SpecKit å‘¼å«é‰¤å­
async onSpecifyPhaseStart(context: SpecifyContext) {
  const { featureName, featureType } = context;

  // 1. æ ¹æ“šåŠŸèƒ½é¡å‹æ¨è–¦ Spec Template
  const recommendations = await textbricks.specTemplates.recommend({
    featureType,              // "rest-api", "algorithm", "data-model", etc.
    projectContext: context.project,
    recentSpecs: context.recentSpecs
  });

  // 2. é¡¯ç¤ºå»ºè­°çµ¦é–‹ç™¼è€…
  return {
    templates: recommendations.map(t => ({
      id: t.id,
      name: t.name,
      preview: t.forms.sequence.content,
      confidence: t.score
    })),
    action: 'insert' | 'preview' | 'customize'
  };
}

// é–‹ç™¼è€…é¸æ“‡ Template
async onTemplateSelected(templateId: string, context: SpecifyContext) {
  const template = await textbricks.registry.getById(templateId);

  // 1. æ’å…¥ Spec Template åˆ° spec.md
  const specContent = await textbricks.specTemplates.render(template, {
    variables: context.initialValues
  });

  // 2. è¨˜éŒ„ä½¿ç”¨çš„ Template
  await textbricks.tracking.recordSpecTemplateUsage({
    specPath: context.specPath,
    templateId,
    timestamp: Date.now()
  });

  // 3. å»ºç«‹ .textbricks/ æ“´å……ç›®éŒ„
  await textbricks.extensions.createSpecExtension({
    specPath: context.specPath,
    template,
    concepts: template.concepts || []
  });

  return { content: specContent };
}
```

**ä½¿ç”¨è€…é«”é©—**:

```bash
$ /specify create-user-endpoint

âš¡ SpecKit å•Ÿå‹• /specify éšæ®µ...
ğŸ§± TextBricks æ­£åœ¨åˆ†æ...

ğŸ“‹ å»ºè­°çš„ Spec Templates:
  1. REST API Endpoint (95% ç›¸é—œ)
     - Method, Path, Request, Response çµæ§‹åŒ–æ¬„ä½
     - è‡ªå‹•ç”¢ç”Ÿç¯„ä¾‹èˆ‡æ¸¬è©¦æ¡ˆä¾‹

  2. CRUD Operation (87% ç›¸é—œ)
     - Create, Read, Update, Delete å®Œæ•´æµç¨‹

  3. Custom (ç©ºç™½æ¨¡æ¿)

é¸æ“‡æ¨¡æ¿ [1-3]: 1

âœ… å·²æ’å…¥ "REST API Endpoint" æ¨¡æ¿åˆ° spec.md
ğŸ“ è«‹å¡«å¯«ä»¥ä¸‹æ¬„ä½:
   - Endpoint Name: _______
   - HTTP Method: [GET/POST/PUT/DELETE]
   - Path: /api/_______
   - ...
```

##### 3. /implement éšæ®µæ•´åˆ

**å ´æ™¯**: é–‹ç™¼è€…åŸ·è¡Œ `/implement` é–‹å§‹å¯¦ä½œåŠŸèƒ½

**TextBricks ä»‹å…¥é»**:

```typescript
// SpecKit å‘¼å«é‰¤å­
async onImplementPhaseStart(context: ImplementContext) {
  const { specPath } = context;

  // 1. è®€å– spec.md
  const spec = await fs.readFile(specPath, 'utf-8');

  // 2. å¾ spec ä¸­æå–æ¦‚å¿µ
  const concepts = await textbricks.nlp.extractConcepts(spec);

  // 3. æ ¹æ“šæ¦‚å¿µæ¨è–¦ Code Templates
  const recommendations = await textbricks.codeTemplates.recommend({
    concepts,
    language: context.targetLanguage,
    framework: context.framework,
    specType: context.specType
  });

  return {
    templates: recommendations,
    suggestedWorkflow: [
      { step: 1, template: 'fastapi-route-handler', reason: 'å¯¦ä½œ API endpoint' },
      { step: 2, template: 'pydantic-request-model', reason: 'å®šç¾© request schema' },
      { step: 3, template: 'database-query', reason: 'è³‡æ–™åº«æ“ä½œ' }
    ]
  };
}

// Coding Agent é¸æ“‡ Templates
async onCodeGeneration(templateIds: string[], context: ImplementContext) {
  const templates = await Promise.all(
    templateIds.map(id => textbricks.registry.getById(id))
  );

  // 1. å»ºç«‹ Spec â†’ Code å°æ‡‰é—œä¿‚
  await textbricks.mapping.createSpecCodeMapping({
    specPath: context.specPath,
    codeFiles: context.targetFiles,
    templates
  });

  // 2. è¨˜éŒ„ä½¿ç”¨
  await textbricks.tracking.recordCodeTemplateUsage({
    specPath: context.specPath,
    templates,
    codingAgent: context.agent  // "Claude", "Copilot", etc.
  });

  return { mappings: [...] };
}
```

**ä½¿ç”¨è€…é«”é©—**:

```bash
$ /implement create-user-endpoint

âš¡ SpecKit å•Ÿå‹• /implement éšæ®µ...
ğŸ§± TextBricks åˆ†æ spec.md...

ğŸ“Š æå–æ¦‚å¿µ:
   - Method: POST
   - Path: /api/users
   - Request: { name, email, password }
   - Response: { id, name, email, created_at }

ğŸ’¡ å»ºè­° Code Templates (Python + FastAPI):
   1. FastAPI Route Handler (å¿…è¦)
   2. Pydantic Request Model (å¿…è¦)
   3. Database Query (å»ºè­°)
   4. Error Handling (å»ºè­°)

ğŸ¤– Coding Agent é–‹å§‹å¯¦ä½œ...
   âœ… å·²å¥—ç”¨ Template #1: FastAPI Route Handler
   âœ… å·²å¥—ç”¨ Template #2: Pydantic Request Model
   âœ… å·²å¥—ç”¨ Template #3: Database Query

ğŸ“ å·²å»ºç«‹ Spec â†” Code å°æ‡‰é—œä¿‚
   spec.md:15-30 â†’ src/routes/users.py:10-45
```

##### 4. é›™å‘åŒæ­¥æ©Ÿåˆ¶

**Spec è®Šæ›´ â†’ Code æ›´æ–°**:

```typescript
async onSpecChanged(specPath: string, changes: SpecChange[]) {
  // 1. æ‰¾å‡ºå—å½±éŸ¿çš„ Code å€å¡Š
  const mappings = await textbricks.mapping.getMappingsBySpec(specPath);

  for (const mapping of mappings) {
    // 2. åˆ†æè®Šæ›´å½±éŸ¿
    const impact = await textbricks.analyzer.analyzeSpecChange({
      mapping,
      changes
    });

    if (impact.requiresCodeUpdate) {
      // 3. é€šçŸ¥é–‹ç™¼è€…
      await textbricks.notifications.notifyCodeUpdateRequired({
        specPath,
        codeFile: mapping.codeFile,
        affectedLines: mapping.codeLines,
        suggestedUpdates: impact.suggestions
      });
    }
  }
}
```

**Code è®Šæ›´ â†’ Spec æ›´æ–°å»ºè­°**:

```typescript
async onCodeChanged(codeFile: string, changes: CodeChange[]) {
  // 1. æ‰¾å‡ºå°æ‡‰çš„ Spec
  const mappings = await textbricks.mapping.getMappingsByCode(codeFile);

  if (mappings.length === 0) {
    // æ²’æœ‰å°æ‡‰ Specï¼Œå»ºè­°å‰µå»º
    await textbricks.notifications.suggestSpecCreation(codeFile);
    return;
  }

  for (const mapping of mappings) {
    // 2. æª¢æ¸¬æ˜¯å¦èˆ‡ Spec ä¸ä¸€è‡´
    const inconsistencies = await textbricks.analyzer.detectInconsistencies({
      mapping,
      codeChanges: changes
    });

    if (inconsistencies.length > 0) {
      // 3. å»ºè­°æ›´æ–° Spec
      await textbricks.notifications.suggestSpecUpdate({
        specPath: mapping.specPath,
        inconsistencies,
        suggestedUpdates: textbricks.nlp.generateSpecUpdates(inconsistencies)
      });
    }
  }
}
```

---

#### C.4 æŠ€è¡“å¯¦ç¾ç´°ç¯€

##### API æ“´å……é»

```typescript
// TextBricks Plugin for SpecKit
interface SpecKitPlugin {
  name: 'textbricks-speckit-integration';
  version: '1.0.0';

  // ç”Ÿå‘½é€±æœŸé‰¤å­
  hooks: {
    // /specify éšæ®µ
    'specify:start': (context) => TemplateRecommendation[];
    'specify:template-selected': (templateId, context) => SpecContent;
    'specify:complete': (spec) => void;

    // /implement éšæ®µ
    'implement:start': (context) => CodeTemplateRecommendation[];
    'implement:template-applied': (templateId, context) => void;
    'implement:complete': (codeFiles) => void;

    // è®Šæ›´ç›£è½
    'spec:changed': (specPath, changes) => void;
    'code:changed': (codeFile, changes) => void;
  };

  // API
  api: {
    getSpecTemplates: (criteria) => Promise<SpecTemplate[]>;
    getCodeTemplates: (concepts, language) => Promise<CodeTemplate[]>;
    createMapping: (spec, code) => Promise<Mapping>;
    getMappings: (path) => Promise<Mapping[]>;
  };
}
```

##### è³‡æ–™çµæ§‹

```typescript
// Spec-Code å°æ‡‰é—œä¿‚
interface SpecCodeMapping {
  id: string;

  // Spec è³‡è¨Š
  specPath: string;
  specLines: { start: number; end: number };
  specTemplate?: string;

  // Code è³‡è¨Š
  codeFile: string;
  codeLines: { start: number; end: number };
  codeTemplates: string[];

  // å°æ‡‰é—œä¿‚
  mappingType: 'one-to-one' | 'one-to-many' | 'many-to-one';
  confidence: number;  // 0-1

  // æ¦‚å¿µé€£çµ
  sharedConcepts: Concept[];

  // å…ƒè³‡æ–™
  createdAt: Date;
  createdBy: 'user' | 'ai';
  lastVerified: Date;
  isValid: boolean;
}
```

---

#### C.5 æœªä¾†å±•æœ›

**Phase 1 (v0.6.0)**: åŸºç¤æ•´åˆ
- Spec Template å»ºè­°
- Code Template æ¨è–¦
- åŸºæœ¬å°æ‡‰é—œä¿‚è¿½è¹¤

**Phase 2 (v0.6.1-0.6.3)**: æ·±åº¦æ•´åˆ
- æ¦‚å¿µåœ–è­œï¼ˆKnowledge Graphï¼‰
- AI è¼”åŠ©è¦æ ¼ç”Ÿæˆ
- å¤šèªè¨€ Spec æ”¯æ´

**Phase 3 (v1.0)**: å®Œæ•´ç”Ÿæ…‹
- SpecKit å®˜æ–¹æ’ä»¶ï¼ˆéœ€èˆ‡ SpecKit åœ˜éšŠåˆä½œï¼‰
- ç¤¾ç¾¤ Spec Template åˆ†äº«
- ä¼æ¥­ç´šå·¥ä½œæµå®šåˆ¶

**æ½›åœ¨å”ä½œæ©Ÿæœƒ**:
- èˆ‡ SpecKit åœ˜éšŠåˆä½œï¼Œæˆç‚ºå®˜æ–¹æ¨è–¦æ’ä»¶
- è²¢ç» Spec Template æ ¼å¼æ¨™æº–
- å…±å»º Spec â†” Code å°æ‡‰ç”Ÿæ…‹

---

### D. ç”Ÿç‰©å­¸é¡æ¯”å®Œæ•´é—¡è¿° ğŸ§¬

> **æ ¸å¿ƒæ´å¯Ÿ**ï¼šã€Œå¯ä»¥æƒ³åƒ DNAï¼ˆsequenceï¼‰ã€è›‹ç™½è³ªå››ç´šçµæ§‹ï¼ˆstructureï¼‰ã€ç³»çµ±çµ„ç¹”ï¼ˆtopologyï¼‰ä¹‹é–“çš„é—œä¿‚ã€
>
> é€™å€‹é¡æ¯”ä¸åƒ…åƒ…æ˜¯å€‹éš±å–»ï¼Œè€Œæ˜¯æ­ç¤ºäº†**è³‡è¨Šåœ¨ä¸åŒå±¤æ¬¡çµ„ç¹”èˆ‡è¡¨é”**çš„æ™®éåŸç†ã€‚

---

#### C.1 ç‚ºä»€éº¼ç”Ÿç‰©å­¸é¡æ¯”å¦‚æ­¤ç²¾å½©ï¼Ÿ

ç”Ÿç‰©å­¸ä¸­çš„è³‡è¨Šæµå‹•èˆ‡ç¨‹å¼ç¢¼çš„å¤šå½¢æ…‹è½‰æ›æœ‰è‘—é©šäººçš„ç›¸ä¼¼æ€§ï¼š

```
ç”Ÿç‰©å­¸è³‡è¨Šæµå‹•ï¼š
DNAï¼ˆåºåˆ—ï¼‰â†’ RNAï¼ˆè½‰éŒ„ï¼‰â†’ è›‹ç™½è³ªï¼ˆç¿»è­¯ï¼‰â†’ åŠŸèƒ½çµæ§‹ â†’ ç´°èƒç³»çµ±

ç¨‹å¼ç¢¼è³‡è¨Šæµå‹•ï¼š
Codeï¼ˆåºåˆ—ï¼‰â†’ ASTï¼ˆè§£æï¼‰â†’ ç©æœ¨ï¼ˆçµæ§‹åŒ–ï¼‰â†’ åŠŸèƒ½æ¨¡çµ„ â†’ ç¨‹å¼ç³»çµ±
```

å…©è€…éƒ½æ¶‰åŠï¼š
1. **è³‡è¨Šç·¨ç¢¼** - DNA ç”¨ ATCGï¼Œç¨‹å¼ç”¨å­—å…ƒ
2. **çµæ§‹æŠ˜ç–Š** - è›‹ç™½è³ªæŠ˜ç–Šæˆ 3D çµæ§‹ï¼Œç¨‹å¼ç¢¼çµ„ç¹”æˆæ¨¡çµ„
3. **åŠŸèƒ½å¯¦ç¾** - è›‹ç™½è³ªè¡Œä½¿ç”Ÿç‰©åŠŸèƒ½ï¼Œç¨‹å¼åŸ·è¡Œè¨ˆç®—ä»»å‹™
4. **ç³»çµ±çµ„ç¹”** - å¤šå€‹å–®å…ƒå”åŒå·¥ä½œé”æˆè¤‡é›œç›®æ¨™

---

#### C.2 ä¸‰å½¢æ…‹çš„ç”Ÿç‰©å­¸å°æ‡‰

| ç¨‹å¼å½¢æ…‹ | ç”Ÿç‰©å­¸å°æ‡‰ | æœ¬è³ª | ç‰¹æ€§ |
|---------|-----------|------|------|
| **Sequence** (æ–‡å­—) | DNA / RNA åºåˆ— | ç·šæ€§è³‡è¨Šç·¨ç¢¼ | æ˜“æ–¼å„²å­˜ã€å‚³è¼¸ã€è¤‡è£½ |
| **Structure** (ç©æœ¨) | è›‹ç™½è³ªçµæ§‹ | ç©ºé–“çµ„ç¹”å½¢æ…‹ | åŠŸèƒ½å–®å…ƒã€å¯çµ„åˆã€å¯äº’å‹• |
| **Topology** (åœ–è­œ) | ç³»çµ±çµ„ç¹”ç¶²çµ¡ | é—œä¿‚èˆ‡äº’å‹• | å±•ç¾å”ä½œã€ä¾è³´ã€æµå‹• |

##### Sequence â†” DNA/RNA

**DNA åºåˆ—**:
```
...ATGCGATCGTAGCTAGC...
```

**ç¨‹å¼ç¢¼åºåˆ—**:
```c
int main() { printf("Hello"); }
```

**å…±åŒç‰¹å¾µ**:
- ç·šæ€§æ’åˆ—
- æ˜“æ–¼è¤‡è£½ï¼ˆåŸºå› è¤‡è£½ / ç¨‹å¼ç¢¼è¤‡è£½ï¼‰
- å¯å£“ç¸®å„²å­˜
- éœ€è¦ã€Œè§£è®€ã€æ‰èƒ½ç™¼æ®åŠŸèƒ½

**å·®ç•°**:
- DNA åƒ…æœ‰ 4 ç¨®é¹¼åŸºï¼ˆA, T, C, Gï¼‰
- ç¨‹å¼ç¢¼æœ‰æ›´è±å¯Œçš„å­—å…ƒé›†å’Œèªæ³•

---

##### Structure â†” è›‹ç™½è³ªçµæ§‹

**è›‹ç™½è³ªå››ç´šçµæ§‹**:

```
ä¸€ç´šçµæ§‹ï¼ˆPrimaryï¼‰    â†’ èƒºåŸºé…¸åºåˆ—ï¼ˆç·šæ€§ï¼‰
     â†“ æŠ˜ç–Š
äºŒç´šçµæ§‹ï¼ˆSecondaryï¼‰  â†’ Î±-èºæ—‹ã€Î²-æ‘ºæ¿ï¼ˆå±€éƒ¨çµæ§‹ï¼‰
     â†“ é€²ä¸€æ­¥æŠ˜ç–Š
ä¸‰ç´šçµæ§‹ï¼ˆTertiaryï¼‰   â†’ å®Œæ•´è›‹ç™½è³ª 3D å½¢ç‹€ï¼ˆå–®ä¸€éˆï¼‰
     â†“ å¤šéˆçµ„åˆ
å››ç´šçµæ§‹ï¼ˆQuaternaryï¼‰ â†’ å¤šå€‹è›‹ç™½è³ªäºåŸºçµ„æˆè¤‡åˆé«”
```

**å°æ‡‰çš„å››ç´šç©æœ¨ç³»çµ±**:

```
L3 - è¡¨é”å¼ç´š    â†’ ä¸€ç´šçµæ§‹ï¼ˆåŸºæœ¬å…ƒç´ ï¼‰
     â†“ çµ„åˆ
L2 - èªå¥ç´š      â†’ äºŒç´šçµæ§‹ï¼ˆå±€éƒ¨åŠŸèƒ½å–®å…ƒï¼‰
     â†“ çµ„åˆ
L1 - æ¨¡æ¿ç´š      â†’ ä¸‰ç´šçµæ§‹ï¼ˆå®Œæ•´åŠŸèƒ½æ¨¡çµ„ï¼‰
     â†“ å”ä½œ
L0 - ç³»çµ±ç´š      â†’ å››ç´šçµæ§‹ï¼ˆå¤šæ¨¡çµ„ç³»çµ±ï¼‰
```

**å°æ‡‰ç´°ç¯€**:

| è›‹ç™½è³ª | ç¨‹å¼ç©æœ¨ | åŠŸèƒ½ |
|--------|---------|------|
| **ä¸€ç´šçµæ§‹**: èƒºåŸºé…¸åºåˆ— | **L3**: è¡¨é”å¼ `x + 1`, `arr[i]` | æœ€åŸºæœ¬çš„è³‡è¨Šå–®å…ƒ |
| **äºŒç´šçµæ§‹**: Î±-èºæ—‹ã€Î²-æ‘ºæ¿ | **L2**: `for`, `if`, `function` | å±€éƒ¨åŠŸèƒ½çµæ§‹ |
| **ä¸‰ç´šçµæ§‹**: å®Œæ•´è›‹ç™½è³ª | **L1**: å®Œæ•´ç¨‹å¼æ¨¡æ¿ | ç¨ç«‹åŠŸèƒ½å–®å…ƒ |
| **å››ç´šçµæ§‹**: è›‹ç™½è³ªè¤‡åˆé«” | **L0**: å¤šæ¨¡çµ„ç³»çµ± | è¤‡é›œå”åŒç³»çµ± |

**é—œéµæ´å¯Ÿ**:
- è›‹ç™½è³ªçš„**æŠ˜ç–Š**ï¼ˆfoldingï¼‰å°æ‡‰ç©æœ¨çš„**æ‘ºç–Š**ï¼ˆcollapseï¼‰
- å¤šè‚½éˆçš„**å±•é–‹**ï¼ˆunfoldï¼‰å°æ‡‰ç©æœ¨çš„**å±•é–‹**ï¼ˆexpandï¼‰
- äºŒç´šçµæ§‹çš„**åŠŸèƒ½åŸŸ**å°æ‡‰ L2 çš„**æ§åˆ¶çµæ§‹**
- å››ç´šçµæ§‹çš„**äºåŸº**å°æ‡‰ L0 çš„**æ¨¡æ¿çµ„åˆ**

---

##### Topology â†” ç³»çµ±çµ„ç¹”

**ç”Ÿç‰©ç³»çµ±ç¶²çµ¡**:
```
è›‹ç™½è³ªäº¤äº’ç¶²çµ¡ (PPI Network)
ä»£è¬é€šè·¯ç¶²çµ¡ (Metabolic Pathways)
åŸºå› èª¿æ§ç¶²çµ¡ (Gene Regulatory Network)
```

**ç¨‹å¼ç³»çµ±åœ–è­œ**:
```
Call Graphï¼ˆå‘¼å«åœ–ï¼‰
Data Flowï¼ˆæ•¸æ“šæµåœ–ï¼‰
Dependency Graphï¼ˆä¾è³´åœ–ï¼‰
```

**å…±åŒç‰¹å¾µ**:
- ç¯€é»ä»£è¡¨åŠŸèƒ½å–®å…ƒï¼ˆè›‹ç™½è³ª/å‡½å¼ï¼‰
- é‚Šä»£è¡¨é—œä¿‚ï¼ˆäº’å‹•/å‘¼å«ï¼‰
- æ­ç¤ºç³»çµ±å±¤ç´šçš„çµ„ç¹”
- å¯åˆ†æé—œéµè·¯å¾‘ã€ç“¶é ¸ã€å¾ªç’°

---

#### C.3 è½‰æ›éç¨‹çš„ç”Ÿç‰©å­¸å°æ‡‰

##### DNA â†’ è›‹ç™½è³ªï¼ˆä¸­å¿ƒæ³•å‰‡ï¼‰

```
DNA â”€â”€è½‰éŒ„â†’ RNA â”€â”€ç¿»è­¯â†’ è›‹ç™½è³ª â”€â”€æŠ˜ç–Šâ†’ åŠŸèƒ½çµæ§‹
 â†‘_________________________________â†“
          ï¼ˆåå‘å·¥ç¨‹ï¼šæ¥µå›°é›£ï¼‰
```

**ç‰¹æ€§**:
- **è³‡è¨Šæå¤±**: DNA åŒ…å«å…§å«å­ï¼ˆintronsï¼‰ï¼Œç¿»è­¯æ™‚æœƒè¢«ç§»é™¤
- **ä¸€å°å¤šæ˜ å°„**: åŒä¸€æ®µ DNA å¯ç”¢ç”Ÿä¸åŒè›‹ç™½è³ªï¼ˆé¸æ“‡æ€§å‰ªæ¥ï¼‰
- **ä¸å¯é€†**: ç„¡æ³•å¾è›‹ç™½è³ªå®Œå…¨é‚„åŸ DNAï¼ˆåºåˆ—é€€åŒ–ï¼‰
- **æŠ˜ç–Šå•é¡Œ**: è›‹ç™½è³ªæŠ˜ç–Šæ˜¯ NP-hard å•é¡Œ

##### Code â†’ Blockï¼ˆçµæ§‹åŒ–ï¼‰

```
Code â”€â”€è§£æâ†’ AST â”€â”€çµæ§‹åŒ–â†’ Block â”€â”€æ‘ºç–Šâ†’ åŠŸèƒ½æ¨¡çµ„
 â†‘_____________________________________â†“
          ï¼ˆåå‘å·¥ç¨‹ï¼šå¯èƒ½ä½†æœ‰æå¤±ï¼‰
```

**å°æ‡‰**:
- **è³‡è¨Šæå¤±**: æ ¼å¼ã€è¨»è§£å¯èƒ½éºå¤±
- **ä¸€å°å¤šæ˜ å°„**: åŒä¸€æ®µç¨‹å¼ç¢¼å¯å°æ‡‰å¤šç¨®ç©æœ¨çµ„åˆ
- **è¿‘ä¼¼å¯é€†**: å¯ä»¥é‚„åŸï¼Œä½†å¯èƒ½å¤±å»æ ¼å¼ç´°ç¯€
- **æ‘ºç–Šå•é¡Œ**: æ±ºå®šå¦‚ä½•çµ„åˆç©æœ¨ç‚ºé«˜éšæ¨¡çµ„æ˜¯è¤‡é›œçš„

---

#### C.4 ã€Œä¼´ä¾¶è›‹ç™½ã€èˆ‡ Transformation Assistant

**ä¼´ä¾¶è›‹ç™½ï¼ˆChaperone Proteinï¼‰**:
- ç•¶è›‹ç™½è³ªæŠ˜ç–Šéç¨‹è¤‡é›œæ™‚ï¼Œéœ€è¦ä¼´ä¾¶è›‹ç™½è¼”åŠ©
- é˜²æ­¢éŒ¯èª¤æŠ˜ç–Šï¼ˆmisfoldingï¼‰
- å¼•å°æ­£ç¢ºçš„æŠ˜ç–Šè·¯å¾‘
- ç¯„ä¾‹ï¼šç†±ä¼‘å…‹è›‹ç™½ï¼ˆHeat Shock Proteinï¼‰

**Transformation Assistant**:
- ç•¶ç¨‹å¼å½¢æ…‹è½‰æ›è¤‡é›œæ™‚ï¼Œéœ€è¦åŠ©æ‰‹è¼”åŠ©
- é˜²æ­¢éŒ¯èª¤è½‰æ›ï¼ˆincorrect transformationï¼‰
- æä¾›å¤šç¨®è½‰æ›é¸é …
- å­¸ç¿’ä½¿ç”¨è€…åå¥½

**é¡æ¯”**:

| ä¼´ä¾¶è›‹ç™½ | Transformation Assistant |
|---------|--------------------------|
| è­˜åˆ¥æŠ˜ç–Šå›°é›£çš„è›‹ç™½è³ª | è­˜åˆ¥ä½ä¿¡å¿ƒåº¦çš„è½‰æ›ï¼ˆ< 0.9ï¼‰ |
| æä¾›ç©©å®šç’°å¢ƒé¿å…èšé›† | æä¾›äº’å‹•ä»‹é¢é¿å…éŒ¯èª¤é¸æ“‡ |
| å¼•å°æ­£ç¢ºæŠ˜ç–Šè·¯å¾‘ | æ¨è–¦åˆé©çš„è½‰æ›é¸é … |
| ATP é©…å‹•ï¼ˆéœ€è¦èƒ½é‡ï¼‰ | è¨ˆç®—è³‡æºé©…å‹• |

---

#### C.5 è³‡è¨Šæå¤±èˆ‡å¿…è¦çš„æŠ½è±¡

**ç”Ÿç‰©å­¸è¦–è§’**:

åœ¨ DNA â†’ è›‹ç™½è³ªçš„éç¨‹ä¸­ï¼Œä¸¦éæ‰€æœ‰è³‡è¨Šéƒ½ä¿ç•™ï¼š

```
DNA: ...ATGCGATCGTAGCTAGCTAAGTAG...
      â†“ ï¼ˆç§»é™¤å…§å«å­ã€èª¿æ§åºåˆ—ï¼‰
mRNA: ...AUGCGAUCGUAGCUAGCUAAGUAG...
      â†“ ï¼ˆä¸‰è¯é«”å¯†ç¢¼å­ â†’ èƒºåŸºé…¸ï¼‰
è›‹ç™½è³ª: Met-Arg-Ser-*ï¼ˆåƒ…ä¿ç•™å¿…è¦è³‡è¨Šï¼‰
```

**é—œéµæ´å¯Ÿ**:
> **æå¤±æ˜¯å¿…è¦çš„æŠ½è±¡** - ä¸æ˜¯æ‰€æœ‰ç´°ç¯€éƒ½é‡è¦ï¼ŒæŠ½è±¡åŒ–çš„æœ¬è³ªå°±æ˜¯æœ‰é¸æ“‡æ€§çš„éºå¿˜ã€‚

**å°æ‡‰åˆ°ç¨‹å¼è½‰æ›**:

```c
// åŸå§‹ C ç¨‹å¼ç¢¼ï¼ˆä¿ç•™æ ¼å¼ã€è¨»è§£ï¼‰
for(int i = 0; i < 10; i++) {  // è¿´åœˆ 10 æ¬¡
    printf("%d\n", i);
}

â†“ ï¼ˆçµæ§‹åŒ–ï¼šéºå¤±æ ¼å¼å’Œè¨»è§£ï¼‰

[universal_for_loop]
  iterator: i
  start: 0
  end: 9
  body: [print] i

â†“ ï¼ˆåºåˆ—åŒ–ï¼šç”Ÿæˆ Pythonï¼Œæ ¼å¼ä¸åŒï¼‰

for i in range(10):
    print(i)
```

**éºå¤±çš„è³‡è¨Š**:
- âœ— è¨»è§£ã€Œè¿´åœˆ 10 æ¬¡ã€
- âœ— åŸå§‹æ ¼å¼ï¼ˆç¸®æ’ã€ç©ºè¡Œï¼‰
- âœ— C ç‰¹å®šèªæ³•ï¼ˆ`int i = 0`ï¼‰

**ä¿ç•™çš„è³‡è¨Š**:
- âœ“ æ ¸å¿ƒé‚è¼¯ï¼ˆè¿´åœˆ 0-9ï¼‰
- âœ“ åŠŸèƒ½èªç¾©ï¼ˆå°å‡ºæ•¸å­—ï¼‰
- âœ“ æ§åˆ¶æµçµæ§‹

**çµè«–**: å°±åƒ DNA çš„éç·¨ç¢¼å€åŸŸåœ¨ç¿»è­¯æ™‚è¢«å¿½ç•¥ï¼Œç¨‹å¼ç¢¼çš„ã€Œéæœ¬è³ªè³‡è¨Šã€åœ¨è½‰æ›æ™‚å¯ä»¥åˆç†éºå¤±ã€‚

---

#### C.6 æ”¶æ–‚æ€§èˆ‡ Autoencoder é¡æ¯”

**è›‹ç™½è³ªæŠ˜ç–Šçš„ç©©å®šç‹€æ…‹**:

è›‹ç™½è³ªæœƒæŠ˜ç–Šè‡³**èƒ½é‡æœ€ä½çš„ç©©å®šç‹€æ…‹**ï¼š

```
éš¨æ©Ÿè‚½éˆ â†’ æŠ˜ç–Šéç¨‹ â†’ ç©©å®šçµæ§‹ â†º ï¼ˆç¶­æŒç©©å®šï¼‰
         ï¼ˆèƒ½é‡ä¸‹é™ï¼‰
```

ç‰¹æ€§ï¼š
- çµ¦å®šåºåˆ— â†’ ç‰¹å®šçš„ç©©å®šçµæ§‹ï¼ˆå¹¾ä¹å”¯ä¸€ï¼‰
- ç©©å®šçµæ§‹æœƒè‡ªæˆ‘ç¶­æŒ
- å¤–åŠ›æ“¾å‹•å¾Œæœƒå›åˆ°ç©©å®šç‹€æ…‹

**ç¨‹å¼å¤šå½¢æ…‹è½‰æ›çš„æ”¶æ–‚**:

```
Code â†’ Structure â†’ Topology â†’ Structure â†’ Code â†’ ...
                    â†“
              æ”¶æ–‚è‡³ç©©å®šå½¢æ…‹
```

**Autoencoder è¦–è§’**:

```
     Encoder                 Decoder
Code â”€â”€â”€â”€â”€â”€â”€â”€â†’ Latent Space â”€â”€â”€â”€â”€â”€â”€â”€â†’ Code'
     ï¼ˆå£“ç¸®ï¼‰                  ï¼ˆé‡å»ºï¼‰

ç†æƒ³æƒ…æ³ï¼šCode â‰ˆ Code'ï¼ˆèªç¾©ç­‰åƒ¹ï¼‰
```

**æ”¶æ–‚æ¢ä»¶**:
- **èªç¾©ä¿æŒ**: æ ¸å¿ƒé‚è¼¯ä¸è®Š
- **çµæ§‹ç©©å®š**: è­˜åˆ¥å‡ºçš„æ¨¡å¼ä¸€è‡´
- **æå¤±æ”¶æ–‚**: æ¯æ¬¡è½‰æ›çš„æå¤±è¶¨æ–¼é›¶

**å¯¦éš›æ‡‰ç”¨**:
- æ¸¬è©¦æ”¶æ–‚æ€§ï¼šå¤šæ¬¡ Code â†’ Block â†’ Code æ˜¯å¦ç©©å®š
- è¨“ç·´è³‡æ–™ï¼šæ”¶é›†ã€Œç©©å®šå°ã€ä½œç‚ºè¨“ç·´è³‡æ–™
- å“è³ªæŒ‡æ¨™ï¼šæ”¶æ–‚é€Ÿåº¦åæ˜ è½‰æ›å“è³ª

---

#### C.7 å°ˆæœ‰åè©çš„ã€Œå»ç”Ÿç‰©å­¸åŒ–ã€

é›–ç„¶ç”Ÿç‰©å­¸é¡æ¯”æä¾›äº†æ·±åˆ»æ´å¯Ÿï¼Œä½†åœ¨å¯¦éš›é–‹ç™¼ä¸­ï¼Œæˆ‘å€‘æ‡‰ä½¿ç”¨**ä¸­æ€§ã€ç›´è§€çš„è¡“èª**ï¼Œé¿å…è®“éç”Ÿç‰©èƒŒæ™¯çš„é–‹ç™¼è€…å›°æƒ‘ã€‚

**å»ºè­°çš„è¡“èªå°æ‡‰**:

| ç”Ÿç‰©å­¸è¡“èª | ä¸­æ€§è¡“èªï¼ˆå»ºè­°ä½¿ç”¨ï¼‰ | èªªæ˜ |
|-----------|---------------------|------|
| Chaperone Proteinï¼ˆä¼´ä¾¶è›‹ç™½ï¼‰ | Transformation Assistant | è½‰æ›è¼”åŠ©å·¥å…· |
| Primary Structureï¼ˆä¸€ç´šçµæ§‹ï¼‰ | Expression Level (L3) | è¡¨é”å¼å±¤ç´š |
| Secondary Structureï¼ˆäºŒç´šçµæ§‹ï¼‰ | Statement Level (L2) | èªå¥å±¤ç´š |
| Tertiary Structureï¼ˆä¸‰ç´šçµæ§‹ï¼‰ | Template Level (L1) | æ¨¡æ¿å±¤ç´š |
| Quaternary Structureï¼ˆå››ç´šçµæ§‹ï¼‰ | System Level (L0) | ç³»çµ±å±¤ç´š |
| Foldingï¼ˆæŠ˜ç–Šï¼‰ | Collapse / Fold | æ‘ºç–Š |
| Unfoldingï¼ˆå±•é–‹ï¼‰ | Expand | å±•é–‹ |
| Misfoldingï¼ˆéŒ¯èª¤æŠ˜ç–Šï¼‰ | Incorrect Transformation | éŒ¯èª¤è½‰æ› |
| Genomeï¼ˆåŸºå› çµ„ï¼‰ | Template Collection | æ¨¡æ¿é›†åˆ |
| Gene Expressionï¼ˆåŸºå› è¡¨ç¾ï¼‰ | Template Instantiation | æ¨¡æ¿å¯¦ä¾‹åŒ– |

**ä½¿ç”¨åŸå‰‡**:
1. **æ–‡æª”ä¸­**: å¯ä»¥æåŠç”Ÿç‰©å­¸é¡æ¯”ä½œç‚º**è§£é‡‹å’Œå•Ÿç™¼**
2. **ç¨‹å¼ç¢¼ä¸­**: ä¸€å¾‹ä½¿ç”¨**ä¸­æ€§è¡“èª**
3. **UI ä¸­**: é¿å…ç”Ÿç‰©å­¸è¡“èªï¼Œä½¿ç”¨**é€šä¿—æ˜“æ‡‚çš„æè¿°**

**ç¯„ä¾‹**:

âŒ **ä¸å»ºè­°**ï¼ˆéåº¦ç”Ÿç‰©å­¸åŒ–ï¼‰:
```typescript
class ChaperoneProtein {
  unfoldQuaternaryStructure(genome: DNA): PrimaryStructure {}
}
```

âœ… **å»ºè­°**ï¼ˆæ¸…æ™°ä¸­æ€§ï¼‰:
```typescript
class TransformationAssistant {
  expandSystemLevel(templates: TemplateCollection): ExpressionList {}
}
```

---

#### C.8 ç”Ÿç‰©å­¸é¡æ¯”çš„é™åˆ¶èˆ‡å·®ç•°

é›–ç„¶é¡æ¯”å¾ˆç²¾å½©ï¼Œä½†æˆ‘å€‘å¿…é ˆèªè­˜åˆ°**ç¨‹å¼ç³»çµ±èˆ‡ç”Ÿç‰©ç³»çµ±çš„æœ¬è³ªå·®ç•°**ï¼š

| é¢å‘ | ç”Ÿç‰©ç³»çµ± | ç¨‹å¼ç³»çµ± |
|-----|---------|---------|
| **ç¢ºå®šæ€§** | éš¨æ©Ÿèˆ‡æ¦‚ç‡ï¼ˆé‡å­æ•ˆæ‡‰ï¼‰ | ç¢ºå®šæ€§ï¼ˆç†æƒ³æƒ…æ³ï¼‰ |
| **å¯é€†æ€§** | å¹¾ä¹ä¸å¯é€†ï¼ˆç†µå¢ï¼‰ | å¯ä»¥è¨­è¨ˆç‚ºå¯é€† |
| **éŒ¯èª¤è™•ç†** | æ¼”åŒ–èˆ‡è‡ªç„¶é¸æ“‡ | æ˜ç¢ºçš„éŒ¯èª¤è™•ç†é‚è¼¯ |
| **è¤‡é›œåº¦ä¾†æº** | æ•¸åå„„å¹´æ¼”åŒ–ç´¯ç© | äººç‚ºè¨­è¨ˆèˆ‡çµ„åˆ |
| **å„ªåŒ–ç›®æ¨™** | ç”Ÿå­˜èˆ‡ç¹æ®– | åŠŸèƒ½éœ€æ±‚èˆ‡æ•ˆèƒ½ |
| **è®Šç•°æ©Ÿåˆ¶** | çªè®Šï¼ˆéš¨æ©Ÿï¼‰ | é‡æ§‹ï¼ˆæœ‰æ„åœ–ï¼‰ |

**é—œéµå·®ç•°**:

1. **æ„åœ– vs. æ¼”åŒ–**
   - ç”Ÿç‰©ï¼šç„¡è¨­è¨ˆè€…ï¼Œæ¼”åŒ–è€Œä¾†
   - ç¨‹å¼ï¼šæœ‰æ˜ç¢ºè¨­è¨ˆæ„åœ–

2. **å®¹éŒ¯æ€§**
   - ç”Ÿç‰©ï¼šé«˜åº¦å®¹éŒ¯ï¼ˆå†—é¤˜æ©Ÿåˆ¶ï¼‰
   - ç¨‹å¼ï¼šé€šå¸¸éœ€è¦ç²¾ç¢ºç„¡èª¤

3. **æ™‚é–“å°ºåº¦**
   - ç”Ÿç‰©ï¼šç™¾è¬å¹´æ¼”åŒ–
   - ç¨‹å¼ï¼šæ•¸å¹´æˆ–æ•¸åå¹´ç™¼å±•

**çµè«–**:
> ç”Ÿç‰©å­¸é¡æ¯”æ˜¯**å•Ÿç™¼æ€§çš„**ï¼ˆheuristicï¼‰ï¼Œè€Œé**ç²¾ç¢ºå°æ‡‰**ï¼ˆexact mappingï¼‰ã€‚å®ƒå¹«åŠ©æˆ‘å€‘ç†è§£è³‡è¨Šçµ„ç¹”çš„æ™®éæ¨¡å¼ï¼Œä½†ä¸æ‡‰é™åˆ¶æˆ‘å€‘çš„è¨­è¨ˆæ€ç¶­ã€‚

---

#### C.9 å¾é¡æ¯”ä¸­å­¸åˆ°çš„è¨­è¨ˆåŸå‰‡

ç”Ÿç‰©å­¸é¡æ¯”çµ¦æˆ‘å€‘çš„å•Ÿç¤ºï¼š

##### 1. åˆ†å±¤çµ„ç¹”çš„åŠ›é‡

**ç”Ÿç‰©**: DNA â†’ RNA â†’ è›‹ç™½è³ª â†’ ç´°èƒ â†’ çµ„ç¹” â†’ å™¨å®˜
**ç¨‹å¼**: Code â†’ AST â†’ Block â†’ Module â†’ System

**å•Ÿç¤º**:
- æ¯ä¸€å±¤éƒ½æœ‰å…¶**æœ€é©è¡¨é”å½¢æ…‹**
- è·¨å±¤è½‰æ›éœ€è¦**ä¸­ä»‹æ©Ÿåˆ¶**
- å±¤ç´šä¹‹é–“è¦**æ˜ç¢ºç•Œç·š**

##### 2. è³‡è¨Šå£“ç¸®èˆ‡å±•é–‹

**ç”Ÿç‰©**: åŸºå› çµ„ï¼ˆ3GBï¼‰â†’ è›‹ç™½è³ªçµ„ï¼ˆæ›´è¤‡é›œï¼‰â†’ ç”Ÿå‘½æ´»å‹•
**ç¨‹å¼**: Templateï¼ˆç°¡æ½”ï¼‰â†’ å¯¦ä¾‹åŒ–ï¼ˆå…·é«”ï¼‰â†’ åŸ·è¡Œ

**å•Ÿç¤º**:
- **æ¨¡æ¿æ˜¯å£“ç¸®**çš„çŸ¥è­˜
- **å¯¦ä¾‹åŒ–æ˜¯å±•é–‹**çš„éç¨‹
- éœ€è¦å¹³è¡¡**å£“ç¸®ç‡èˆ‡å¯ç†è§£æ€§**

##### 3. å®¹éŒ¯èˆ‡å†—é¤˜

**ç”Ÿç‰©**: åŒç¾©å¯†ç¢¼å­ã€DNA ä¿®å¾©æ©Ÿåˆ¶ã€å†—é¤˜åŸºå› 
**ç¨‹å¼**: éŒ¯èª¤è™•ç†ã€é™ç´šæ–¹æ¡ˆã€å‚™ä»½æ©Ÿåˆ¶

**å•Ÿç¤º**:
- é—œéµè½‰æ›éœ€è¦**å¤šé‡é©—è­‰**
- æä¾›**é™ç´šé¸é …**ï¼ˆfallbackï¼‰
- å®¹å¿**å°ç¯„åœçš„è³‡è¨Šæå¤±**

##### 4. å”åŒèˆ‡æ¨¡çµ„åŒ–

**ç”Ÿç‰©**: è›‹ç™½è³ªè¤‡åˆé«”å”åŒå·¥ä½œ
**ç¨‹å¼**: æ¨¡çµ„åŒ–è¨­è¨ˆã€å¾®æœå‹™æ¶æ§‹

**å•Ÿç¤º**:
- **L0 ç³»çµ±ç´š**è¨­è¨ˆå¾ˆé‡è¦
- æ¨¡çµ„é–“éœ€è¦**æ˜ç¢ºä»‹é¢**
- æ”¯æ´**å‹•æ…‹çµ„åˆ**

##### 5. æ¼”åŒ–èˆ‡æ¼¸é€²

**ç”Ÿç‰©**: ç‰©ç¨®é€æ­¥æ¼”åŒ–ï¼Œéä¸€è¹´è€Œå°±
**ç¨‹å¼**: å¾ v0.3 â†’ v0.4 â†’ v0.5ï¼Œé€æ­¥å®Œå–„

**å•Ÿç¤º**:
- **ä¸è¦è©¦åœ–ä¸€æ¬¡åšå®Œ**æ‰€æœ‰åŠŸèƒ½
- ä¿æŒ**å‘å¾Œå…¼å®¹æ€§**
- å…è¨±**æ¼¸é€²å¼é·ç§»**

---

#### C.10 é¡æ¯”åœ¨æ•™å­¸ä¸­çš„æ‡‰ç”¨

ç”Ÿç‰©å­¸é¡æ¯”å°**åˆå­¸è€…æ•™å­¸**ç‰¹åˆ¥æœ‰åƒ¹å€¼ï¼š

**å ´æ™¯ 1: è§£é‡‹ã€Œç‚ºä»€éº¼æœ‰ä¸‰ç¨®å½¢æ…‹ã€**

è€å¸«ï¼š
> ã€Œæƒ³åƒ DNA å’Œè›‹ç™½è³ªã€‚DNA æ˜¯æ–‡å­—åºåˆ—ï¼Œåƒç¨‹å¼ç¢¼ä¸€æ¨£ç·šæ€§æ’åˆ—ï¼Œæ˜“æ–¼å„²å­˜å’Œè¤‡è£½ã€‚ä½†è›‹ç™½è³ªæœƒæŠ˜ç–Šæˆç«‹é«”çµæ§‹ï¼Œæ‰èƒ½ç™¼æ®åŠŸèƒ½â€”â€”å°±åƒç©æœ¨ä¸€æ¨£ï¼Œçµ„åˆèµ·ä¾†æ‰æœ‰å¯¦éš›ç”¨é€”ã€‚è€Œç”Ÿç‰©ç³»çµ±ä¸­ï¼Œè¨±å¤šè›‹ç™½è³ªå”åŒå·¥ä½œå½¢æˆç¶²çµ¡ï¼Œå°±åƒç¨‹å¼çš„å‘¼å«åœ–ä¸€æ¨£ï¼ã€

**å ´æ™¯ 2: è§£é‡‹ã€Œå±•é–‹èˆ‡æ‘ºç–Šã€**

è€å¸«ï¼š
> ã€Œè›‹ç™½è³ªæœ‰å››ç´šçµæ§‹ã€‚ç•¶æˆ‘å€‘å±•é–‹ä¸€å€‹è¤‡é›œè›‹ç™½è³ªæ™‚ï¼Œæœƒçœ‹åˆ°å®ƒçš„çµ„æˆéƒ¨åˆ†â€”â€”å°±åƒå±•é–‹ä¸€å€‹ L1 ç©æœ¨ï¼Œçœ‹åˆ°è£¡é¢çš„ L2 èªå¥ã€‚é€™å¹«åŠ©æˆ‘å€‘ç†è§£ã€å¤§ç©æœ¨ã€æ˜¯æ€éº¼ç”±ã€å°ç©æœ¨ã€çµ„æˆçš„ï¼ã€

**å ´æ™¯ 3: è§£é‡‹ã€Œè³‡è¨Šæå¤±ã€**

è€å¸«ï¼š
> ã€Œå¾ DNA åˆ°è›‹ç™½è³ªï¼Œæœ‰äº›è³‡è¨Šæœƒéºå¤±â€”â€”ä¾‹å¦‚å…§å«å­è¢«ç§»é™¤äº†ã€‚ä½†é€™ä¸æ˜¯å£äº‹ï¼å°±åƒç¿»è­¯ç¨‹å¼ç¢¼æ™‚ï¼Œè¨»è§£å¯èƒ½æ¶ˆå¤±ï¼Œä½†æ ¸å¿ƒé‚è¼¯ä¿ç•™äº†ã€‚æˆ‘å€‘è¦çš„æ˜¯ã€åŠŸèƒ½ç­‰åƒ¹ã€ï¼Œè€Œä¸æ˜¯ã€å®Œå…¨ä¸€è‡´ã€ã€‚ã€

**å ´æ™¯ 4: è§£é‡‹ã€ŒTransformation Assistantã€**

è€å¸«ï¼š
> ã€Œæœ‰äº›è›‹ç™½è³ªæŠ˜ç–Šå¾ˆè¤‡é›œï¼Œéœ€è¦ã€ä¼´ä¾¶è›‹ç™½ã€å¹«å¿™â€”â€”å®ƒå€‘ä¸åƒèˆ‡æœ€çµ‚çµæ§‹,åªæ˜¯è¼”åŠ©æŠ˜ç–Šéç¨‹ã€‚åŒæ¨£åœ°ï¼Œç•¶ç¨‹å¼ç¢¼è½‰æ›å¾ˆè¤‡é›œæ™‚ï¼Œæˆ‘å€‘çš„ Transformation Assistant æœƒè·³å‡ºä¾†å”åŠ©ä½ é¸æ“‡æœ€é©åˆçš„æ–¹æ¡ˆï¼ã€

---

#### C.11 ç¸½çµï¼šç‚ºä»€éº¼é€™å€‹é¡æ¯”å¦‚æ­¤é‡è¦

ç”Ÿç‰©å­¸é¡æ¯”ä¸åªæ˜¯ä¸€å€‹æœ‰è¶£çš„æ¯”å–»ï¼Œå®ƒæ­ç¤ºäº†ï¼š

1. **æ™®éæ€§**: è³‡è¨Šåœ¨ä¸åŒå±¤æ¬¡çµ„ç¹”çš„æ¨¡å¼æ˜¯è·¨é ˜åŸŸçš„
2. **æ·±åˆ»æ€§**: å¹«åŠ©ç†è§£ã€Œç‚ºä½•éœ€è¦å¤šå½¢æ…‹ã€è€Œéã€Œå¦‚ä½•å¯¦ä½œå¤šå½¢æ…‹ã€
3. **å•Ÿç™¼æ€§**: å¼•å°è¨­è¨ˆæ±ºç­–ï¼ˆå¦‚å››ç´šç©æœ¨ã€å±•é–‹æ‘ºç–Šã€Transformation Assistantï¼‰
4. **æ•™å­¸æ€§**: æä¾›ç›´è§€çš„è§£é‡‹æ¡†æ¶ï¼Œé™ä½å­¸ç¿’é–€æª»
5. **å‰ç»æ€§**: é¡æ¯”åˆ° AIï¼ˆå¦‚ Autoencoderã€æ”¶æ–‚æ€§ï¼‰é ç¤ºæœªä¾†ç™¼å±•æ–¹å‘

**æœ€çµ‚æ´å¯Ÿ**:

> ç¨‹å¼ç¢¼ä¸åƒ…æ˜¯**æŒ‡ä»¤åºåˆ—**ï¼Œæ›´æ˜¯**å¯ä»¥åœ¨å¤šå€‹å±¤æ¬¡çµ„ç¹”å’Œè¡¨é”çš„è³‡è¨Š**ã€‚
> ç†è§£é€™ä¸€é»ï¼Œå°±ç†è§£äº† TextBricks å¤šå½¢æ…‹æ¶æ§‹çš„æ ¸å¿ƒå“²å­¸ã€‚

**ç”¨æˆ¶çš„ç²¾å½©å¼•è¨€**:
> "å¯ä»¥æƒ³åƒ DNAï¼ˆsequenceï¼‰ã€è›‹ç™½è³ªå››ç´šçµæ§‹ï¼ˆstructureï¼‰ã€ç³»çµ±çµ„ç¹”ï¼ˆtopologyï¼‰ä¹‹é–“çš„é—œä¿‚"

é€™å¥è©±é–‹å•Ÿäº†ä¸€å€‹å…¨æ–°çš„è¦–è§’ï¼Œè®“æˆ‘å€‘çœ‹åˆ°ç¨‹å¼è¨­è¨ˆçš„æœ¬è³ªâ€”â€”
**è³‡è¨Šçš„å±¤æ¬¡åŒ–çµ„ç¹”èˆ‡å¤šå½¢æ…‹è¡¨é”**ã€‚ğŸ§¬ â†’ ğŸ§± â†’ ğŸŒ

---

**ç‰ˆæœ¬æ­·å²**:
- **v1.0** (2025-10-20): åˆç‰ˆï¼Œå®Œæ•´æ¶æ§‹è¨­è¨ˆ
- **v2.0** (2025-10-20): é‡å¤§æ›´æ–°
  - å››ç´šç©æœ¨ç³»çµ± (L0/L1/L2/L3)
  - ç©æœ¨å±•é–‹æ‘ºç–Šæ©Ÿåˆ¶
  - åœ–è­œç³»çµ±ï¼šæ··åˆäº’å‹•æ¨¡å¼ + å…­ç¨®å¸ƒå±€ç®—æ³•
  - Transformation Assistantï¼ˆå—ä¼´ä¾¶è›‹ç™½å•Ÿç™¼ï¼‰
  - å°æ‡‰é—œä¿‚ç®¡ç†ç³»çµ±
  - Template Registry
  - v0.3.2 æ±ºç­–ï¼šæš«ç·©å¯¦æ–½ï¼Œç›´æ¥é€²å…¥ v0.4.0
  - æ›´æ–°å¯¦æ–½è·¯ç·šåœ–ï¼ˆv0.4.0 é‡æ–°è¨­è¨ˆï¼‰
  - 23 å€‹é–‹æ”¾å•é¡Œè©³ç´°åˆ†æ
  - ç”Ÿç‰©å­¸é¡æ¯”å®Œæ•´é—¡è¿°ï¼ˆé™„éŒ„ Cï¼‰
  - å°ˆæœ‰åè©å»ç”Ÿç‰©å­¸åŒ–ï¼ˆæ­£æ–‡ä½¿ç”¨ä¸­æ€§è¡“èªï¼‰

**ä¸‹ä¸€æ­¥**:
1. âœ… å®Œæˆæ¶æ§‹è¨­è¨ˆæ–‡æª” v2.0
2. âœ… åŠ å…¥ç”Ÿç‰©å­¸é¡æ¯”å®Œæ•´é—¡è¿°ï¼ˆé™„éŒ„ Cï¼‰
3. âœ… çµ±ä¸€å°ˆæœ‰åè©ï¼ˆå»ç”Ÿç‰©å­¸åŒ–ï¼‰
4. ğŸ’¬ èˆ‡åœ˜éšŠè¨è«– 23 å€‹é–‹æ”¾å•é¡Œ
5. ğŸ“‹ æ ¹æ“šè¨è«–çµæœæ›´æ–°è¨­è¨ˆ
6. ğŸš€ é–‹å§‹ v0.4.0 å¯¦ä½œæº–å‚™

**æ–‡æª”çµ±è¨ˆ**:
- ç¸½è¡Œæ•¸ï¼šç´„ 6,000+ è¡Œ
- ä¸»è¦ç« ç¯€ï¼š14 å€‹
- æ–°å¢ç« ç¯€ï¼š4 å€‹ï¼ˆå±•é–‹æ‘ºç–Šã€Transformation Assistantã€å°æ‡‰é—œä¿‚ã€Registryï¼‰
- é–‹æ”¾å•é¡Œï¼š23 å€‹ï¼ˆå«åŸæœ‰ 7 å€‹ + æ–°å¢ 16 å€‹ï¼‰
- é™„éŒ„ï¼š3 å€‹ï¼ˆå°ˆæœ‰åè©ã€åƒè€ƒæ–‡ç»ã€ç”Ÿç‰©å­¸é¡æ¯”ï¼‰
