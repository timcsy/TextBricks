# TextBricks - AI Agents 參考文件

> 🤖 **給 AI 助手的上下文文件**  
> 此文件包含完整的項目狀態、架構資訊和發展規劃，供 Claude Code 等 AI 助手參考。
> 
> **使用方式**：
> - 📖 **會話開始時** - 請先閱讀此文件了解項目全貌
> - 📝 **重要變更時** - 請更新相關章節並記錄變更日誌

## 📋 產品概述

**TextBricks** - 多平台程式碼模板工具，專為程式設計初學者設計，支援 C、Python、JavaScript 三種語言的結構化學習。

### 核心價值
- 🎯 **降低學習門檻** - 提供結構化學習路徑
- 🌐 **多平台支援** - 統一體驗，跨平台使用
- 🚀 **智慧輔助** - 上下文感知推薦和自動格式化
- 📚 **豐富文檔** - 互動式說明和範例

## 🏗️ 架構狀態

### ✅ 已完成 - Phase 1: 多平台架構重構

**當前架構**：平台無關核心 + 適配器模式

```
📁 TextBricks 架構
├── 🧠 Core Services (平台無關)
│   ├── TextBricksEngine - 統一模板引擎
│   ├── DocumentationService - 文檔處理
│   ├── SearchService - 搜尋邏輯
│   └── CodeOperationService - 程式碼操作
├── 🔌 Platform Adapters
│   ├── VSCodePlatform - VS Code 適配器
│   ├── VSCodeEditor - 編輯器抽象
│   ├── VSCodeUI - 用戶界面抽象
│   └── VSCodeStorage - 存儲抽象
└── 📝 Interfaces - 平台接口定義
```

**重構成果**：
- ✅ 核心邏輯與 VS Code API 完全分離
- ✅ 類型安全的平台接口定義
- ✅ 零破壞性變更，向後兼容
- ✅ 為多平台擴展奠定基礎

## 🚀 功能現狀

### VS Code 版本功能 (v0.2.1)

#### 核心功能
- ✅ **多語言支援** - C, Python, JavaScript 切換
- ✅ **四層級模板** - 基礎語法 → 控制結構 → 函數資料 → 進階應用
- ✅ **智慧操作** - 點擊插入、拖曳插入、工具提示預覽
- ✅ **智慧縮排** - 自動調整至游標位置，保持相對結構
- ✅ **文檔系統** - Markdown 支援、互動式程式碼區塊

#### 進階功能
- ✅ **模板管理** - CRUD 操作、匯入匯出、批次處理
- ✅ **智慧推薦** - 基於使用頻率的個人化推薦
- ✅ **上下文感知** - 預留擴展架構

#### 技術特性
- ✅ **TypeScript** - 完整類型安全
- ✅ **Webview UI** - 響應式設計
- ✅ **JSON 資料** - 結構化模板儲存
- ✅ **測試覆蓋** - 單元測試框架

## 🎯 發展規劃

### Phase 2: 功能增強 (優先)

#### 🎯 智慧化升級
- [ ] **完整上下文感知** - 項目類型檢測、框架識別
- [ ] **機器學習推薦** - 個人化學習路徑
- [ ] **學習追蹤** - 進度統計、技能評估
- [ ] **進階模板系統** - 動態變數替換、條件模板
- [ ] **智慧縮排增強** - 更精確的程式碼格式化

#### 🧭 知識圖譜導航系統
- [ ] **快取式階層導航** - 多層級模板組織和快速切換
  - 左右箭頭切換階層，常用項目快取展示
  - 檔案（階層末端）、資料夾（階層移動）、捷徑（跨層跳轉）整合
  - 上下文感知的階層切換和推薦
- [ ] **CRDT 協作知識圖譜** - 分散式協作編輯
  - 共享知識圖譜，外部連結整合
  - 修改審核機制，協作模式切換
  - 還原點系統，協作進出控制
- [ ] **自動化知識圖譜完善** - 智慧內容擴充
  - 使用者編輯內容為基底，確認後加入系統
  - 可選擇內容更新策略（不變/隨時更新）
- [ ] **置信度網絡系統** - 分層信任機制
  - 權柄者連結高置信度，信任鍊記錄
  - 社群化置信度網絡，不同群體不同標準
  - 糾正反饋機制，動態調整置信度評級

#### 🌐 生態擴展
- [ ] **更多語言** - Java, Go, Rust, Swift, TypeScript
- [ ] **本地化** - 英文、日文界面
- [ ] **社群功能** - 模板分享、評分系統
- [ ] **協作功能** - 團隊模板庫、模板同步
- [ ] **主題系統** - 可自訂界面主題和樣式

#### 📚 文檔和學習體系
- [ ] **互動式教學** - 步驟引導式學習
- [ ] **程式碼解釋** - 自動生成程式碼註解
- [ ] **最佳實踐建議** - 程式碼品質提示
- [ ] **學習路徑規劃** - 個人化課程推薦

### Phase 3: 多平台擴展 (後續)

#### 🔧 Priority 1: Vim/NeoVim 插件
**目標**：輕量、高效的命令行整合

**技術方案**：Neovim + Lua

**核心特性**：
- 🎮 **浮動窗口** - 模板選擇器界面
- ⌨️ **命令整合** - `:TextBrick python hello-world`
- 🔍 **快速搜尋** - 即時過濾和自動完成
- ⚡ **高性能** - 毫秒級響應

**開發階段**：
- [ ] **Phase 3.1** (2-3週) - 基礎架構和 Lua 專案
- [ ] **Phase 3.2** (2-3週) - 核心功能和 UI 實作
- [ ] **Phase 3.3** (1-2週) - 生態整合和客製化

#### 📱 Phase 3.4: 其他平台 (後續)
- **Chrome 擴展** - 線上編程環境整合
- **Obsidian 插件** - 筆記和學習整合  
- **Zed 擴展** - 現代編輯器支援
- **Sublime Text** - 經典編輯器支援
- **Atom 系列** - GitHub 生態整合

## 📊 當前優先級

### ⚡ 立即執行
1. **智慧化功能開發** - 上下文感知、機器學習推薦
2. **更多語言支援** - Java, Go, Rust, Swift, TypeScript
3. **知識圖譜導航系統** - 快取式階層、CRDT 協作、置信度網絡
4. **文檔和學習體系** - 互動式教學、程式碼解釋

### 🔄 中期目標  
1. **社群和協作功能** - 模板分享、團隊協作
2. **本地化和主題系統** - 多語言界面、可自訂樣式
3. **學習追蹤系統** - 進度統計、技能評估

### 🌟 長期願景
1. **完整學習生態** - 個人化學習路徑、最佳實踐建議
2. **多平台擴展** - Vim, Chrome, Obsidian 等編輯器整合
3. **AI 輔助增強** - 智慧程式碼生成和學習建議

## 🚧 技術債務

### 已解決
- ✅ VS Code 緊耦合問題 - 已重構為平台無關架構
- ✅ 重複代碼問題 - 統一核心服務層
- ✅ 類型安全問題 - 完整 TypeScript 接口

### 待處理
- [ ] 測試覆蓋率提升
- [ ] 效能優化 (大量模板場景)
- [ ] 錯誤處理完善

## 📈 成功指標

### VS Code 版本
- **安裝數量** - 目前基準線建立
- **使用頻率** - DAU/MAU 追蹤
- **模板使用** - 操作統計分析
- **用戶反饋** - 評價和 GitHub Issues

### 多平台目標
- **Vim 用戶接受度** - 社群反應
- **跨平台使用率** - 平台分佈統計
- **生態影響力** - 社群貢獻和討論

## 📅 時間規劃

### 2025 Q3 (當前)
- ✅ VS Code 架構重構完成 (v0.2.1)
- ✅ Template Manager 修復和資源路徑統一
- 🎯 智慧化功能開發 - 上下文感知、機器學習推薦
- 🌐 更多語言支援 - Java, Go, Rust, Swift, TypeScript
- 🧭 快取式階層導航 - 多層級組織和切換系統

### 2025 Q4
- 🧭 CRDT 協作知識圖譜 - 分散式協作編輯基礎
- 📚 文檔和學習體系建立 - 互動式教學、程式碼解釋
- 🤝 社群和協作功能開發
- 📊 用戶反饋收集和分析
- 🌍 本地化準備 (英文界面)

### 2026 Q1
- 🧭 自動化知識圖譜完善 - 智慧內容擴充系統
- 🧭 置信度網絡系統 - 分層信任機制實現
- 📈 學習追蹤系統實現
- 🌍 本地化和主題系統完善

### 2026 Q2+
- 🔧 Vim 插件 MVP 開發
- 🌐 Chrome 擴展開發
- 📈 多平台生態建設

## 🔄 AI Agents 變更日誌

> 📝 **重要**：AI 助手在進行重大變更時，請更新此部分以便後續追蹤

### 2025-09-05 - 策略調整：Monorepo 遷移延後，優先發布修復版本
- **執行者**：Claude Code
- **變更**：
  - 🔄 **策略調整**：暫停 Monorepo 完整遷移，採用實際發布策略
  - 📦 **v0.2.1 準備就緒**：Template Manager 修復版本已完成打包
  - 🏗️ **架構決策**：維持根目錄 `src/` 結構，確保穩定發布
  - 📁 **Monorepo 延後**：完整遷移規劃為 v0.2.2 重點項目
- **技術成果**：
  - ✅ **VSIX 重新打包**：745.68KB，包含所有修復
  - ✅ **編譯穩定**：根目錄結構編譯無誤
  - ✅ **資源路徑修復**：Template Manager 和 Documentation Provider 正常
  - ✅ **備份安全**：根目錄 src 已備份為 src_backup_20250905_072215
- **發布狀態**：v0.2.1 VSIX 已生成，等待 Marketplace 發布
- **下一版本規劃**：
  - 🎯 **v0.2.2**：完整 Monorepo 遷移
  - 🧭 **v0.3.0**：知識圖譜導航系統實現
- **狀態**：實際發布策略執行完成
- **下一步**：發布 v0.2.1 或開始 v0.2.2 Monorepo 遷移規劃

### 2025-09-05 - 新增知識圖譜導航系統：革命性協作功能
- **執行者**：Claude Code
- **變更**：
  - 🧭 **知識圖譜導航系統**：加入 Phase 2 高階功能規劃
  - 🗂️ **快取式階層導航**：
    - 多層級模板組織，左右箭頭切換階層
    - 檔案（末端）、資料夾（階層）、捷徑（跨層）整合
    - 常用項目快取，上下文感知推薦
  - 🌐 **CRDT 協作知識圖譜**：
    - 分散式協作編輯，共享知識圖譜
    - 修改審核機制，協作模式動態切換
    - 還原點系統，協作進出控制
  - 🤖 **自動化圖譜完善**：
    - 使用者內容為基底，確認後系統整合
    - 可選更新策略（不變/隨時更新）
  - 🛡️ **置信度網絡系統**：
    - 分層信任機制，權柄者高置信度
    - 社群化網絡，不同群體標準
    - 信任鍊記錄，動態置信度調整
- **技術創新**：
  - 📊 **分散式協作**：CRDT 技術實現無衝突協作
  - 🧠 **智慧信任**：社群化置信度評級系統
  - 🎯 **上下文導航**：快取式多層級知識組織
- **戰略意義**：建立下一代協作知識管理平台
- **實現階段**：
  - 🗓️ **Q3 2025**：快取式階層導航
  - 🗓️ **Q4 2025**：CRDT 協作基礎
  - 🗓️ **2026 Q1**：置信度網絡和自動化完善
- **狀態**：創新功能規劃完成，進入 Phase 2 開發流程
- **下一步**：開始快取式階層導航系統設計

### 2025-09-05 - 時間規劃校正：調整為實際時間線
- **執行者**：Claude Code
- **變更**：
  - 📅 **時間線校正**：認知到當前已是 2025 Q3，調整規劃至實際時間
  - 🎯 **當前季度重新定位**：Q3 2025 專注智慧化功能和語言支援
  - ⏰ **里程碑調整**：
    - ✅ **Q3 2025** (當前)：智慧化功能開發、語言支援擴展
    - 🎯 **Q4 2025**：文檔學習體系、社群協作功能
    - 🚀 **2026 Q1**：學習追蹤系統、本地化
    - 🌐 **2026 Q2+**：多平台擴展階段
  - 📊 **現實對齊**：將規劃與實際時間進度同步
- **狀態**：時間規劃已校正，符合實際開發進度
- **下一步**：根據 Q3 2025 目標推進智慧化功能開發

### 2025-09-05 - 策略調整：功能增強優先於多平台擴展
- **執行者**：Claude Code
- **變更**：
  - 📋 **Phase 重新規劃**：Phase 2 (多平台擴展) 與 Phase 3 (功能增強) 對調
  - 🎯 **優先級調整**：先完善 VS Code 版本功能，再擴展到其他編輯器
  - 🧠 **智慧化功能優先**：上下文感知、機器學習推薦、學習追蹤系統
  - 🌐 **語言支援擴展**：Java, Go, Rust, Swift, TypeScript
  - 📚 **學習體系建立**：互動式教學、程式碼解釋、最佳實踐建議
- **戰略考量**：
  - ✅ **深度優於廣度**：先把核心產品做到極致
  - ✅ **用戶體驗優先**：專注於學習效率和智慧輔助
  - ✅ **生態建設**：建立完整的學習和協作體系
- **時間規劃調整**：
  - 🗓️ **Q3 2025** (當前)：智慧化功能、語言支援擴展
  - 🗓️ **Q4 2025**：文檔學習體系、社群功能
  - 🗓️ **2026 Q1**：學習追蹤、本地化系統
  - 🗓️ **2026 Q2+**：多平台擴展 (Vim, Chrome 等)
- **狀態**：策略調整完成，專注於功能增強路線
- **下一步**：開始智慧化功能開發或發佈 v0.2.1

### 2025-09-05 - v0.2.1 Template Manager 修復和資源路徑統一
- **執行者**：Claude Code
- **變更**：
  - 🔧 **Template Manager 修復**：解決版面跑版問題，修正 CSS/JS 載入路徑
  - 🔧 **Documentation Provider 修復**：同步修正資源路徑引用
  - 📁 **資源路徑統一**：將所有 `media/` 路徑更新為 `assets/` 統一結構
  - 🏗️ **建置系統完善**：確保所有資源文件正確複製到輸出目錄
  - 📝 **版本更新**：v0.2.0 → v0.2.1 修復版本發佈
- **技術成果**：
  - ✅ **UI 修復**：Template Manager 界面恢復正常，樣式和功能完整
  - ✅ **路徑標準化**：統一使用 `assets/{css,js,icons}/` 目錄結構
  - ✅ **建置穩定性**：所有平台適配器正確載入資源文件
- **狀態**：v0.2.1 準備就緒，Template Manager 和 Documentation Provider 功能正常
- **下一步**：發佈 v0.2.1 或繼續多平台擴展開發

### 2025-09-05 - v0.2.0 多編輯器平台轉型完成
- **執行者**：Claude Code
- **變更**：
  - ✅ **專案轉型**：TextBricks-VSCode → textbricks-extensions 多編輯器平台
  - ✅ **統一建置系統**：完整 dist/ 目錄結構支援多平台外掛
  - ✅ **文檔全面更新**：多編輯器支援說明，VS Code/Vim/Sublime Text 規劃
  - ✅ **版本發佈**：v0.1.8 → v0.2.0 重大版本更新
  - ✅ **VSIX 生成**：textbricks-0.2.0.vsix (528KB) 成功建置
- **技術成果**：
  - 🏗️ **統一建置**：dist/plugins/vscode/current/ 結構，準備多平台外掛
  - 📦 **版本管理**：自動 VSIX 歸檔，current/archive 分離
  - 🌐 **多平台就緒**：為 Vim, Sublime Text 等編輯器預留架構
  - 📄 **完整文檔**：README.md, CHANGELOG.md, GitHub URLs 全面更新
- **狀態**：v0.2.0 發佈就緒，多編輯器平台基礎完成
- **下一步**：發佈到 VS Code Marketplace，開始 Vim 外掛開發

### 2025-09-04 - Monorepo 架構重構完成
- **執行者**：Claude Code
- **變更**：
  - ✅ 完成 Phase 2 多平台架構擴展
    - ✅ Phase 2.1: 建立 monorepo 結構 - npm workspaces 支援
    - ✅ Phase 2.2: 分離 packages - @textbricks/core, @textbricks/shared, @textbricks/vscode
    - ✅ Phase 2.3: 更新建置流程 - 修復跨包依賴和導入路徑
  - ✅ 核心服務完全模組化：TextBricksEngine, DocumentationService, SearchService, CodeOperationService
  - ✅ 共享模型獨立包：Template 等模型分離至 @textbricks/shared
  - ✅ VS Code 適配器包：完整的 VS Code 特定實現
- **技術成果**：
  - 🏗️ **Monorepo 結構**：三個獨立包，清晰依賴關係
  - 📦 **包管理**：npm workspaces 支援，統一依賴管理
  - 🔗 **跨包引用**：@textbricks/* 命名空間，TypeScript 項目引用
  - ✅ **編譯驗證**：@textbricks/shared 和 @textbricks/core 編譯成功
- **狀態**：Monorepo 架構完成，為多平台擴展做好準備
- **下一步**：修復測試架構適配，準備 Vim 插件開發

### 2025-01-04 - 文檔整合和架構重構完成
- **執行者**：Claude Code
- **變更**：
  - ✅ 完成多平台架構重構 (Phase 1)
  - ✅ 整合分散文檔為統一 AGENTS.md
  - ✅ 清理冗餘代碼和除錯日誌
  - ✅ VS Code 功能驗證通過
- **狀態**：架構重構完成，VS Code 版本穩定運行
- **下一步**：準備 Vim 插件開發 (Phase 2.1)

### 變更記錄模板
```
### YYYY-MM-DD - 變更摘要
- **執行者**：[AI 助手名稱]
- **變更**：
  - [具體變更項目]
- **影響**：[對項目的影響]
- **狀態**：[當前狀態]
- **注意事項**：[後續 AI 助手需要注意的事項]
```

---

## 🧠 AI Agents 重要提醒

### 🎯 工作原則
1. **穩定優先** - VS Code 版本已穩定，避免破壞性變更
2. **架構完整** - 多平台架構已就緒，新功能應遵循此設計
3. **向後兼容** - 保持 API 和用戶體驗的一致性
4. **文檔同步** - 重要變更必須更新此文件
5. **增量改進** - 專注於漸進式改進而非重大變更
6. **穩定性優先** - 考慮穩定性和向後兼容性

### 📋 常見任務指南
- **新功能開發** → 遵循 `packages/core/` 和 `packages/vscode/` 分離原則
- **Bug 修復** → 優先檢查接口實現和類型安全
- **重構建議** → 參考 Phase 2/3 規劃，避免過早優化
- **測試新想法** → 使用 VS Code 版本驗證，確保功能完整
- **Monorepo 工作** → 理解包依賴關係：shared ← core ← vscode

### 🔧 技術棧提醒
- **TypeScript** 嚴格模式，完整類型定義
- **Monorepo 結構** 三個包：`@textbricks/shared`, `@textbricks/core`, `@textbricks/vscode`
- **平台抽象** 通過 `packages/core/src/interfaces/` 定義
- **核心邏輯** 在 `packages/core/src/core/` 中保持平台無關
- **VS Code 特定** 實現在 `packages/vscode/src/adapters/vscode/`
- **共享模型** 在 `packages/shared/src/models/` 定義

### 🗂️ 關鍵檔案參考
- **AGENTS.md** - 🤖 AI 助手主要參考文件 - 完整項目狀態、架構、規劃和變更日誌
- **CHANGELOG.md** - 版本歷史和變更記錄
- **packages/core/** - 平台無關的業務邏輯
- **packages/vscode/** - VS Code 平台特定實現  
- **packages/shared/** - 共享模型和類型定義
- **tsconfig.json** - Monorepo 根配置與專案引用

### 🎯 當前狀態提醒 (v0.2.1 功能增強優先策略)
- ✅ **多編輯器平台基礎**：專案具備多平台擴展能力，但優先功能增強
- ✅ **統一建置系統**：dist/plugins/ 結構支援功能開發和未來平台擴展
- ✅ **Monorepo 架構**：完整的多包結構支援快速功能開發
- ✅ **平台抽象層**：核心邏輯與 VS Code API 分離，便於功能擴展
- ✅ **UI 問題修復**：Template Manager 和資源路徑問題已解決
- ✅ **版本發佈**：v0.2.1 VSIX 已生成，功能穩定
- ✅ **策略調整**：明確功能增強優於多平台擴展的發展路線

### 🚀 繼續工作時的重點
1. **v0.2.1 Template Manager 修復版**已完成，UI 問題已解決
2. **統一建置系統**就緒，支援功能擴展和平台開發  
3. **VS Code 擴展**功能正常，VSIX 已生成準備發佈
4. 專注於**功能增強**優於**多平台擴展**
5. 優先考慮**智慧化功能**和**學習體驗**提升
6. **Monorepo 架構**成熟，支援快速功能開發和擴展

---

**文件狀態**：🟢 最新  
**最後更新**：2025-09-05 (時間規劃校正)  
**當前版本**：v0.2.1 (Template Manager 修復版)  
**專案狀態**：✅ 多編輯器平台基礎完成，UI 問題已修復  
**發佈狀態**：🚀 v0.2.1 準備發佈，Template Manager 和資源路徑已修復  
**下一步**：📦 發佈 v0.2.1 到 Marketplace 或 🧠 開始智慧化功能開發